<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Add boundary penalties — add_boundary_penalties • prioritizr</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>



<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
<meta property="og:title" content="Add boundary penalties — add_boundary_penalties" />

<meta property="og:description" content="Add penalties to a conservation planning problem to favor
solutions that have planning units clumped together into contiguous areas." />

<meta property="og:image" content="http://prioritizr.github.io/prioritizr/logo.png" />
<meta name="twitter:card" content="summary" />


<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-70466840-4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-70466840-4');
</script>



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">prioritizr</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">4.0.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/prioritizr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/gurobi_installation.html">Gurobi Installation Guide</a>
    </li>
    <li>
      <a href="../articles/publication_record.html">Publication Record</a>
    </li>
    <li>
      <a href="../articles/zones.html">Management Zones</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/prioritizr/prioritizr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Add boundary penalties</h1>
    <small class="dont-index">Source: <a href='https://github.com/prioritizr/prioritizr/blob/master/R/add_boundary_penalties.R'><code>R/add_boundary_penalties.R</code></a></small>
    <div class="hidden name"><code>add_boundary_penalties.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Add penalties to a conservation planning <code>problem</code> to favor
solutions that have planning units clumped together into contiguous areas.</p>
    
    </div>

    <pre class="usage"><span class='fu'>add_boundary_penalties</span>(<span class='no'>x</span>, <span class='no'>penalty</span>, <span class='kw'>edge_factor</span> <span class='kw'>=</span> <span class='fu'>rep</span>(<span class='fl'>0.5</span>, <span class='fu'>number_of_zones</span>(<span class='no'>x</span>)),
  <span class='kw'>zones</span> <span class='kw'>=</span> <span class='fu'>diag</span>(<span class='fu'>number_of_zones</span>(<span class='no'>x</span>)), <span class='kw'>data</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p><code><a href='ConservationProblem-class.html'>ConservationProblem-class</a></code> object.</p></td>
    </tr>
    <tr>
      <th>penalty</th>
      <td><p><code>numeric</code> penalty that is used to scale the importance
of selecting planning units that are spatially clumped together compared
to the main problem objective (e.g. solution cost when the argument to
<code>x</code> has a minimum set objective set using
<code>add_min_set_objective</code>). Higher <code>penalty</code> values
will return solutions with a higher degree of spatial clumping,
and smaller <code>penalty</code> values will return solutions with a smaller
degree of clumping. Note that negative <code>penalty</code> values will
return solutions that are more spread out. This parameter is equivalent to
the
<a href='http://marxan.net/downloads/uq_marxan_web_2/module2.html'>boundary length modifier (BLM)</a>
parameter in <a href='http://marxan.net'><em>Marxan</em></a>.</p></td>
    </tr>
    <tr>
      <th>edge_factor</th>
      <td><p><code>numeric</code> proportion to scale
planning unit edges (or borders) that do not have any neighboring planning
units. For example, an edge factor of <code>0.5</code> is commonly used for
planning units along the coast line. Note that this argument must have an
element for each zone in the argument to <code>x</code>.</p></td>
    </tr>
    <tr>
      <th>zones</th>
      <td><p><code>matrix</code> or <code>Matrix</code> object describing the
clumping scheme for different zones. Each row and column corresponds to a
different zone in the argument to <code>x</code>, and cell values indicate the
relative importance of clumping planning units that are allocated to
a pair of zones. Cell values along the diagonal of the matrix represent
the relative importance of clumping planning units that are allocated
to the same zone. Cell values must lay between 1 and -1, where negative
values favor solutions that spread out planning units. The default
argument to <code>zones</code> is an identity
matrix (i.e. a matrix with ones along the matrix diagonal and zeros
elsewhere), so that penalties are incurred when neighboring planning units
are not assigned to the same zone. <strong>Note that if the cells along
the matrix diagonal contain markedly lower values than cells found
elsewhere in the matrix, then the optimal solution may surround
planning units with planning units that are allocated to different zones.</strong></p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p><code>NULL</code>, <code>data.frame</code>, <code>matrix</code>, or <code>Matrix</code>
object containing the boundary data. The boundary values
correspond to the shared boundary length between different planning units
and the amount of exposed boundary length that each planning unit has
which is not shared with any other planning unit. Given a certain
<code>penalty</code> value, it is more desirable to select combinations of
planning units which do not expose larger boundaries that are shared
between different planning units. See the Details section for more
information.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code><a href='ConservationProblem-class.html'>ConservationProblem-class</a></code> object with the penalties
 added to it.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function adds penalties to a conservation planning problem
  to penalize fragmented solutions. It was is inspired by Ball <em>et al.</em>
  (2009) and Beyer <em>et al.</em> (2016). The <code>penalty</code> argument is
  equivalent to the boundary length modifier (<code>BLM</code>) used in
  <a href='http://marxan.net'><em>Marxan</em></a>. Note that this function can only
  be used to represent symmetric relationships between planning units. If
  asymmetric relationships are required, use the
  <code>add_connectivity_penalties</code> function.</p>
<p>The argument to <code>data</code> can be specified in several different ways:</p>
<p></p><dl class='dl-horizontal'>
    <dt><code>NULL</code></dt><dd><p>the boundary data are automatically calculated
    using the <code><a href='boundary_matrix.html'>boundary_matrix</a></code> function. This argument is the
    default. Note that the boundary data must be manually defined
    using one of the other formats below when the planning unit data
    in the argument to <code>x</code> is not spatially referenced (e.g.
    in <code>data.frame</code> or <code>numeric</code> format).</p></dd>
    <dt><code>matrix</code>, <code>Matrix</code></dt><dd><p>where rows and columns represent
    different planning units and the value of each cell represents the
    amount of shared boundary length between two different planning units.
    Cells that occur along the matrix diagonal represent the amount of
    exposed boundary associated with each planning unit that has
    no neighbor (e.g. these value might pertain the length of coastline
    in a planning unit).</p></dd>
    <dt><code>data.frame</code></dt><dd><p>containing the columns <code>"id1"</code>,
    <code>"id2"</code>, and <code>"boundary"</code>. The values in the column
    <code>"boundary"</code> show the total amount of shared boundary between the
    two planning units indicated the columns <code>"id1"</code> and <code>"id2"</code>.
    This format follows the the standard <em>Marxan</em> input format. Note
    that this function requires symmetric boundary data, and so the
    argument to <code>data</code> cannot have the columns <code>"zone1"</code> and
    code"zone2" to specify different amounts of shared boundary lengths
    for different zones. Instead, when dealing with problems with multiple
    zones, the argument to <code>zones</code> should be used to control the
    relative importance of spatially clumping planning units together when
    they are allocated to different zones.</p></dd>
    </dl>
    <p>The boundary penalties are calculated using the following equations. Let
  \(I\) represent the set of planning units, \(Z\) represent
  the set of management zones, and $$X_iz$$ represent the decision
  variable for planning unit \(i\) for in zone \(z\) (e.g. with binary
  values one indicating if planning unit is allocated or not). Also, let
  \(p\) represent the argument to <code>penalty</code>, \(E\) represent the
  argument to <code>edge_factor</code>, \(W\) represent the matrix argument to
  <code>zones</code>, and \(B\) represent the matrix argument to zones
  (e.g. generated using <code><a href='boundary_matrix.html'>boundary_matrix</a></code>).</p>
<p>$$
  \sum_{i}^{I} \sum_{j}^{I} \sum_{z}^{Z} (\mathit{ifelse}(i == j, E_z, 1)
  \times p \times W_{zz} B_{ij}) + \sum_{i}^{I} \sum_{j}^{I} \sum_{z}^{Z}
  \sum_{y}^{Z} (-2 \times p \times X_{iz} \times X_{jy} \times W_{zy} \times
  B_{ij})$$</p>
<p>Note that when the problem objective is to maximize some measure of
 benefit and not minimize some measure of cost, the term \(p\) is
 replaced with \(-p\).</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Ball IR, Possingham HP, and Watts M (2009) <em>Marxan and relatives:
Software for spatial conservation prioritisation</em> in Spatial conservation
prioritisation: Quantitative methods and computational tools. Eds Moilanen
A, Wilson KA, and Possingham HP. Oxford University Press, Oxford, UK.</p>
<p>Beyer HL, Dujardin Y, Watts ME, and Possingham HP (2016) Solving
conservation planning problems with integer linear programming.
<em>Ecological Modelling</em>, 228: 14--22.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='penalties.html'>penalties</a></code>.</p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># set seed for reproducibility</span>
<span class='fu'>set.seed</span>(<span class='fl'>500</span>)

<span class='co'># load data</span>
<span class='fu'>data</span>(<span class='no'>sim_pu_raster</span>, <span class='no'>sim_features</span>, <span class='no'>sim_pu_zones_stack</span>, <span class='no'>sim_features_zones</span>)

<span class='co'># create minimal problem</span>
<span class='no'>p1</span> <span class='kw'>&lt;-</span> <span class='fu'>problem</span>(<span class='no'>sim_pu_raster</span>, <span class='no'>sim_features</span>) <span class='kw'>%&gt;%</span>
      <span class='fu'>add_min_set_objective</span>() <span class='kw'>%&gt;%</span>
      <span class='fu'>add_relative_targets</span>(<span class='fl'>0.2</span>) <span class='kw'>%&gt;%</span>
      <span class='fu'>add_binary_decisions</span>() <span class='kw'>%&gt;%</span>
      <span class='fu'><a href='add_default_solver.html'>add_default_solver</a></span>()

<span class='co'># create problem with low boundary penalties</span>
<span class='no'>p2</span> <span class='kw'>&lt;-</span> <span class='no'>p1</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_boundary_penalties</span>(<span class='fl'>50</span>, <span class='fl'>1</span>)

<span class='co'># create problem with high boundary penalties but outer edges receive</span>
<span class='co'># half the penalty as inner edges</span>
<span class='no'>p3</span> <span class='kw'>&lt;-</span> <span class='no'>p1</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_boundary_penalties</span>(<span class='fl'>500</span>, <span class='fl'>0.5</span>)

<span class='co'># create a problem using precomputed boundary data</span>
<span class='no'>bmat</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='boundary_matrix.html'>boundary_matrix</a></span>(<span class='no'>sim_pu_raster</span>)
<span class='no'>p4</span> <span class='kw'>&lt;-</span> <span class='no'>p1</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_boundary_penalties</span>(<span class='fl'>50</span>, <span class='fl'>1</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>bmat</span>)</div><div class='input'><span class='co'># solve problems</span>
<span class='no'>s</span> <span class='kw'>&lt;-</span> <span class='fu'>stack</span>(<span class='fu'>solve</span>(<span class='no'>p1</span>), <span class='fu'>solve</span>(<span class='no'>p2</span>), <span class='fu'>solve</span>(<span class='no'>p3</span>), <span class='fu'>solve</span>(<span class='no'>p4</span>))</div><div class='output co'>#&gt; Optimize a model with 5 rows, 90 columns and 450 nonzeros
#&gt; Variable types: 0 continuous, 90 integer (90 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 9e-01]
#&gt;   Objective range  [2e+02, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [6e+00, 2e+01]
#&gt; Found heuristic solution: objective 4750.1073492
#&gt; Presolve time: 0.00s
#&gt; Presolved: 5 rows, 90 columns, 450 nonzeros
#&gt; Variable types: 0 continuous, 90 integer (90 binary)
#&gt; Presolved: 5 rows, 90 columns, 450 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 3.891498e+03, 16 iterations, 0.00 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 3891.49802    0    4 4750.10735 3891.49802  18.1%     -    0s
#&gt; H    0     0                    3997.3009348 3891.49802  2.65%     -    0s
#&gt; 
#&gt; Explored 1 nodes (16 simplex iterations) in 0.00 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 2: 3997.3 4750.11 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 3.997300934792e+03, best bound 3.891498019516e+03, gap 2.6469%
#&gt; Optimize a model with 293 rows, 234 columns and 1026 nonzeros
#&gt; Variable types: 0 continuous, 234 integer (234 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [1e+01, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [6e+00, 2e+01]
#&gt; Found heuristic solution: objective 18847.196992
#&gt; Found heuristic solution: objective 4940.1073492
#&gt; Presolve time: 0.00s
#&gt; Presolved: 293 rows, 234 columns, 1026 nonzeros
#&gt; Variable types: 0 continuous, 234 integer (234 binary)
#&gt; Presolved: 293 rows, 234 columns, 1026 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 4.082446e+03, 164 iterations, 0.00 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 4082.44620    0   75 4940.10735 4082.44620  17.4%     -    0s
#&gt; H    0     0                    4456.3212783 4082.44620  8.39%     -    0s
#&gt; 
#&gt; Explored 1 nodes (164 simplex iterations) in 0.01 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 3: 4456.32 4940.11 18847.2 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 4.456321278292e+03, best bound 4.082446197431e+03, gap 8.3898%
#&gt; Optimize a model with 293 rows, 234 columns and 1026 nonzeros
#&gt; Variable types: 0 continuous, 234 integer (234 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [1e+02, 4e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [6e+00, 2e+01]
#&gt; Found heuristic solution: objective 20287.196992
#&gt; Found heuristic solution: objective 5850.1073492
#&gt; Presolve time: 0.00s
#&gt; Presolved: 293 rows, 234 columns, 1026 nonzeros
#&gt; Variable types: 0 continuous, 234 integer (234 binary)
#&gt; Presolved: 293 rows, 234 columns, 1026 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 4.530774e+03, 218 iterations, 0.00 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 4530.77373    0  234 5850.10735 4530.77373  22.6%     -    0s
#&gt;      0     0 4600.58760    0  232 5850.10735 4600.58760  21.4%     -    0s
#&gt;      0     0 4615.37024    0  232 5850.10735 4615.37024  21.1%     -    0s
#&gt;      0     0 4619.79170    0  233 5850.10735 4619.79170  21.0%     -    0s
#&gt;      0     0 4658.33379    0  233 5850.10735 4658.33379  20.4%     -    0s
#&gt;      0     0 4661.36147    0  233 5850.10735 4661.36147  20.3%     -    0s
#&gt; H    0     0                    5320.7189387 4661.36147  12.4%     -    0s
#&gt;      0     2 4662.03991    0  233 5320.71894 4662.03991  12.4%     -    0s
#&gt; H   81    71                    5302.6819148 4674.82252  11.8%  16.4    0s
#&gt; H  157    83                    5199.7448870 4706.97048  9.48%  15.2    0s
#&gt; 
#&gt; Cutting planes:
#&gt;   Gomory: 5
#&gt; 
#&gt; Explored 157 nodes (2757 simplex iterations) in 0.16 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 5: 5199.74 5302.68 5320.72 ... 20287.2
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 5.199744887004e+03, best bound 4.706970484223e+03, gap 9.4769%
#&gt; Optimize a model with 293 rows, 234 columns and 1026 nonzeros
#&gt; Variable types: 0 continuous, 234 integer (234 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [1e+01, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [6e+00, 2e+01]
#&gt; Found heuristic solution: objective 18847.196992
#&gt; Found heuristic solution: objective 4940.1073492
#&gt; Presolve time: 0.00s
#&gt; Presolved: 293 rows, 234 columns, 1026 nonzeros
#&gt; Variable types: 0 continuous, 234 integer (234 binary)
#&gt; Presolved: 293 rows, 234 columns, 1026 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 4.082446e+03, 164 iterations, 0.00 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 4082.44620    0   75 4940.10735 4082.44620  17.4%     -    0s
#&gt; H    0     0                    4456.3212783 4082.44620  8.39%     -    0s
#&gt; 
#&gt; Explored 1 nodes (164 simplex iterations) in 0.01 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 3: 4456.32 4940.11 18847.2 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 4.456321278292e+03, best bound 4.082446197431e+03, gap 8.3898%</div><div class='input'>
<span class='co'># plot solutions</span>
<span class='fu'>plot</span>(<span class='no'>s</span>, <span class='kw'>main</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"basic solution"</span>, <span class='st'>"small penalties"</span>, <span class='st'>"high penalties"</span>,
                 <span class='st'>"precomputed data"</span>), <span class='kw'>axes</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>box</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='img'><img src='add_boundary_penalties-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># create minimal problem with multiple zones and limit the run-time for</span>
<span class='co'># solver to 10 seconds so this example doesn't take too long</span>
<span class='no'>p5</span> <span class='kw'>&lt;-</span> <span class='fu'>problem</span>(<span class='no'>sim_pu_zones_stack</span>, <span class='no'>sim_features_zones</span>) <span class='kw'>%&gt;%</span>
      <span class='fu'>add_min_set_objective</span>() <span class='kw'>%&gt;%</span>
      <span class='fu'>add_relative_targets</span>(<span class='fu'>matrix</span>(<span class='fl'>0.2</span>, <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>3</span>)) <span class='kw'>%&gt;%</span>
      <span class='fu'>add_binary_decisions</span>() <span class='kw'>%&gt;%</span>
      <span class='fu'><a href='add_default_solver.html'>add_default_solver</a></span>(<span class='kw'>time_limit</span> <span class='kw'>=</span> <span class='fl'>10</span>)

<span class='co'># create zone matrix which favors clumping planning units that are</span>
<span class='co'># allocated to the same zone together - note that this is the default</span>
<span class='no'>zm6</span> <span class='kw'>&lt;-</span> <span class='fu'>diag</span>(<span class='fl'>3</span>)
<span class='fu'><a href='print.html'>print</a></span>(<span class='no'>zm6</span>)</div><div class='output co'>#&gt;      [,1] [,2] [,3]
#&gt; [1,]    1    0    0
#&gt; [2,]    0    1    0
#&gt; [3,]    0    0    1</div><div class='input'>
<span class='co'># create problem with the zone matrix and low penalties</span>
<span class='no'>p6</span> <span class='kw'>&lt;-</span> <span class='no'>p5</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_boundary_penalties</span>(<span class='fl'>50</span>, <span class='kw'>zone</span> <span class='kw'>=</span> <span class='no'>zm6</span>)

<span class='co'># create another problem with the same zone matrix and higher penalties</span>
<span class='no'>p7</span> <span class='kw'>&lt;-</span> <span class='no'>p5</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_boundary_penalties</span>(<span class='fl'>500</span>, <span class='kw'>zone</span> <span class='kw'>=</span> <span class='no'>zm6</span>)

<span class='co'># create zone matrix which favors clumping units that are allocated to</span>
<span class='co'># different zones together</span>
<span class='no'>zm8</span> <span class='kw'>&lt;-</span> <span class='fu'>matrix</span>(<span class='fl'>1</span>, <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='fl'>3</span>)
<span class='fu'>diag</span>(<span class='no'>zm8</span>) <span class='kw'>&lt;-</span> <span class='fl'>0</span>
<span class='fu'><a href='print.html'>print</a></span>(<span class='no'>zm8</span>)</div><div class='output co'>#&gt;      [,1] [,2] [,3]
#&gt; [1,]    0    1    1
#&gt; [2,]    1    0    1
#&gt; [3,]    1    1    0</div><div class='input'>
<span class='co'># create problem with the zone matrix</span>
<span class='no'>p8</span> <span class='kw'>&lt;-</span> <span class='no'>p5</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_boundary_penalties</span>(<span class='fl'>500</span>, <span class='kw'>zone</span> <span class='kw'>=</span> <span class='no'>zm8</span>)

<span class='co'># create zone matrix which strongly favors clumping units</span>
<span class='co'># that are allocated to the same zone together. It will also prefer</span>
<span class='co'># clumping planning units in zones 1 and 2 together over having</span>
<span class='co'># these planning units with no neighbors in the solution</span>
<span class='no'>zm9</span> <span class='kw'>&lt;-</span> <span class='fu'>diag</span>(<span class='fl'>3</span>)
<span class='no'>zm9</span>[<span class='fu'>upper.tri</span>(<span class='no'>zm9</span>)] <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='fl'>0.3</span>, <span class='fl'>0</span>, <span class='fl'>0</span>)
<span class='no'>zm9</span>[<span class='fu'>lower.tri</span>(<span class='no'>zm9</span>)] <span class='kw'>&lt;-</span> <span class='no'>zm9</span>[<span class='fu'>upper.tri</span>(<span class='no'>zm9</span>)]
<span class='fu'><a href='print.html'>print</a></span>(<span class='no'>zm9</span>)</div><div class='output co'>#&gt;      [,1] [,2] [,3]
#&gt; [1,]  1.0  0.3    0
#&gt; [2,]  0.3  1.0    0
#&gt; [3,]  0.0  0.0    1</div><div class='input'>
<span class='co'># create problem with the zone matrix</span>
<span class='no'>p9</span> <span class='kw'>&lt;-</span> <span class='no'>p5</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_boundary_penalties</span>(<span class='fl'>500</span>, <span class='kw'>zone</span> <span class='kw'>=</span> <span class='no'>zm9</span>)

<span class='co'># create zone matrix which favors clumping planning units in zones 1 and 2</span>
<span class='co'># together, and favors planning units in zone 3 being spread out</span>
<span class='co'># (i.e. negative clumping)</span>
<span class='no'>zm10</span> <span class='kw'>&lt;-</span> <span class='fu'>diag</span>(<span class='fl'>3</span>)
<span class='no'>zm10</span>[<span class='fl'>3</span>, <span class='fl'>3</span>] <span class='kw'>&lt;-</span> -<span class='fl'>1</span>
<span class='fu'><a href='print.html'>print</a></span>(<span class='no'>zm10</span>)</div><div class='output co'>#&gt;      [,1] [,2] [,3]
#&gt; [1,]    1    0    0
#&gt; [2,]    0    1    0
#&gt; [3,]    0    0   -1</div><div class='input'>
<span class='co'># create problem with the zone matrix</span>
<span class='no'>p10</span> <span class='kw'>&lt;-</span> <span class='no'>p5</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_boundary_penalties</span>(<span class='fl'>500</span>, <span class='kw'>zone</span> <span class='kw'>=</span> <span class='no'>zm10</span>)</div><div class='input'><span class='co'># solve problems</span>
<span class='no'>s2</span> <span class='kw'>&lt;-</span> <span class='fu'>stack</span>(<span class='fu'><a href='category_layer.html'>category_layer</a></span>(<span class='fu'>solve</span>(<span class='no'>p5</span>)), <span class='fu'><a href='category_layer.html'>category_layer</a></span>(<span class='fu'>solve</span>(<span class='no'>p6</span>)),
            <span class='fu'><a href='category_layer.html'>category_layer</a></span>(<span class='fu'>solve</span>(<span class='no'>p7</span>)), <span class='fu'><a href='category_layer.html'>category_layer</a></span>(<span class='fu'>solve</span>(<span class='no'>p8</span>)),
            <span class='fu'><a href='category_layer.html'>category_layer</a></span>(<span class='fu'>solve</span>(<span class='no'>p9</span>)), <span class='fu'><a href='category_layer.html'>category_layer</a></span>(<span class='fu'>solve</span>(<span class='no'>p10</span>)))</div><div class='output co'>#&gt; Optimize a model with 105 rows, 270 columns and 1620 nonzeros
#&gt; Variable types: 0 continuous, 270 integer (270 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [2e+02, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 2e+01]
#&gt; Found heuristic solution: objective 13244.599124
#&gt; Presolve time: 0.00s
#&gt; Presolved: 105 rows, 270 columns, 1620 nonzeros
#&gt; Variable types: 0 continuous, 270 integer (270 binary)
#&gt; Presolved: 105 rows, 270 columns, 1620 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 1.204675e+04, 188 iterations, 0.00 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 12046.7536    0   14 13244.5991 12046.7536  9.04%     -    0s
#&gt; 
#&gt; Explored 1 nodes (188 simplex iterations) in 0.01 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 1: 13244.6 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 1.324459912364e+04, best bound 1.204675362644e+04, gap 9.0440%
#&gt; Optimize a model with 975 rows, 705 columns and 3360 nonzeros
#&gt; Variable types: 0 continuous, 705 integer (705 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [1e+01, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 2e+01]
#&gt; Found heuristic solution: objective 14119.599124
#&gt; Presolve time: 0.01s
#&gt; Presolved: 975 rows, 705 columns, 3360 nonzeros
#&gt; Variable types: 0 continuous, 705 integer (705 binary)
#&gt; Presolved: 975 rows, 705 columns, 3360 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 1.235057e+04, 672 iterations, 0.02 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 12350.5709    0  366 14119.5991 12350.5709  12.5%     -    0s
#&gt; H    0     0                    13296.029839 12350.5709  7.11%     -    0s
#&gt; 
#&gt; Explored 1 nodes (672 simplex iterations) in 0.04 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 2: 13296 14119.6 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 1.329602983863e+04, best bound 1.235057088365e+04, gap 7.1108%
#&gt; Optimize a model with 975 rows, 705 columns and 3360 nonzeros
#&gt; Variable types: 0 continuous, 705 integer (705 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [1e+02, 4e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 2e+01]
#&gt; Found heuristic solution: objective 21994.599124
#&gt; Presolve time: 0.01s
#&gt; Presolved: 975 rows, 705 columns, 3360 nonzeros
#&gt; Variable types: 0 continuous, 705 integer (705 binary)
#&gt; Presolved: 975 rows, 705 columns, 3360 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 1.364210e+04, 714 iterations, 0.02 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 13642.1048    0  705 21994.5991 13642.1048  38.0%     -    0s
#&gt; H    0     0                    20681.028033 13642.1048  34.0%     -    0s
#&gt;      0     0 13817.4932    0  647 20681.0280 13817.4932  33.2%     -    0s
#&gt; H    0     0                    20499.135898 13817.4932  32.6%     -    0s
#&gt;      0     0 13820.0740    0  644 20499.1359 13820.0740  32.6%     -    0s
#&gt;      0     0 13929.4023    0  646 20499.1359 13929.4023  32.0%     -    0s
#&gt; H    0     0                    20220.380306 13929.4023  31.1%     -    0s
#&gt;      0     0 13938.4131    0  628 20220.3803 13938.4131  31.1%     -    0s
#&gt; H    0     0                    19567.276258 13938.4131  28.8%     -    0s
#&gt; H    0     0                    18841.800426 13938.4131  26.0%     -    0s
#&gt;      0     2 13939.1254    0  628 18841.8004 13939.1254  26.0%     -    0s
#&gt; H   54    54                    16699.711850 13948.4042  16.5%  35.6    0s
#&gt; H   81    81                    16494.418467 13948.4042  15.4%  28.6    0s
#&gt; H  398   233                    16036.766521 14024.9943  12.5%  29.1    1s
#&gt; H  532   318                    15776.181061 14094.2037  10.7%  27.5    3s
#&gt; H  536   305                    15744.409727 14111.4068  10.4%  27.3    5s
#&gt; 
#&gt; Cutting planes:
#&gt;   Gomory: 23
#&gt; 
#&gt; Explored 550 nodes (19400 simplex iterations) in 5.36 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 10: 15744.4 15776.2 16036.8 ... 20681
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 1.574440972723e+04, best bound 1.417927638980e+04, gap 9.9409%
#&gt; Optimize a model with 1845 rows, 1140 columns and 5100 nonzeros
#&gt; Variable types: 0 continuous, 1140 integer (1140 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [1e+02, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 2e+01]
#&gt; Found heuristic solution: objective 8944.5991236
#&gt; Presolve time: 0.02s
#&gt; Presolved: 1845 rows, 1140 columns, 6840 nonzeros
#&gt; Variable types: 0 continuous, 1140 integer (1140 binary)
#&gt; Presolve removed 870 rows and 0 columns
#&gt; Presolved: 975 rows, 1140 columns, 4230 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 2.563056e+03, 1694 iterations, 0.05 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 2563.05580    0  474 8944.59912 2563.05580  71.3%     -    0s
#&gt; H    0     0                    3069.2198371 2563.05580  16.5%     -    0s
#&gt; H    0     0                    2906.6232765 2563.05580  11.8%     -    0s
#&gt;      0     0 2564.59870    0  302 2906.62328 2564.59870  11.8%     -    0s
#&gt; H    0     0                    2778.4594935 2564.59870  7.70%     -    0s
#&gt; 
#&gt; Cutting planes:
#&gt;   Gomory: 1
#&gt;   Zero half: 2
#&gt; 
#&gt; Explored 1 nodes (1873 simplex iterations) in 0.22 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 4: 2778.46 2906.62 3069.22 8944.6 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 2.778459493522e+03, best bound 2.564598698729e+03, gap 7.6971%
#&gt; Optimize a model with 1555 rows, 995 columns and 4520 nonzeros
#&gt; Variable types: 0 continuous, 995 integer (995 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [3e+01, 4e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 2e+01]
#&gt; Found heuristic solution: objective 21484.599124
#&gt; Presolve time: 0.01s
#&gt; Presolved: 1555 rows, 995 columns, 5680 nonzeros
#&gt; Variable types: 0 continuous, 995 integer (995 binary)
#&gt; Presolve removed 580 rows and 0 columns
#&gt; Presolved: 975 rows, 995 columns, 3940 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 1.364153e+04, 725 iterations, 0.03 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 13641.5316    0  707 21484.5991 13641.5316  36.5%     -    0s
#&gt; H    0     0                    20118.357783 13641.5316  32.2%     -    0s
#&gt;      0     0 13784.2488    0  679 20118.3578 13784.2488  31.5%     -    0s
#&gt; H    0     0                    19664.630462 13784.2488  29.9%     -    0s
#&gt;      0     0 13784.2641    0  679 19664.6305 13784.2641  29.9%     -    0s
#&gt;      0     0 13900.8086    0  701 19664.6305 13900.8086  29.3%     -    0s
#&gt; H    0     0                    19409.148239 13900.8086  28.4%     -    0s
#&gt;      0     0 13912.5611    0  676 19409.1482 13912.5611  28.3%     -    0s
#&gt; H    0     0                    19288.708903 13912.5611  27.9%     -    0s
#&gt; H    0     0                    17847.092485 13912.5611  22.0%     -    0s
#&gt;      0     2 13912.7062    0  676 17847.0925 13912.7062  22.0%     -    0s
#&gt; H  107   107                    16767.069352 13914.2730  17.0%  30.3    1s
#&gt; H  109   109                    16614.015917 13914.2730  16.2%  29.9    1s
#&gt; H  198   156                    16267.614132 13953.3346  14.2%  29.1    1s
#&gt; H  513   401                    16205.508317 13993.9580  13.6%  26.9    2s
#&gt;    528   411 14766.0495   11  689 16205.5083 14018.1943  13.5%  26.1    5s
#&gt; H  528   390                    16165.861688 14024.0128  13.2%  26.1    5s
#&gt; H  532   373                    15984.135882 14024.5280  12.3%  25.9    6s
#&gt; H 1359   710                    15888.485424 14140.0501  11.0%  43.0    9s
#&gt; H 1384   641                    15839.813917 14140.0501  10.7%  42.7    9s
#&gt; 
#&gt; Cutting planes:
#&gt;   Gomory: 20
#&gt;   Zero half: 1
#&gt; 
#&gt; Explored 1472 nodes (65286 simplex iterations) in 10.00 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 10: 15839.8 15888.5 15984.1 ... 19288.7
#&gt; 
#&gt; Time limit reached
#&gt; Best objective 1.583981391655e+04, best bound 1.420276873350e+04, gap 10.3350%
#&gt; Optimize a model with 1120 rows, 705 columns and 3795 nonzeros
#&gt; Variable types: 0 continuous, 705 integer (705 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [1e+01, 4e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 2e+01]
#&gt; Found heuristic solution: objective 15270.408441
#&gt; Presolve time: 0.01s
#&gt; Presolved: 1120 rows, 705 columns, 3940 nonzeros
#&gt; Variable types: 0 continuous, 705 integer (705 binary)
#&gt; Presolved: 1120 rows, 705 columns, 3940 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 9.343390e+03, 558 iterations, 0.02 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 9343.39013    0  500 15270.4084 9343.39013  38.8%     -    0s
#&gt; H    0     0                    14142.830433 9343.39013  33.9%     -    0s
#&gt;      0     0 9438.78818    0  524 14142.8304 9438.78818  33.3%     -    0s
#&gt; H    0     0                    13864.034437 9438.78818  31.9%     -    0s
#&gt;      0     0 9439.41413    0  524 13864.0344 9439.41413  31.9%     -    0s
#&gt;      0     0 9483.24583    0  471 13864.0344 9483.24583  31.6%     -    0s
#&gt; H    0     0                    13566.124047 9483.24583  30.1%     -    0s
#&gt;      0     0 9484.92825    0  471 13566.1240 9484.92825  30.1%     -    0s
#&gt;      0     0 9492.43676    0  471 13566.1240 9492.43676  30.0%     -    0s
#&gt; H    0     0                    13187.591724 9492.43676  28.0%     -    0s
#&gt;      0     0 9493.41104    0  472 13187.5917 9493.41104  28.0%     -    0s
#&gt; H    0     0                    13068.470532 9493.41104  27.4%     -    0s
#&gt;      0     0 9500.95031    0  477 13068.4705 9500.95031  27.3%     -    0s
#&gt;      0     0 9501.22857    0  475 13068.4705 9501.22857  27.3%     -    0s
#&gt;      0     0 9504.08547    0  479 13068.4705 9504.08547  27.3%     -    0s
#&gt;      0     0 9508.72773    0  476 13068.4705 9508.72773  27.2%     -    0s
#&gt;      0     0 9508.93132    0  476 13068.4705 9508.93132  27.2%     -    0s
#&gt;      0     0 9508.99474    0  476 13068.4705 9508.99474  27.2%     -    0s
#&gt;      0     0 9514.73659    0  479 13068.4705 9514.73659  27.2%     -    0s
#&gt;      0     0 9516.60799    0  473 13068.4705 9516.60799  27.2%     -    0s
#&gt;      0     0 9520.88543    0  479 13068.4705 9520.88543  27.1%     -    0s
#&gt; H    0     0                    12932.876362 9520.88543  26.4%     -    0s
#&gt;      0     0 9521.62027    0  479 12932.8764 9521.62027  26.4%     -    0s
#&gt;      0     0 9524.12634    0  484 12932.8764 9524.12634  26.4%     -    0s
#&gt; H    0     0                    12899.262673 9524.12634  26.2%     -    0s
#&gt;      0     0 9525.30406    0  484 12899.2627 9525.30406  26.2%     -    0s
#&gt;      0     0 9525.70866    0  479 12899.2627 9525.70866  26.2%     -    0s
#&gt;      0     0 9525.88939    0  483 12899.2627 9525.88939  26.2%     -    0s
#&gt;      0     0 9525.94172    0  477 12899.2627 9525.94172  26.2%     -    0s
#&gt; H    0     0                    11446.638813 9525.94172  16.8%     -    0s
#&gt; H    0     0                    10953.139238 9525.94172  13.0%     -    1s
#&gt;      0     2 9526.76171    0  477 10953.1392 9526.76171  13.0%     -    1s
#&gt; H   27    27                    10951.493645 9527.99897  13.0%  84.5    1s
#&gt; H   54    42                    10759.439984 9576.05359  11.0%  71.7    1s
#&gt; H   81    63                    10683.985421 9576.05359  10.4%  57.4    1s
#&gt; 
#&gt; Cutting planes:
#&gt;   Gomory: 5
#&gt;   Zero half: 31
#&gt; 
#&gt; Explored 120 nodes (8109 simplex iterations) in 1.51 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 10: 10684 10759.4 10951.5 ... 13566.1
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 1.068398542062e+04, best bound 9.639978494534e+03, gap 9.7717%</div><div class='input'>
<span class='co'># plot solutions</span>
<span class='fu'>plot</span>(<span class='no'>s2</span>, <span class='kw'>main</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"basic solution"</span>, <span class='st'>"within zone clumping (low)"</span>,
                  <span class='st'>"within zone clumping (high)"</span>, <span class='st'>"between zone clumping"</span>,
                  <span class='st'>"within + between clumping"</span>, <span class='st'>"negative clumping"</span>),
     <span class='kw'>axes</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>box</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='img'><img src='add_boundary_penalties-2.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by <a href='http://jeffrey-hanson.com'>Jeffrey O Hanson</a>, <a href='http://www.richard-schuster.com/'>Richard Schuster</a>, Nina Morrell, <a href='http://strimas.com'>Matthew Strimas-Mackey</a>, Matthew E Watts, <a href='http://arcese.forestry.ubc.ca'>Peter Arcese</a>, <a href='https://josephrbennett.wordpress.com/'>Joeseph Bennett</a>, Hugh P Possingham.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

