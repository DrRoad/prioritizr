<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Add connectivity penalties — add_connectivity_penalties • prioritizr</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>



<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
<meta property="og:title" content="Add connectivity penalties — add_connectivity_penalties" />

<meta property="og:description" content="Add penalties to a conservation planning problem to favor
solutions that select planning units with high connectivity between them." />

<meta property="og:image" content="http://prioritizr.github.io/prioritizr/logo.png" />
<meta name="twitter:card" content="summary" />


<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-70466840-4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-70466840-4');
</script>



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">prioritizr</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">4.0.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/prioritizr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/gurobi_installation.html">Gurobi Installation Guide</a>
    </li>
    <li>
      <a href="../articles/publication_record.html">Publication Record</a>
    </li>
    <li>
      <a href="../articles/zones.html">Management Zones</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/prioritizr/prioritizr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Add connectivity penalties</h1>
    <small class="dont-index">Source: <a href='https://github.com/prioritizr/prioritizr/blob/master/R/add_connectivity_penalties.R'><code>R/add_connectivity_penalties.R</code></a></small>
    <div class="hidden name"><code>add_connectivity_penalties.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Add penalties to a conservation planning <code>problem</code> to favor
solutions that select planning units with high connectivity between them.</p>
    
    </div>

    <pre class="usage"><span class='co'># S4 method for ConservationProblem,ANY,ANY,Matrix</span>
<span class='fu'>add_connectivity_penalties</span>(<span class='no'>x</span>, <span class='no'>penalty</span>, <span class='no'>zones</span>, <span class='no'>data</span>)

<span class='co'># S4 method for ConservationProblem,ANY,ANY,matrix</span>
<span class='fu'>add_connectivity_penalties</span>(<span class='no'>x</span>, <span class='no'>penalty</span>, <span class='no'>zones</span>, <span class='no'>data</span>)

<span class='co'># S4 method for ConservationProblem,ANY,ANY,data.frame</span>
<span class='fu'>add_connectivity_penalties</span>(<span class='no'>x</span>, <span class='no'>penalty</span>, <span class='no'>zones</span>, <span class='no'>data</span>)

<span class='co'># S4 method for ConservationProblem,ANY,ANY,array</span>
<span class='fu'>add_connectivity_penalties</span>(<span class='no'>x</span>, <span class='no'>penalty</span>, <span class='no'>zones</span>, <span class='no'>data</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p><code><a href='ConservationProblem-class.html'>ConservationProblem-class</a></code> object.</p></td>
    </tr>
    <tr>
      <th>penalty</th>
      <td><p><code>numeric</code> penalty that is used to scale the importance
of selecting planning units with strong connectivity between them compared
to the main problem objective (e.g. solution cost when the argument to
<code>x</code> has a minimum set objective set using
<code>add_min_set_objective</code>). Higher <code>penalty</code> values
can be used to obtain solutions with a high degree of connectivity,
and smaller <code>penalty</code> values can be used to obtain solutions with a #'   small degree of connectivity. Note that negative <code>penalty</code> values can
be used to obtain solutions that have very little connectivity.</p></td>
    </tr>
    <tr>
      <th>zones</th>
      <td><p><code>matrix</code> or <code>Matrix</code> object describing the
level of connectivity between different zones. Each row and column
corresponds to a different zone in the argument to <code>x</code>, and cell
values indicate the level of connectivity between each combination
of zones. Cell values along the diagonal of the matrix represent
the level of connectivity between planning units allocated to the
same zone. Cell values must lay between 1 and -1, where negative
values favor solutions with weak connectivity. The default argument to
<code>zones</code> is an identity matrix (i.e. a matrix with ones along the
matrix diagonal and zeros elsewhere), so that planning units are
only considered to be connected when they are allocated to the same zone.
This argument is required when the argument to <code>data</code> is a
<code>matrix</code> or <code>Matrix</code> object. If the argument to <code>data</code> is
an <code>array</code> or <code>data.frame</code> with zone data, this argument
must explicitly be set to <code>NULL</code> otherwise an error will be thrown.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p><code>matrix</code>, <code>Matrix</code>, <code>data.frame</code>, or
<code>array</code> object containing connectivity data. The connectivity values
correspond to the strength of connectivity between
different planning units. Thus connections between planning units
that are associated with higher values are more favorable in the solution.
See the Details section for more information.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>not used.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code><a href='ConservationProblem-class.html'>ConservationProblem-class</a></code> object with the penalties
 added to it.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function uses connectivity data to penalize solutions
  that have low connectivity. It can accommodate symmetric and asymmetric
  relationships between planning units. Although <em>Marxan</em>
  <strong>penalizes</strong> connections between planning units with high
  connectivity values, it is important to note that this function
  <strong>favors</strong> connections between planning units with high connectivity
  values. This function was inspired by Beger <em>et al.</em> (2010).</p>
<p>The argument to <code>data</code> can be specified in several different ways:</p>
<p></p><dl class='dl-horizontal'>
    <dt><code>matrix</code>, <code>Matrix</code></dt><dd><p>where rows and columns represent
    different planning units and the value of each cell represents the
    strength of connectivity between two different planning units. Cells
    that occur along the matrix diagonal are treated as weights which
    indicate that planning units are more desirable in the solution.
    The argument to <code>zones</code> can be used to control
    the strength of connectivity between planning units in different zones.
    The default argument for <code>zones</code> is to treat planning units
    allocated to different zones as having zero connectivity.</p></dd>
    <dt><code>data.frame</code></dt><dd><p>containing the fields (columns)
    <code>"id1"</code>, <code>"id2"</code>, and <code>"boundary"</code>. Here, each row
    denotes the connectivity between two planning units following the
    <em>Marxan</em> format. The data can be used to denote symmetric or
    asymmetric relationships between planning units. By default,
    input data is assumed to be symmetric unless asymmetric data is
    also included (e.g. if data is present for planning units 2 and 3, then
    the same amount of connectivity is expected for planning units 3 and 2,
    unless connectivity data is also provided for planning units 3 and 2).
    If the argument to <code>x</code> contains multiple zones, then the columns
    <code>"zone1"</code> and <code>"zone2"</code> can optionally be provided to manually
    specify the connectivity values between planning units when they are
    allocated to specific zones. If the columns <code>"zone1"</code> and
    <code>"zone2"</code> are present, then the argument to <code>zones</code> must be
    <code>NULL</code>.</p></dd>
    <dt><code>array</code></dt><dd><p>containing four-dimensions where cell values
    indicate the strength of connectivity between planning units
    when they are assigned to specific management zones. The first two
    dimensions (i.e. rows and columns) indicate the strength of
    connectivity between different planning units and the second two
    dimensions indicate the different management zones. Thus
    the <code>data[1, 2, 3, 4]</code> indicates the strength of
    connectivity between planning unit 1 and planning unit 2 when planning
    unit 1 is assigned to zone 3 and planning unit 2 is assigned to zone 4.</p></dd>
    </dl>
    <p>The connectivity penalties are calculated using the following equations.
 Let \(I\) represent the set of planning units, \(Z\) represent the set
 of management zones, and $$X_iz$$ represent the decision
 variable for planning unit \(i\) for in zone \(z\) (e.g. with binary
 values one indicating if planning unit is allocated or not). Also, let
 \(p\) represent the argument to <code>penalty</code>, \(D\) represent the
 argument to <code>data</code>, and \(W\) represent the argument to <code>zones</code>.</p>
<p>If the argument to <code>data</code> is supplied
 as a <code>matrix</code> or <code>Matrix</code>, then the penalties are calculated as:</p>
<p>$$
 \sum_{i}^{I} \sum_{j}^{I} \sum_{z}^{Z} \sum_{y}^{Z} (-p \times X_{iz}
 \times X_{jy} \times D_{ij} \times W_{zy})$$</p>
<p>Otherwise, if the argument to <code>data</code> is supplied as a
 <code>data.frame</code> or <code>array</code>, then the penalties are calculated as:</p>
<p>$$
 \sum_{i}^{I} \sum_{j}^{I} \sum_{z}^{Z} \sum_{y}^{Z} (-p \times X_{iz}
 \times X_{jy} \times D_{ijzy})$$</p>
<p>Note that when the problem objective is to maximize some measure of
 benefit and not minimize some measure of cost, the term \(-p\) is
 replaced with \(p\).</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Beger M, Linke S, Watts M, Game E, Treml E, Ball I, and Possingham, HP (2010)
Incorporating asymmetric connectivity into spatial decision making for
conservation, <em>Conservation Letters</em>, 3: 359--368.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='penalties.html'>penalties</a></code>.</p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># load Matrix package for visualizing matrices</span>
<span class='fu'>require</span>(<span class='no'>Matrix</span>)</div><div class='output co'>#&gt; <span class='message'>Loading required package: Matrix</span></div><div class='input'>
<span class='co'># load data</span>
<span class='fu'>data</span>(<span class='no'>sim_pu_polygons</span>, <span class='no'>sim_pu_zones_stack</span>, <span class='no'>sim_features</span>, <span class='no'>sim_features_zones</span>)

<span class='co'># define function to rescale values between zero and one so that we</span>
<span class='co'># can compare solutions from different connectivity matrices</span>
<span class='no'>rescale</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>x</span>, <span class='no'>to</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>1</span>), <span class='no'>from</span> <span class='kw'>=</span> <span class='fu'>range</span>(<span class='no'>x</span>, <span class='kw'>na.rm</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)) {
  (<span class='no'>x</span> - <span class='no'>from</span>[<span class='fl'>1</span>]) / <span class='fu'>diff</span>(<span class='no'>from</span>) * <span class='fu'>diff</span>(<span class='no'>to</span>) + <span class='no'>to</span>[<span class='fl'>1</span>]
}

<span class='co'># create basic problem</span>
<span class='no'>p1</span> <span class='kw'>&lt;-</span> <span class='fu'>problem</span>(<span class='no'>sim_pu_polygons</span>, <span class='no'>sim_features</span>, <span class='st'>"cost"</span>) <span class='kw'>%&gt;%</span>
      <span class='fu'>add_min_set_objective</span>() <span class='kw'>%&gt;%</span>
      <span class='fu'>add_relative_targets</span>(<span class='fl'>0.2</span>)

<span class='co'># create a symmetric connectivity matrix where the connectivity between</span>
<span class='co'># two planning units corresponds to their shared boundary length</span>
<span class='no'>b_matrix</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='boundary_matrix.html'>boundary_matrix</a></span>(<span class='no'>sim_pu_polygons</span>)

<span class='co'># standardize matrix values to lay between zero and one</span>
<span class='no'>b_matrix</span>[] <span class='kw'>&lt;-</span> <span class='fu'>rescale</span>(<span class='no'>b_matrix</span>[])

<span class='co'># visualize connectivity matrix</span>
<span class='fu'>image</span>(<span class='no'>b_matrix</span>)</div><div class='img'><img src='add_connectivity_penalties-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># create a symmetric connectivity matrix where the connectivity between</span>
<span class='co'># two planning units corresponds to their spatial proximity</span>
<span class='co'># i.e. planning units that are further apart share less connectivity</span>
<span class='no'>centroids</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>rgeos</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/rgeos/topics/topo-unary-gCentroid'>gCentroid</a></span>(<span class='no'>sim_pu_polygons</span>, <span class='kw'>byid</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='no'>d_matrix</span> <span class='kw'>&lt;-</span> (<span class='fl'>1</span> / (<span class='fu'><a href='as.html'>as</a></span>(<span class='fu'>dist</span>(<span class='no'>centroids</span>@<span class='kw'>coords</span>), <span class='st'>"Matrix"</span>) + <span class='fl'>1</span>))

<span class='co'># standardize matrix values to lay between zero and one</span>
<span class='no'>d_matrix</span>[] <span class='kw'>&lt;-</span> <span class='fu'>rescale</span>(<span class='no'>d_matrix</span>[])

<span class='co'># remove connections between planning units without connectivity to</span>
<span class='co'># reduce run-time</span>
<span class='no'>d_matrix</span>[<span class='no'>d_matrix</span> <span class='kw'>&lt;</span> <span class='fl'>0.7</span>] <span class='kw'>&lt;-</span> <span class='fl'>0</span>

<span class='co'># visualize connectivity matrix</span>
<span class='fu'>image</span>(<span class='no'>d_matrix</span>)</div><div class='img'><img src='add_connectivity_penalties-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># create a symmetric connectivity matrix where the connectivity</span>
<span class='co'># between adjacent two planning units corresponds to their combined</span>
<span class='co'># value in a field in the planning unit attribute data</span>
<span class='co'># for example, this field could describe the extent of native vegetation in</span>
<span class='co'># each planning unit and we could use connectivity penalties to identify</span>
<span class='co'># solutions that cluster planning units together that both contain large</span>
<span class='co'># amounts of native vegetation</span>
<span class='no'>c_matrix</span> <span class='kw'>&lt;-</span> <span class='fu'>connectivity_matrix</span>(<span class='no'>sim_pu_polygons</span>, <span class='st'>"cost"</span>)

<span class='co'># standardize matrix values to lay between zero and one</span>
<span class='no'>c_matrix</span>[] <span class='kw'>&lt;-</span> <span class='fu'>rescale</span>(<span class='no'>c_matrix</span>[])

<span class='co'># visualize connectivity matrix</span>
<span class='fu'>image</span>(<span class='no'>c_matrix</span>)</div><div class='img'><img src='add_connectivity_penalties-3.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># create an asymmetric connectivity matrix. Here, connectivity occurs between</span>
<span class='co'># adjacent planning units and, due to rivers flowing southwards</span>
<span class='co'># through the study area, connectivity from northern planning units to</span>
<span class='co'># southern planning units is ten times stronger than the reverse.</span>
<span class='no'>ac_matrix</span> <span class='kw'>&lt;-</span> <span class='fu'>matrix</span>(<span class='fl'>0</span>, <span class='fu'>length</span>(<span class='no'>sim_pu_polygons</span>), <span class='fu'>length</span>(<span class='no'>sim_pu_polygons</span>))
<span class='no'>ac_matrix</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='as.html'>as</a></span>(<span class='no'>ac_matrix</span>, <span class='st'>"Matrix"</span>)
<span class='no'>adjacent_units</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>rgeos</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/rgeos/topics/pred-binary-gIntersects'>gIntersects</a></span>(<span class='no'>sim_pu_polygons</span>, <span class='kw'>byid</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='kw'>for</span> (<span class='no'>i</span> <span class='kw'>in</span> <span class='fu'>seq_len</span>(<span class='fu'>length</span>(<span class='no'>sim_pu_polygons</span>))) {
  <span class='kw'>for</span> (<span class='no'>j</span> <span class='kw'>in</span> <span class='fu'>seq_len</span>(<span class='fu'>length</span>(<span class='no'>sim_pu_polygons</span>))) {
    <span class='co'># find if planning units are adjacent</span>
    <span class='kw'>if</span> (<span class='no'>adjacent_units</span>[<span class='no'>i</span>, <span class='no'>j</span>]) {
      <span class='co'># find if planning units lay north and south of each other</span>
      <span class='co'># i.e. they have the same x-coordinate</span>
      <span class='kw'>if</span> (<span class='no'>centroids</span>@<span class='kw'>coords</span>[<span class='no'>i</span>, <span class='fl'>1</span>] <span class='kw'>==</span> <span class='no'>centroids</span>@<span class='kw'>coords</span>[<span class='no'>j</span>, <span class='fl'>1</span>]) {
        <span class='kw'>if</span> (<span class='no'>centroids</span>@<span class='kw'>coords</span>[<span class='no'>i</span>, <span class='fl'>2</span>] <span class='kw'>&gt;</span> <span class='no'>centroids</span>@<span class='kw'>coords</span>[<span class='no'>j</span>, <span class='fl'>2</span>]) {
          <span class='co'># if i is north of j add 10 units of connectivity</span>
          <span class='no'>ac_matrix</span>[<span class='no'>i</span>, <span class='no'>j</span>] <span class='kw'>&lt;-</span> <span class='no'>ac_matrix</span>[<span class='no'>i</span>, <span class='no'>j</span>] + <span class='fl'>10</span>
        } <span class='kw'>else</span> <span class='kw'>if</span> (<span class='no'>centroids</span>@<span class='kw'>coords</span>[<span class='no'>i</span>, <span class='fl'>2</span>] <span class='kw'>&lt;</span> <span class='no'>centroids</span>@<span class='kw'>coords</span>[<span class='no'>j</span>, <span class='fl'>2</span>]) {
          <span class='co'># if i is south of j add 1 unit of connectivity</span>
          <span class='no'>ac_matrix</span>[<span class='no'>i</span>, <span class='no'>j</span>] <span class='kw'>&lt;-</span> <span class='no'>ac_matrix</span>[<span class='no'>i</span>, <span class='no'>j</span>] + <span class='fl'>1</span>
        }
      }
    }
  }
}

<span class='co'># standardize matrix values to lay between zero and one</span>
<span class='no'>ac_matrix</span>[] <span class='kw'>&lt;-</span> <span class='fu'>rescale</span>(<span class='no'>ac_matrix</span>[])

<span class='co'># visualize asymmetric connectivity matrix</span>
<span class='fu'>image</span>(<span class='no'>ac_matrix</span>)</div><div class='img'><img src='add_connectivity_penalties-4.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># create penalties</span>
<span class='no'>penalties</span> <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='fl'>10</span>, <span class='fl'>25</span>)

<span class='co'># create problems using the different connectivity matrices and penalties</span>
<span class='no'>p2</span> <span class='kw'>&lt;-</span> <span class='fu'>list</span>(<span class='no'>p1</span>,
           <span class='no'>p1</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties</span>[<span class='fl'>1</span>], <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>b_matrix</span>),
           <span class='no'>p1</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties</span>[<span class='fl'>2</span>], <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>b_matrix</span>),
           <span class='no'>p1</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties</span>[<span class='fl'>1</span>], <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>d_matrix</span>),
           <span class='no'>p1</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties</span>[<span class='fl'>2</span>], <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>d_matrix</span>),
           <span class='no'>p1</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties</span>[<span class='fl'>1</span>], <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>c_matrix</span>),
           <span class='no'>p1</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties</span>[<span class='fl'>2</span>], <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>c_matrix</span>),
           <span class='no'>p1</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties</span>[<span class='fl'>1</span>], <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>ac_matrix</span>),
           <span class='no'>p1</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties</span>[<span class='fl'>2</span>], <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>ac_matrix</span>))

<span class='co'># assign names to the problems</span>
<span class='fu'>names</span>(<span class='no'>p2</span>) <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='st'>"basic problem"</span>,
               <span class='fu'>paste0</span>(<span class='st'>"b_matrix ("</span>, <span class='no'>penalties</span>,<span class='st'>")"</span>),
               <span class='fu'>paste0</span>(<span class='st'>"d_matrix ("</span>, <span class='no'>penalties</span>,<span class='st'>")"</span>),
               <span class='fu'>paste0</span>(<span class='st'>"c_matrix ("</span>, <span class='no'>penalties</span>,<span class='st'>")"</span>),
               <span class='fu'>paste0</span>(<span class='st'>"ac_matrix ("</span>, <span class='no'>penalties</span>,<span class='st'>")"</span>))</div><div class='input'><span class='co'># solve problems</span>
<span class='no'>s2</span> <span class='kw'>&lt;-</span> <span class='fu'>lapply</span>(<span class='no'>p2</span>, <span class='no'>solve</span>)</div><div class='output co'>#&gt; Optimize a model with 5 rows, 90 columns and 450 nonzeros
#&gt; Variable types: 0 continuous, 90 integer (90 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 9e-01]
#&gt;   Objective range  [2e+02, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [6e+00, 1e+01]
#&gt; Found heuristic solution: objective 4135.2744673
#&gt; Presolve time: 0.00s
#&gt; Presolved: 5 rows, 90 columns, 450 nonzeros
#&gt; Variable types: 0 continuous, 90 integer (90 binary)
#&gt; Presolved: 5 rows, 90 columns, 450 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 3.490348e+03, 17 iterations, 0.00 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 3490.34813    0    4 4135.27447 3490.34813  15.6%     -    0s
#&gt; H    0     0                    3597.0951275 3490.34813  2.97%     -    0s
#&gt; 
#&gt; Explored 1 nodes (17 simplex iterations) in 0.00 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 2: 3597.1 4135.27 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 3.597095127479e+03, best bound 3.490348127696e+03, gap 2.9676%
#&gt; Optimize a model with 581 rows, 378 columns and 1602 nonzeros
#&gt; Variable types: 0 continuous, 378 integer (378 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [3e+00, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [6e+00, 1e+01]
#&gt; Found heuristic solution: objective 17287.196992
#&gt; Found heuristic solution: objective 3875.2744673
#&gt; Presolve time: 0.00s
#&gt; Presolved: 581 rows, 378 columns, 1602 nonzeros
#&gt; Variable types: 0 continuous, 378 integer (378 binary)
#&gt; Presolved: 581 rows, 378 columns, 1602 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 3.310115e+03, 205 iterations, 0.00 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 3310.11483    0   85 3875.27447 3310.11483  14.6%     -    0s
#&gt; H    0     0                    3421.9248704 3310.11483  3.27%     -    0s
#&gt; 
#&gt; Explored 1 nodes (205 simplex iterations) in 0.01 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 3: 3421.92 3875.27 17287.2 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 3.421924870447e+03, best bound 3.310114828551e+03, gap 3.2675%
#&gt; Optimize a model with 581 rows, 378 columns and 1602 nonzeros
#&gt; Variable types: 0 continuous, 378 integer (378 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [8e+00, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [6e+00, 1e+01]
#&gt; Found heuristic solution: objective 15487.196992
#&gt; Found heuristic solution: objective 3485.2744673
#&gt; Presolve time: 0.00s
#&gt; Presolved: 581 rows, 378 columns, 1602 nonzeros
#&gt; Variable types: 0 continuous, 378 integer (378 binary)
#&gt; Presolved: 581 rows, 378 columns, 1602 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 3.010787e+03, 187 iterations, 0.00 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 3010.78726    0  145 3485.27447 3010.78726  13.6%     -    0s
#&gt; H    0     0                    3433.9909760 3010.78726  12.3%     -    0s
#&gt; H    0     0                    3113.1533887 3010.78726  3.29%     -    0s
#&gt; 
#&gt; Explored 1 nodes (187 simplex iterations) in 0.01 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 4: 3113.15 3433.99 3485.27 15487.2 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 3.113153388664e+03, best bound 3.010787262449e+03, gap 3.2882%
#&gt; Optimize a model with 1601 rows, 888 columns and 3642 nonzeros
#&gt; Variable types: 0 continuous, 888 integer (888 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [7e+00, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [6e+00, 1e+01]
#&gt; Found heuristic solution: objective 11397.038660
#&gt; Found heuristic solution: objective 3043.4684817
#&gt; Presolve time: 0.01s
#&gt; Presolved: 1601 rows, 888 columns, 3642 nonzeros
#&gt; Variable types: 0 continuous, 888 integer (888 binary)
#&gt; Presolved: 1601 rows, 888 columns, 3642 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 2.275745e+03, 633 iterations, 0.03 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 2275.74547    0  868 3043.46848 2275.74547  25.2%     -    0s
#&gt;      0     0 2281.28094    0  865 3043.46848 2281.28094  25.0%     -    2s
#&gt;      0     0 2282.10576    0  865 3043.46848 2282.10576  25.0%     -    2s
#&gt;      0     0 2282.14255    0  865 3043.46848 2282.14255  25.0%     -    2s
#&gt;      0     0 2287.53842    0  862 3043.46848 2287.53842  24.8%     -    2s
#&gt;      0     0 2287.53842    0  478 3043.46848 2287.53842  24.8%     -    2s
#&gt;      0     0 2288.37532    0  475 3043.46848 2288.37532  24.8%     -    2s
#&gt;      0     0 2295.64798    0  465 3043.46848 2295.64798  24.6%     -    2s
#&gt;      0     0 2298.81228    0  477 3043.46848 2298.81228  24.5%     -    2s
#&gt;      0     0 2305.84947    0  463 3043.46848 2305.84947  24.2%     -    2s
#&gt;      0     0 2306.74710    0  463 3043.46848 2306.74710  24.2%     -    2s
#&gt;      0     0 2316.62740    0  474 3043.46848 2316.62740  23.9%     -    2s
#&gt;      0     0 2323.37962    0  459 3043.46848 2323.37962  23.7%     -    2s
#&gt;      0     0 2323.67300    0  459 3043.46848 2323.67300  23.7%     -    2s
#&gt; H    0     0                    2765.8350681 2323.67300  16.0%     -    2s
#&gt; H    0     0                    2733.2191028 2323.67300  15.0%     -    2s
#&gt;      0     2 2323.78958    0  459 2733.21910 2323.78958  15.0%     -    2s
#&gt; H   54    54                    2669.3297484 2371.03098  11.2%  64.1    2s
#&gt; H  270   156                    2619.0227429 2388.81447  8.79%  66.6    3s
#&gt; 
#&gt; Cutting planes:
#&gt;   Gomory: 8
#&gt; 
#&gt; Explored 270 nodes (19573 simplex iterations) in 3.56 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 6: 2619.02 2669.33 2733.22 ... 11397
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 2.619022742918e+03, best bound 2.388814465569e+03, gap 8.7899%
#&gt; Optimize a model with 1601 rows, 888 columns and 3642 nonzeros
#&gt; Variable types: 0 continuous, 888 integer (888 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [2e+01, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [6e+00, 1e+01]
#&gt; Found heuristic solution: objective 761.8011610
#&gt; Presolve time: 0.01s
#&gt; Presolved: 1601 rows, 888 columns, 3642 nonzeros
#&gt; Variable types: 0 continuous, 888 integer (888 binary)
#&gt; Presolved: 1601 rows, 888 columns, 3642 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 1.263202e+02, 251 iterations, 0.01 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0  126.32023    0  695  761.80116  126.32023  83.4%     -    0s
#&gt; H    0     0                     468.0158310  126.32023  73.0%     -    0s
#&gt;      0     0  139.14045    0  693  468.01583  139.14045  70.3%     -    1s
#&gt;      0     0  146.51646    0  681  468.01583  146.51646  68.7%     -    2s
#&gt;      0     0  146.51646    0  382  468.01583  146.51646  68.7%     -    2s
#&gt;      0     0  169.79060    0  379  468.01583  169.79060  63.7%     -    2s
#&gt;      0     0  171.69652    0  378  468.01583  171.69652  63.3%     -    2s
#&gt;      0     0  184.91312    0  373  468.01583  184.91312  60.5%     -    2s
#&gt;      0     0  190.80416    0  356  468.01583  190.80416  59.2%     -    2s
#&gt;      0     2  191.86320    0  356  468.01583  191.86320  59.0%     -    2s
#&gt; H    1     1                     430.9606450  191.86320  55.5%   0.0    2s
#&gt; H   23     7                     421.3259805  287.97695  31.6%  50.8    2s
#&gt; 
#&gt; Cutting planes:
#&gt;   Gomory: 5
#&gt; 
#&gt; Explored 39 nodes (2422 simplex iterations) in 2.72 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 4: 421.326 430.961 468.016 761.801 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 4.213259804528e+02, best bound 4.099909828511e+02, gap 2.6903%
#&gt; Optimize a model with 581 rows, 378 columns and 1602 nonzeros
#&gt; Variable types: 0 continuous, 378 integer (378 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [9e+00, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [6e+00, 1e+01]
#&gt; Found heuristic solution: objective 15721.108025
#&gt; Found heuristic solution: objective 3676.6172279
#&gt; Presolve time: 0.00s
#&gt; Presolved: 581 rows, 378 columns, 1602 nonzeros
#&gt; Variable types: 0 continuous, 378 integer (378 binary)
#&gt; Presolved: 581 rows, 378 columns, 1602 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 3.113584e+03, 201 iterations, 0.00 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 3113.58408    0  264 3676.61723 3113.58408  15.3%     -    0s
#&gt; H    0     0                    3670.6448858 3113.58408  15.2%     -    0s
#&gt; H    0     0                    3482.5813545 3113.58408  10.6%     -    0s
#&gt; H    0     0                    3300.6135022 3113.58408  5.67%     -    0s
#&gt; 
#&gt; Explored 1 nodes (201 simplex iterations) in 0.01 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 5: 3300.61 3482.58 3670.64 ... 15721.1
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 3.300613502163e+03, best bound 3.113584082878e+03, gap 5.6665%
#&gt; Optimize a model with 581 rows, 378 columns and 1602 nonzeros
#&gt; Variable types: 0 continuous, 378 integer (378 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [2e+01, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [6e+00, 1e+01]
#&gt; Found heuristic solution: objective 11571.974576
#&gt; Found heuristic solution: objective 2988.6313687
#&gt; Presolve time: 0.00s
#&gt; Presolved: 581 rows, 378 columns, 1602 nonzeros
#&gt; Variable types: 0 continuous, 378 integer (378 binary)
#&gt; Presolved: 581 rows, 378 columns, 1602 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 2.306875e+03, 224 iterations, 0.01 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 2306.87485    0  362 2988.63137 2306.87485  22.8%     -    0s
#&gt;      0     0 2326.16192    0  359 2988.63137 2326.16192  22.2%     -    0s
#&gt;      0     0 2336.33515    0  363 2988.63137 2336.33515  21.8%     -    0s
#&gt;      0     0 2336.33515    0  224 2988.63137 2336.33515  21.8%     -    0s
#&gt;      0     0 2345.37958    0  221 2988.63137 2345.37958  21.5%     -    0s
#&gt;      0     0 2349.41459    0  221 2988.63137 2349.41459  21.4%     -    0s
#&gt;      0     0 2351.22439    0  224 2988.63137 2351.22439  21.3%     -    0s
#&gt;      0     0 2351.45616    0  224 2988.63137 2351.45616  21.3%     -    0s
#&gt;      0     0 2363.38808    0  203 2988.63137 2363.38808  20.9%     -    0s
#&gt;      0     0 2363.65363    0  188 2988.63137 2363.65363  20.9%     -    0s
#&gt; H    0     0                    2958.6671750 2363.65363  20.1%     -    0s
#&gt; H    0     0                    2822.1679287 2363.65363  16.2%     -    0s
#&gt; H    0     0                    2767.2001012 2363.65363  14.6%     -    0s
#&gt;      0     2 2363.98827    0  188 2767.20010 2363.98827  14.6%     -    0s
#&gt; H   54    54                    2755.2498113 2370.63044  14.0%  15.6    0s
#&gt; H   58    58                    2715.4298095 2370.63044  12.7%  15.0    0s
#&gt; H  150   127                    2663.1104699 2387.10998  10.4%  11.6    0s
#&gt; 
#&gt; Cutting planes:
#&gt;   Gomory: 5
#&gt; 
#&gt; Explored 299 nodes (4360 simplex iterations) in 0.46 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 8: 2663.11 2715.43 2755.25 ... 11572
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 2.663110469894e+03, best bound 2.420490587999e+03, gap 9.1104%
#&gt; Optimize a model with 293 rows, 234 columns and 1026 nonzeros
#&gt; Variable types: 0 continuous, 234 integer (234 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [1e+00, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [6e+00, 1e+01]
#&gt; Found heuristic solution: objective 17098.178722
#&gt; Found heuristic solution: objective 4014.2744673
#&gt; Presolve time: 0.00s
#&gt; Presolved: 293 rows, 234 columns, 1026 nonzeros
#&gt; Variable types: 0 continuous, 234 integer (234 binary)
#&gt; Presolved: 293 rows, 234 columns, 1026 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 3.403536e+03, 90 iterations, 0.00 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 3403.53635    0   30 4014.27447 3403.53635  15.2%     -    0s
#&gt; H    0     0                    3510.3626352 3403.53635  3.04%     -    0s
#&gt; 
#&gt; Explored 1 nodes (90 simplex iterations) in 0.01 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 3: 3510.36 4014.27 17098.2 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 3.510362635219e+03, best bound 3.403536347653e+03, gap 3.0432%
#&gt; Optimize a model with 293 rows, 234 columns and 1026 nonzeros
#&gt; Variable types: 0 continuous, 234 integer (234 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [2e+00, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [6e+00, 1e+01]
#&gt; Found heuristic solution: objective 15910.178722
#&gt; Found heuristic solution: objective 3832.7744673
#&gt; Presolve time: 0.00s
#&gt; Presolved: 293 rows, 234 columns, 1026 nonzeros
#&gt; Variable types: 0 continuous, 234 integer (234 binary)
#&gt; Presolved: 293 rows, 234 columns, 1026 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 3.203422e+03, 115 iterations, 0.00 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 3203.42200    0   52 3832.77447 3203.42200  16.4%     -    0s
#&gt; H    0     0                    3314.2660306 3203.42200  3.34%     -    0s
#&gt; 
#&gt; Explored 1 nodes (115 simplex iterations) in 0.01 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 3: 3314.27 3832.77 15910.2 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 3.314266030558e+03, best bound 3.203422001730e+03, gap 3.3445%</div><div class='input'>
<span class='co'># plot solutions</span>
<span class='fu'>par</span>(<span class='kw'>mfrow</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>3</span>, <span class='fl'>3</span>))
<span class='kw'>for</span> (<span class='no'>i</span> <span class='kw'>in</span> <span class='fu'>seq_along</span>(<span class='no'>s2</span>)) {
  <span class='fu'>plot</span>(<span class='no'>s2</span><span class='kw'>[[</span><span class='no'>i</span>]], <span class='kw'>main</span> <span class='kw'>=</span> <span class='fu'>names</span>(<span class='no'>p2</span>)[<span class='no'>i</span>], <span class='kw'>cex</span> <span class='kw'>=</span> <span class='fl'>1.5</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"white"</span>)
  <span class='fu'>plot</span>(<span class='no'>s2</span><span class='kw'>[[</span><span class='no'>i</span>]][<span class='no'>s2</span><span class='kw'>[[</span><span class='no'>i</span>]]$<span class='no'>solution_1</span> <span class='kw'>==</span> <span class='fl'>1</span>, ], <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"darkgreen"</span>, <span class='kw'>add</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
}</div><div class='img'><img src='add_connectivity_penalties-5.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># create minimal multi-zone problem and limit solver to one minute</span>
<span class='co'># to obtain solutions in a short period of time</span>
<span class='no'>p3</span> <span class='kw'>&lt;-</span> <span class='fu'>problem</span>(<span class='no'>sim_pu_zones_stack</span>, <span class='no'>sim_features_zones</span>) <span class='kw'>%&gt;%</span>
      <span class='fu'>add_min_set_objective</span>() <span class='kw'>%&gt;%</span>
      <span class='fu'>add_relative_targets</span>(<span class='fu'>matrix</span>(<span class='fl'>0.15</span>, <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>3</span>)) <span class='kw'>%&gt;%</span>
      <span class='fu'>add_binary_decisions</span>() <span class='kw'>%&gt;%</span>
      <span class='fu'><a href='add_default_solver.html'>add_default_solver</a></span>(<span class='kw'>time_limit</span> <span class='kw'>=</span> <span class='fl'>60</span>)

<span class='co'># create matrix showing which planning units are adjacent to other units</span>
<span class='no'>a_matrix</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='connected_matrix.html'>connected_matrix</a></span>(<span class='no'>sim_pu_zones_stack</span>)

<span class='co'># visualize matrix</span>
<span class='fu'>image</span>(<span class='no'>a_matrix</span>)</div><div class='img'><img src='add_connectivity_penalties-6.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># create a zone matrix where connectivities are only present between</span>
<span class='co'># planning units that are allocated to the same zone</span>
<span class='no'>zm1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='as.html'>as</a></span>(<span class='fu'>diag</span>(<span class='fl'>3</span>), <span class='st'>"Matrix"</span>)

<span class='co'># print zone matrix</span>
<span class='fu'><a href='print.html'>print</a></span>(<span class='no'>zm1</span>)</div><div class='output co'>#&gt;      [,1] [,2] [,3]
#&gt; [1,]    1    .    .
#&gt; [2,]    .    1    .
#&gt; [3,]    .    .    1</div><div class='input'>
<span class='co'># create a zone matrix where connectivities are strongest between</span>
<span class='co'># planning units allocated to different zones</span>
<span class='no'>zm2</span> <span class='kw'>&lt;-</span> <span class='fu'>matrix</span>(<span class='fl'>1</span>, <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='fl'>3</span>)
<span class='fu'>diag</span>(<span class='no'>zm2</span>) <span class='kw'>&lt;-</span> <span class='fl'>0</span>
<span class='no'>zm2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='as.html'>as</a></span>(<span class='no'>zm2</span>, <span class='st'>"Matrix"</span>)

<span class='co'># print zone matrix</span>
<span class='fu'><a href='print.html'>print</a></span>(<span class='no'>zm2</span>)</div><div class='output co'>#&gt; 3 x 3 Matrix of class "dsyMatrix"
#&gt;      [,1] [,2] [,3]
#&gt; [1,]    0    1    1
#&gt; [2,]    1    0    1
#&gt; [3,]    1    1    0</div><div class='input'>
<span class='co'># create a zone matrix that indicates that connectivities between planning</span>
<span class='co'># units assigned to the same zone are much higher than connectivities</span>
<span class='co'># assigned to different zones</span>
<span class='no'>zm3</span> <span class='kw'>&lt;-</span> <span class='fu'>matrix</span>(<span class='fl'>0.1</span>, <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='fl'>3</span>)
<span class='fu'>diag</span>(<span class='no'>zm3</span>) <span class='kw'>&lt;-</span> <span class='fl'>1</span>
<span class='no'>zm3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='as.html'>as</a></span>(<span class='no'>zm3</span>, <span class='st'>"Matrix"</span>)

<span class='co'># print zone matrix</span>
<span class='fu'><a href='print.html'>print</a></span>(<span class='no'>zm3</span>)</div><div class='output co'>#&gt; 3 x 3 Matrix of class "dsyMatrix"
#&gt;      [,1] [,2] [,3]
#&gt; [1,]  1.0  0.1  0.1
#&gt; [2,]  0.1  1.0  0.1
#&gt; [3,]  0.1  0.1  1.0</div><div class='input'>
<span class='co'># create a zone matrix that indicates that connectivities between planning</span>
<span class='co'># units allocated to zone 1 are very high, connectivities between planning</span>
<span class='co'># units allocated to zones 1 and 2 are moderately high, and connectivities</span>
<span class='co'># planning units allocated to other zones are low</span>
<span class='no'>zm4</span> <span class='kw'>&lt;-</span> <span class='fu'>matrix</span>(<span class='fl'>0.1</span>, <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='fl'>3</span>)
<span class='no'>zm4</span>[<span class='fl'>1</span>, <span class='fl'>1</span>] <span class='kw'>&lt;-</span> <span class='fl'>1</span>
<span class='no'>zm4</span>[<span class='fl'>1</span>, <span class='fl'>2</span>] <span class='kw'>&lt;-</span> <span class='fl'>0.5</span>
<span class='no'>zm4</span>[<span class='fl'>2</span>, <span class='fl'>1</span>] <span class='kw'>&lt;-</span> <span class='fl'>0.5</span>
<span class='no'>zm4</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='as.html'>as</a></span>(<span class='no'>zm4</span>, <span class='st'>"Matrix"</span>)

<span class='co'># print zone matrix</span>
<span class='fu'><a href='print.html'>print</a></span>(<span class='no'>zm4</span>)</div><div class='output co'>#&gt; 3 x 3 Matrix of class "dsyMatrix"
#&gt;      [,1] [,2] [,3]
#&gt; [1,]  1.0  0.5  0.1
#&gt; [2,]  0.5  0.1  0.1
#&gt; [3,]  0.1  0.1  0.1</div><div class='input'>
<span class='co'># create a zone matrix with strong connectivities between planning units</span>
<span class='co'># allocated to the same zone, moderate connectivities between planning</span>
<span class='co'># unit allocated to zone 1 and zone 2, and negative connectivities between</span>
<span class='co'># planning units allocated to zone 3 and the other two zones</span>
<span class='no'>zm5</span> <span class='kw'>&lt;-</span> <span class='fu'>matrix</span>(-<span class='fl'>1</span>, <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='fl'>3</span>)
<span class='no'>zm5</span>[<span class='fl'>1</span>, <span class='fl'>2</span>] <span class='kw'>&lt;-</span> <span class='fl'>0.5</span>
<span class='no'>zm5</span>[<span class='fl'>2</span>, <span class='fl'>1</span>] <span class='kw'>&lt;-</span> <span class='fl'>0.5</span>
<span class='fu'>diag</span>(<span class='no'>zm5</span>) <span class='kw'>&lt;-</span> <span class='fl'>1</span>
<span class='no'>zm5</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='as.html'>as</a></span>(<span class='no'>zm5</span>, <span class='st'>"Matrix"</span>)

<span class='co'># print zone matrix</span>
<span class='fu'><a href='print.html'>print</a></span>(<span class='no'>zm5</span>)</div><div class='output co'>#&gt; 3 x 3 Matrix of class "dsyMatrix"
#&gt;      [,1] [,2] [,3]
#&gt; [1,]  1.0  0.5   -1
#&gt; [2,]  0.5  1.0   -1
#&gt; [3,] -1.0 -1.0    1</div><div class='input'>
<span class='co'># create vector of penalties to use creating problems</span>
<span class='no'>penalties2</span> <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='fl'>5</span>, <span class='fl'>30</span>)

<span class='co'># create multi-zone problems using the adjacent connectivity matrix and</span>
<span class='co'># different zone matrices</span>
<span class='no'>p4</span> <span class='kw'>&lt;-</span> <span class='fu'>list</span>(
  <span class='no'>p3</span>,
  <span class='no'>p3</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties2</span>[<span class='fl'>1</span>], <span class='no'>zm1</span>, <span class='no'>a_matrix</span>),
  <span class='no'>p3</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties2</span>[<span class='fl'>2</span>], <span class='no'>zm1</span>, <span class='no'>a_matrix</span>),
  <span class='no'>p3</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties2</span>[<span class='fl'>1</span>], <span class='no'>zm2</span>, <span class='no'>a_matrix</span>),
  <span class='no'>p3</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties2</span>[<span class='fl'>2</span>], <span class='no'>zm2</span>, <span class='no'>a_matrix</span>),
  <span class='no'>p3</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties2</span>[<span class='fl'>1</span>], <span class='no'>zm3</span>, <span class='no'>a_matrix</span>),
  <span class='no'>p3</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties2</span>[<span class='fl'>2</span>], <span class='no'>zm3</span>, <span class='no'>a_matrix</span>),
  <span class='no'>p3</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties2</span>[<span class='fl'>1</span>], <span class='no'>zm4</span>, <span class='no'>a_matrix</span>),
  <span class='no'>p3</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties2</span>[<span class='fl'>2</span>], <span class='no'>zm4</span>, <span class='no'>a_matrix</span>),
  <span class='no'>p3</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties2</span>[<span class='fl'>1</span>], <span class='no'>zm5</span>, <span class='no'>a_matrix</span>),
  <span class='no'>p3</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties2</span>[<span class='fl'>2</span>], <span class='no'>zm5</span>, <span class='no'>a_matrix</span>))

<span class='co'># assign names to the problems</span>
<span class='fu'>names</span>(<span class='no'>p4</span>) <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='st'>"basic problem"</span>,
               <span class='fu'>paste0</span>(<span class='st'>"zm"</span>, <span class='fu'>rep</span>(<span class='fu'>seq_len</span>(<span class='fl'>5</span>), <span class='kw'>each</span> <span class='kw'>=</span> <span class='fl'>2</span>), <span class='st'>" ("</span>,
                      <span class='fu'>rep</span>(<span class='no'>penalties2</span>, <span class='fl'>2</span>), <span class='st'>")"</span>))</div><div class='input'><span class='co'># solve problems</span>
<span class='no'>s4</span> <span class='kw'>&lt;-</span> <span class='fu'>lapply</span>(<span class='no'>p4</span>, <span class='no'>solve</span>)</div><div class='output co'>#&gt; Optimize a model with 105 rows, 270 columns and 1620 nonzeros
#&gt; Variable types: 0 continuous, 270 integer (270 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [2e+02, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 1e+01]
#&gt; Found heuristic solution: objective 9899.8049463
#&gt; Presolve time: 0.01s
#&gt; Presolved: 105 rows, 270 columns, 1620 nonzeros
#&gt; Variable types: 0 continuous, 270 integer (270 binary)
#&gt; Presolved: 105 rows, 270 columns, 1620 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 8.982643e+03, 108 iterations, 0.00 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 8982.64287    0   12 9899.80495 8982.64287  9.26%     -    0s
#&gt; 
#&gt; Explored 1 nodes (108 simplex iterations) in 0.01 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 1: 9899.8 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 9.899804946308e+03, best bound 8.982642866145e+03, gap 9.2644%
#&gt; Optimize a model with 1845 rows, 1140 columns and 5100 nonzeros
#&gt; Variable types: 0 continuous, 1140 integer (1140 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [5e+00, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 1e+01]
#&gt; Found heuristic solution: objective 9799.8049463
#&gt; Presolve time: 0.03s
#&gt; Presolved: 1845 rows, 1140 columns, 5100 nonzeros
#&gt; Variable types: 0 continuous, 1140 integer (1140 binary)
#&gt; Presolved: 1845 rows, 1140 columns, 5100 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 8.413443e+03, 634 iterations, 0.05 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 8413.44326    0  500 9799.80495 8413.44326  14.1%     -    0s
#&gt; H    0     0                    9033.1980977 8413.44326  6.86%     -    0s
#&gt; 
#&gt; Explored 1 nodes (634 simplex iterations) in 0.12 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 2: 9033.2 9799.8 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 9.033198097709e+03, best bound 8.413443261592e+03, gap 6.8609%
#&gt; Optimize a model with 1845 rows, 1140 columns and 5100 nonzeros
#&gt; Variable types: 0 continuous, 1140 integer (1140 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [3e+01, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 1e+01]
#&gt; Found heuristic solution: objective 9299.8049463
#&gt; Presolve time: 0.03s
#&gt; Presolved: 1845 rows, 1140 columns, 5100 nonzeros
#&gt; Variable types: 0 continuous, 1140 integer (1140 binary)
#&gt; Presolved: 1845 rows, 1140 columns, 5100 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 4.937077e+03, 762 iterations, 0.05 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 4937.07701    0  985 9299.80495 4937.07701  46.9%     -    0s
#&gt; H    0     0                    8354.0923224 4937.07701  40.9%     -    0s
#&gt; H    0     0                    7234.0404060 4937.07701  31.8%     -    0s
#&gt;      0     0 4966.44630    0  802 7234.04041 4966.44630  31.3%     -    0s
#&gt;      0     0 5003.14122    0  974 7234.04041 5003.14122  30.8%     -    0s
#&gt;      0     0 5003.14122    0  609 7234.04041 5003.14122  30.8%     -    0s
#&gt;      0     0 5003.14122    0  439 7234.04041 5003.14122  30.8%     -    0s
#&gt; H    0     0                    7184.4512643 5003.14122  30.4%     -    0s
#&gt;      0     0 5030.18686    0  526 7184.45126 5030.18686  30.0%     -    0s
#&gt;      0     0 5034.35946    0  500 7184.45126 5034.35946  29.9%     -    0s
#&gt;      0     0 5035.42072    0  503 7184.45126 5035.42072  29.9%     -    0s
#&gt;      0     0 5055.07415    0  541 7184.45126 5055.07415  29.6%     -    0s
#&gt; H    0     0                    6921.7021091 5055.07415  27.0%     -    0s
#&gt; H    0     0                    6407.9147810 5055.07415  21.1%     -    1s
#&gt;      0     2 5055.18959    0  541 6407.91478 5055.18959  21.1%     -    1s
#&gt; H  245   178                    6200.1708344 5132.15136  17.2%  17.7    1s
#&gt; H  510   396                    6196.0679856 5160.93437  16.7%  19.0    1s
#&gt; H  517   380                    6135.6189882 5160.93437  15.9%  18.7    2s
#&gt; H  519   362                    6130.5366124 5160.93437  15.8%  18.7    2s
#&gt; H  530   351                    6007.3652219 5160.93437  14.1%  18.3    3s
#&gt; H  796   496                    5948.6443686 5211.24633  12.4%  27.1    4s
#&gt; H  848   502                    5944.3800423 5211.24633  12.3%  26.3    4s
#&gt;   1109   619 5437.23264   23  478 5944.38004 5216.13587  12.3%  28.8    5s
#&gt; H 1282   616                    5896.4957878 5231.24935  11.3%  31.2    5s
#&gt; H 1309   601                    5890.0945132 5231.24935  11.2%  31.1    5s
#&gt; H 1336   576                    5887.1741852 5233.88502  11.1%  31.0    5s
#&gt; H 1494   591                    5836.2907445 5239.90076  10.2%  30.4    5s
#&gt; 
#&gt; Cutting planes:
#&gt;   Gomory: 26
#&gt; 
#&gt; Explored 1735 nodes (52782 simplex iterations) in 6.53 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 10: 5836.29 5887.17 5890.09 ... 6196.07
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 5.836290744473e+03, best bound 5.252787985315e+03, gap 9.9978%
#&gt; Optimize a model with 3585 rows, 2010 columns and 8580 nonzeros
#&gt; Variable types: 0 continuous, 2010 integer (2010 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [5e+00, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 1e+01]
#&gt; Found heuristic solution: objective 9659.8049463
#&gt; Presolve time: 0.05s
#&gt; Presolved: 3585 rows, 2010 columns, 12060 nonzeros
#&gt; Variable types: 0 continuous, 2010 integer (2010 binary)
#&gt; Presolve removed 870 rows and 0 columns
#&gt; Presolved: 2715 rows, 2010 columns, 9450 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 8.395624e+03, 2848 iterations, 0.14 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 8395.62359    0  253 9659.80495 8395.62359  13.1%     -    0s
#&gt; H    0     0                    8663.6019600 8395.62359  3.09%     -    0s
#&gt; 
#&gt; Explored 1 nodes (3562 simplex iterations) in 0.24 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 2: 8663.6 9659.8 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 8.663601960014e+03, best bound 8.395623593690e+03, gap 3.0932%
#&gt; Optimize a model with 3585 rows, 2010 columns and 8580 nonzeros
#&gt; Variable types: 0 continuous, 2010 integer (2010 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [3e+01, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 1e+01]
#&gt; Found heuristic solution: objective 8459.8049463
#&gt; Presolve time: 0.05s
#&gt; Presolved: 3585 rows, 2010 columns, 12060 nonzeros
#&gt; Variable types: 0 continuous, 2010 integer (2010 binary)
#&gt; Presolve removed 870 rows and 0 columns
#&gt; Presolved: 2715 rows, 2010 columns, 9450 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 4.870284e+03, 3502 iterations, 0.25 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 4870.28355    0  705 8459.80495 4870.28355  42.4%     -    0s
#&gt; H    0     0                    6956.9384630 4870.28355  30.0%     -    0s
#&gt; H    0     0                    6145.1189919 4870.28355  20.7%     -    0s
#&gt;      0     0 4875.05121    0  802 6145.11899 4875.05121  20.7%     -    0s
#&gt;      0     0 4876.02325    0  791 6145.11899 4876.02325  20.7%     -    0s
#&gt;      0     0 4876.87370    0  798 6145.11899 4876.87370  20.6%     -    1s
#&gt;      0     0 4877.02012    0  870 6145.11899 4877.02012  20.6%     -    1s
#&gt;      0     0 4877.02012    0  866 6145.11899 4877.02012  20.6%     -    1s
#&gt; H    0     0                    5521.7207212 4877.02012  11.7%     -    1s
#&gt; H    0     0                    5412.2605192 4877.02012  9.89%     -    1s
#&gt; 
#&gt; Cutting planes:
#&gt;   Gomory: 4
#&gt; 
#&gt; Explored 1 nodes (5164 simplex iterations) in 1.67 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 5: 5412.26 5521.72 6145.12 ... 8459.8
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 5.412260519154e+03, best bound 4.877020120851e+03, gap 9.8894%
#&gt; Optimize a model with 5325 rows, 2880 columns and 12060 nonzeros
#&gt; Variable types: 0 continuous, 2880 integer (2880 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [5e-01, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 1e+01]
#&gt; Found heuristic solution: objective 9775.8049463
#&gt; Presolve time: 0.10s
#&gt; Presolved: 5325 rows, 2880 columns, 17280 nonzeros
#&gt; Variable types: 0 continuous, 2880 integer (2880 binary)
#&gt; Presolve removed 870 rows and 0 columns
#&gt; Presolved: 4455 rows, 2880 columns, 14670 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 8.401716e+03, 1895 iterations, 0.18 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 8401.71574    0  883 9775.80495 8401.71574  14.1%     -    0s
#&gt; H    0     0                    9148.3823544 8401.71574  8.16%     -    0s
#&gt; 
#&gt; Explored 1 nodes (2041 simplex iterations) in 0.60 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 2: 9148.38 9775.8 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 9.148382354355e+03, best bound 8.401715741535e+03, gap 8.1617%
#&gt; Optimize a model with 5325 rows, 2880 columns and 12060 nonzeros
#&gt; Variable types: 0 continuous, 2880 integer (2880 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [3e+00, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 1e+01]
#&gt; Found heuristic solution: objective 9155.8049463
#&gt; Presolve time: 0.10s
#&gt; Presolved: 5325 rows, 2880 columns, 17280 nonzeros
#&gt; Variable types: 0 continuous, 2880 integer (2880 binary)
#&gt; Presolve removed 870 rows and 0 columns
#&gt; Presolved: 4455 rows, 2880 columns, 14670 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 4.658154e+03, 1989 iterations, 0.20 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 4658.15359    0 1346 9155.80495 4658.15359  49.1%     -    0s
#&gt; H    0     0                    8554.6487387 4658.15359  45.5%     -    0s
#&gt; H    0     0                    7262.9837041 4658.15359  35.9%     -    0s
#&gt;      0     0 4681.01549    0 1361 7262.98370 4681.01549  35.5%     -    3s
#&gt;      0     0 4681.12383    0 1361 7262.98370 4681.12383  35.5%     -    3s
#&gt;      0     0 4697.26509    0 1625 7262.98370 4697.26509  35.3%     -    3s
#&gt;      0     0 4699.80403    0 1621 7262.98370 4699.80403  35.3%     -    3s
#&gt; H    0     0                    7119.8803319 4699.80403  34.0%     -    3s
#&gt;      0     0 4699.80403    0 1621 7119.88033 4699.80403  34.0%     -    3s
#&gt; H    0     0                    6461.0831333 4699.80403  27.3%     -    4s
#&gt; H    0     0                    6383.3891603 4699.80403  26.4%     -    4s
#&gt;      0     0 4926.78653    0  844 6383.38916 4926.78653  22.8%     -    4s
#&gt; H    0     0                    5998.3072593 4926.78653  17.9%     -    5s
#&gt;      0     0 4959.68353    0  882 5998.30726 4959.68353  17.3%     -    5s
#&gt;      0     0 4961.20175    0  896 5998.30726 4961.20175  17.3%     -    5s
#&gt;      0     0 4970.54866    0  868 5998.30726 4970.54866  17.1%     -    5s
#&gt;      0     0 4970.85579    0  926 5998.30726 4970.85579  17.1%     -    5s
#&gt;      0     0 4970.85579    0  926 5998.30726 4970.85579  17.1%     -    6s
#&gt;      0     2 4971.03988    0  926 5998.30726 4971.03988  17.1%     -    6s
#&gt; H   42    42                    5976.5255283 5025.18377  15.9%   186    7s
#&gt;    287   263 5093.09757    4  873 5976.52553 5061.40052  15.3%  91.5   10s
#&gt;    516   468 5943.08092  126  870 5976.52553 5063.48792  15.3%  90.5   15s
#&gt;    808   568 5367.44683   28  715 5976.52553 5069.06275  15.2%  88.9   20s
#&gt; H  918   564                    5927.2412779 5090.97791  14.1%  94.4   21s
#&gt; H 1109   509                    5805.0963020 5103.89146  12.1%  95.1   25s
#&gt;   1395   638     cutoff   51      5805.09630 5175.34950  10.8%   103   30s
#&gt; H 1570   676                    5791.8368633 5198.65283  10.2%   107   32s
#&gt;   1751   761 5494.11639   31  561 5791.83686 5208.41203  10.1%   107   35s
#&gt; 
#&gt; Cutting planes:
#&gt;   Gomory: 9
#&gt; 
#&gt; Explored 1843 nodes (202915 simplex iterations) in 36.23 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 10: 5791.84 5805.1 5927.24 ... 8554.65
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 5.791836863326e+03, best bound 5.220686353289e+03, gap 9.8613%
#&gt; Optimize a model with 5325 rows, 2880 columns and 12060 nonzeros
#&gt; Variable types: 0 continuous, 2880 integer (2880 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [5e-01, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 1e+01]
#&gt; Found heuristic solution: objective 9784.8049463
#&gt; Presolve time: 0.10s
#&gt; Presolved: 5325 rows, 2880 columns, 17280 nonzeros
#&gt; Variable types: 0 continuous, 2880 integer (2880 binary)
#&gt; Presolve removed 870 rows and 0 columns
#&gt; Presolved: 4455 rows, 2880 columns, 14670 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 8.626287e+03, 3714 iterations, 0.26 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 8626.28729    0  853 9784.80495 8626.28729  11.8%     -    0s
#&gt; H    0     0                    9392.7146037 8626.28729  8.16%     -    0s
#&gt; 
#&gt; Explored 1 nodes (4170 simplex iterations) in 0.52 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 2: 9392.71 9784.8 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 9.392714603732e+03, best bound 8.626287285183e+03, gap 8.1598%
#&gt; Optimize a model with 5325 rows, 2880 columns and 12060 nonzeros
#&gt; Variable types: 0 continuous, 2880 integer (2880 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [3e+00, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 1e+01]
#&gt; Found heuristic solution: objective 9209.8049463
#&gt; Presolve time: 0.10s
#&gt; Presolved: 5325 rows, 2880 columns, 17280 nonzeros
#&gt; Variable types: 0 continuous, 2880 integer (2880 binary)
#&gt; Presolve removed 870 rows and 0 columns
#&gt; Presolved: 4455 rows, 2880 columns, 14670 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 6.074932e+03, 3609 iterations, 0.32 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 6074.93210    0 1281 9209.80495 6074.93210  34.0%     -    0s
#&gt; H    0     0                    8231.7228744 6074.93210  26.2%     -    0s
#&gt; H    0     0                    7970.8871898 6074.93210  23.8%     -    0s
#&gt;      0     0 6083.75675    0 1270 7970.88719 6083.75675  23.7%     -    0s
#&gt;      0     0 6084.06171    0 1269 7970.88719 6084.06171  23.7%     -    0s
#&gt;      0     0 6086.32274    0 1266 7970.88719 6086.32274  23.6%     -    3s
#&gt; H    0     0                    7962.3531057 6086.32274  23.6%     -    3s
#&gt;      0     0 6090.46687    0 1267 7962.35311 6090.46687  23.5%     -    3s
#&gt;      0     0 6090.51166    0 1266 7962.35311 6090.51166  23.5%     -    3s
#&gt;      0     0 6123.37876    0 1286 7962.35311 6123.37876  23.1%     -    3s
#&gt;      0     0 6128.50440    0 1254 7962.35311 6128.50440  23.0%     -    3s
#&gt; H    0     0                    7898.6513266 6128.50440  22.4%     -    4s
#&gt;      0     0 6143.25763    0 1612 7898.65133 6143.25763  22.2%     -    4s
#&gt;      0     0 6143.90253    0 1606 7898.65133 6143.90253  22.2%     -    4s
#&gt;      0     0 6143.91937    0 1615 7898.65133 6143.91937  22.2%     -    4s
#&gt;      0     0 6144.05984    0 1599 7898.65133 6144.05984  22.2%     -    4s
#&gt;      0     0 6144.08832    0 1618 7898.65133 6144.08832  22.2%     -    4s
#&gt;      0     0 6149.37652    0 1608 7898.65133 6149.37652  22.1%     -    4s
#&gt;      0     0 6149.82483    0 1609 7898.65133 6149.82483  22.1%     -    4s
#&gt;      0     0 6149.82483    0 1610 7898.65133 6149.82483  22.1%     -    4s
#&gt;      0     0 6151.58214    0 1604 7898.65133 6151.58214  22.1%     -    5s
#&gt;      0     0 6151.58214    0 1603 7898.65133 6151.58214  22.1%     -    5s
#&gt;      0     0 6154.18689    0 1597 7898.65133 6154.18689  22.1%     -    5s
#&gt;      0     0 6154.18689    0 1599 7898.65133 6154.18689  22.1%     -    5s
#&gt;      0     0 6158.01583    0 1583 7898.65133 6158.01583  22.0%     -    5s
#&gt;      0     0 6160.36713    0 1623 7898.65133 6160.36713  22.0%     -    5s
#&gt;      0     0 6160.43461    0 1604 7898.65133 6160.43461  22.0%     -    5s
#&gt;      0     0 6160.43461    0 1605 7898.65133 6160.43461  22.0%     -    5s
#&gt;      0     0 6162.42527    0 1585 7898.65133 6162.42527  22.0%     -    6s
#&gt;      0     0 6162.42527    0 1585 7898.65133 6162.42527  22.0%     -    6s
#&gt;      0     0 6166.46706    0 1270 7898.65133 6166.46706  21.9%     -    6s
#&gt;      0     0 6166.46795    0 1279 7898.65133 6166.46795  21.9%     -    6s
#&gt;      0     0 6166.98168    0 1276 7898.65133 6166.98168  21.9%     -    6s
#&gt;      0     0 6168.72761    0 1584 7898.65133 6168.72761  21.9%     -    6s
#&gt;      0     0 6168.77870    0 1593 7898.65133 6168.77870  21.9%     -    6s
#&gt;      0     0 6168.77870    0 1595 7898.65133 6168.77870  21.9%     -    6s
#&gt;      0     0 6168.77870    0 1591 7898.65133 6168.77870  21.9%     -    6s
#&gt;      0     0 6168.77870    0 1595 7898.65133 6168.77870  21.9%     -    6s
#&gt;      0     0 6168.77870    0 1584 7898.65133 6168.77870  21.9%     -    7s
#&gt;      0     0 6168.77870    0 1584 7898.65133 6168.77870  21.9%     -    7s
#&gt; H    0     0                    7778.7480166 6168.77870  20.7%     -    8s
#&gt; H    0     0                    7778.7470615 6168.77870  20.7%     -    8s
#&gt;      0     0 6220.92539    0  884 7778.74706 6220.92539  20.0%     -    8s
#&gt; H    0     0                    7775.8267334 6220.92539  20.0%     -    8s
#&gt;      0     0 6310.39469    0  881 7775.82673 6310.39469  18.8%     -   10s
#&gt; H    0     0                    7705.6975527 6310.39469  18.1%     -   10s
#&gt;      0     0 6310.58812    0  882 7705.69755 6310.58812  18.1%     -   10s
#&gt;      0     0 6313.15982    0  881 7705.69755 6313.15982  18.1%     -   10s
#&gt;      0     0 6316.92535    0  879 7705.69755 6316.92535  18.0%     -   10s
#&gt;      0     0 6317.22573    0  879 7705.69755 6317.22573  18.0%     -   10s
#&gt;      0     0 6317.35603    0  872 7705.69755 6317.35603  18.0%     -   10s
#&gt;      0     0 6317.35603    0  873 7705.69755 6317.35603  18.0%     -   10s
#&gt;      0     0 6326.02950    0  855 7705.69755 6326.02950  17.9%     -   11s
#&gt;      0     0 6329.80641    0 1080 7705.69755 6329.80641  17.9%     -   11s
#&gt;      0     0 6331.67072    0 1072 7705.69755 6331.67072  17.8%     -   11s
#&gt;      0     0 6331.70881    0 1073 7705.69755 6331.70881  17.8%     -   11s
#&gt;      0     0 6331.70881    0 1073 7705.69755 6331.70881  17.8%     -   11s
#&gt;      0     0 6331.70881    0 1072 7705.69755 6331.70881  17.8%     -   11s
#&gt; H    0     0                    7551.8879086 6331.70881  16.2%     -   14s
#&gt;      0     2 6331.72330    0 1071 7551.88791 6331.72330  16.2%     -   15s
#&gt;    363   344 6594.86221   13  652 7551.88791 6347.65165  15.9%   109   20s
#&gt; H  510   482                    7533.1848271 6347.65165  15.7%   109   22s
#&gt; 
#&gt; Explored 512 nodes (72707 simplex iterations) in 23.54 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 10: 7533.18 7551.89 7705.7 ... 8231.72
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 7.533184827132e+03, best bound 7.249672203786e+03, gap 3.7635%
#&gt; Optimize a model with 6485 rows, 2880 columns and 15540 nonzeros
#&gt; Variable types: 0 continuous, 2880 integer (2880 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [2e+00, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 1e+01]
#&gt; Found heuristic solution: objective 9698.8763888
#&gt; Presolve time: 0.12s
#&gt; Presolved: 6485 rows, 2880 columns, 21920 nonzeros
#&gt; Variable types: 0 continuous, 2880 integer (2880 binary)
#&gt; Presolve removed 870 rows and 0 columns
#&gt; Presolved: 5615 rows, 2880 columns, 19310 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 8.237402e+03, 1613 iterations, 0.20 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 8237.40219    0  996 9698.87639 8237.40219  15.1%     -    0s
#&gt; H    0     0                    9321.1392189 8237.40219  11.6%     -    0s
#&gt;      0     0 8244.48257    0 1000 9321.13922 8244.48257  11.6%     -    0s
#&gt;      0     0 8250.85165    0  993 9321.13922 8250.85165  11.5%     -    0s
#&gt;      0     0 8251.00241    0 1006 9321.13922 8251.00241  11.5%     -    0s
#&gt;      0     0 8254.04753    0 1003 9321.13922 8254.04753  11.4%     -    0s
#&gt;      0     0 8256.86535    0 1001 9321.13922 8256.86535  11.4%     -    1s
#&gt;      0     0 8260.45995    0  986 9321.13922 8260.45995  11.4%     -    1s
#&gt;      0     0 8260.51279    0  998 9321.13922 8260.51279  11.4%     -    1s
#&gt;      0     0 8262.36173    0 1004 9321.13922 8262.36173  11.4%     -    1s
#&gt;      0     0 8263.87473    0  984 9321.13922 8263.87473  11.3%     -    1s
#&gt;      0     0 8266.01955    0  995 9321.13922 8266.01955  11.3%     -    1s
#&gt;      0     0 8267.19482    0  966 9321.13922 8267.19482  11.3%     -    1s
#&gt;      0     0 8268.88650    0  960 9321.13922 8268.88650  11.3%     -    1s
#&gt;      0     0 8272.04701    0  990 9321.13922 8272.04701  11.3%     -    1s
#&gt; H    0     0                    9229.9768717 8272.04701  10.4%     -    1s
#&gt;      0     0 8274.36390    0  981 9229.97687 8274.36390  10.4%     -    1s
#&gt;      0     0 8275.44621    0  970 9229.97687 8275.44621  10.3%     -    2s
#&gt;      0     0 8277.17927    0  988 9229.97687 8277.17927  10.3%     -    2s
#&gt;      0     0 8277.74838    0  975 9229.97687 8277.74838  10.3%     -    2s
#&gt;      0     0 8277.74838    0  976 9229.97687 8277.74838  10.3%     -    2s
#&gt;      0     0 8278.54093    0  982 9229.97687 8278.54093  10.3%     -    2s
#&gt;      0     0 8278.69145    0  961 9229.97687 8278.69145  10.3%     -    2s
#&gt;      0     0 8279.88179    0  986 9229.97687 8279.88179  10.3%     -    2s
#&gt;      0     0 8280.38236    0  985 9229.97687 8280.38236  10.3%     -    2s
#&gt;      0     0 8280.39552    0  986 9229.97687 8280.39552  10.3%     -    2s
#&gt;      0     0 8281.35878    0  995 9229.97687 8281.35878  10.3%     -    2s
#&gt;      0     0 8282.18069    0 1077 9229.97687 8282.18069  10.3%     -    2s
#&gt;      0     0 8283.43985    0 1095 9229.97687 8283.43985  10.3%     -    2s
#&gt;      0     0 8284.33513    0 1079 9229.97687 8284.33513  10.2%     -    2s
#&gt;      0     0 8284.44501    0 1079 9229.97687 8284.44501  10.2%     -    2s
#&gt; H    0     0                    9181.7950791 8284.44501  9.77%     -    3s
#&gt; 
#&gt; Cutting planes:
#&gt;   Gomory: 2
#&gt;   Zero half: 65
#&gt; 
#&gt; Explored 1 nodes (3166 simplex iterations) in 3.22 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 4: 9181.8 9229.98 9321.14 9698.88 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 9.181795079076e+03, best bound 8.284445010911e+03, gap 9.7731%
#&gt; Optimize a model with 6485 rows, 2880 columns and 15540 nonzeros
#&gt; Variable types: 0 continuous, 2880 integer (2880 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [2e+01, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 1e+01]
#&gt; Found heuristic solution: objective 8523.8763888
#&gt; Presolve time: 0.12s
#&gt; Presolved: 6485 rows, 2880 columns, 21920 nonzeros
#&gt; Variable types: 0 continuous, 2880 integer (2880 binary)
#&gt; Presolve removed 870 rows and 0 columns
#&gt; Presolved: 5615 rows, 2880 columns, 19310 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 3.507020e+03, 1152 iterations, 0.12 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 3507.02005    0 1658 8523.87639 3507.02005  58.9%     -    0s
#&gt; H    0     0                    6898.6184554 3507.02005  49.2%     -    0s
#&gt; H    0     0                    6747.6041274 3507.02005  48.0%     -    0s
#&gt;      0     0 3539.90686    0 1636 6747.60413 3539.90686  47.5%     -    1s
#&gt; H    0     0                    6682.8082128 3539.90686  47.0%     -    1s
#&gt;      0     0 3568.65145    0 1579 6682.80821 3568.65145  46.6%     -    1s
#&gt;      0     0 3570.69423    0 1595 6682.80821 3570.69423  46.6%     -    1s
#&gt;      0     0 3594.97810    0 1584 6682.80821 3594.97810  46.2%     -    1s
#&gt;      0     0 3594.97810    0 1584 6682.80821 3594.97810  46.2%     -    1s
#&gt;      0     0 4708.53205    0 1002 6682.80821 4708.53205  29.5%     -    2s
#&gt; H    0     0                    6340.8033491 4708.53205  25.7%     -    3s
#&gt;      0     0 4732.91855    0  994 6340.80335 4732.91855  25.4%     -    3s
#&gt;      0     0 4746.66717    0  992 6340.80335 4746.66717  25.1%     -    3s
#&gt;      0     0 4759.70484    0  988 6340.80335 4759.70484  24.9%     -    3s
#&gt;      0     0 4765.55074    0  990 6340.80335 4765.55074  24.8%     -    3s
#&gt;      0     0 4765.73432    0  990 6340.80335 4765.73432  24.8%     -    3s
#&gt;      0     0 4780.36661    0  993 6340.80335 4780.36661  24.6%     -    3s
#&gt;      0     0 4780.36823    0  991 6340.80335 4780.36823  24.6%     -    3s
#&gt;      0     0 4780.36823    0  980 6340.80335 4780.36823  24.6%     -    4s
#&gt;      0     0 4780.36823    0  981 6340.80335 4780.36823  24.6%     -    4s
#&gt;      0     0 4780.36823    0  984 6340.80335 4780.36823  24.6%     -    4s
#&gt;      0     2 4780.37110    0  984 6340.80335 4780.37110  24.6%     -    4s
#&gt;      1     3 4865.36167    1  880 6340.80335 4780.73511  24.6%   794    5s
#&gt; H   65    65                    6214.0528232 4865.71414  21.7%   275    7s
#&gt;    294   284 5045.58331    7  999 6214.05282 4865.75051  21.7%   121   10s
#&gt; H  388   372                    6171.1053200 4865.75051  21.2%   113   11s
#&gt; H  512   457                    5930.3367577 4937.07701  16.7%   102   15s
#&gt; H  525   442                    5900.5135039 5052.90081  14.4%  99.3   18s
#&gt;    536   452 5188.92253   13  734 5900.51350 5067.84579  14.1%   105   20s
#&gt; H  557   441                    5899.5023485 5067.84579  14.1%   110   20s
#&gt; H  584   438                    5879.8686851 5067.84579  13.8%   112   21s
#&gt; H  665   457                    5869.9262213 5083.00690  13.4%   119   24s
#&gt;    684   471 5677.79254   43  737 5869.92622 5083.00690  13.4%   121   25s
#&gt;    941   604 5763.16566   45  422 5869.92622 5184.54970  11.7%   124   30s
#&gt;   1197   700 5496.24187   19  484 5869.92622 5206.70242  11.3%   117   35s
#&gt;   1541   859 5662.39095   34  616 5869.92622 5214.79481  11.2%   112   40s
#&gt;   1984  1138 5842.73156   44  341 5869.92622 5244.80022  10.6%   102   45s
#&gt;   2394  1413 5747.94218   25  649 5869.92622 5273.10524  10.2%  95.2   50s
#&gt; 
#&gt; Cutting planes:
#&gt;   Gomory: 13
#&gt; 
#&gt; Explored 2868 nodes (257284 simplex iterations) in 53.76 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 10: 5869.93 5879.87 5899.5 ... 6747.6
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 5.869926221286e+03, best bound 5.286479069434e+03, gap 9.9396%</div><div class='input'><span class='no'>s4</span> <span class='kw'>&lt;-</span> <span class='fu'>lapply</span>(<span class='no'>s4</span>, <span class='no'>category_layer</span>)
<span class='no'>s4</span> <span class='kw'>&lt;-</span> <span class='fu'>stack</span>(<span class='no'>s4</span>)

<span class='co'># plot solutions</span>
<span class='fu'>plot</span>(<span class='no'>s4</span>, <span class='kw'>main</span> <span class='kw'>=</span> <span class='fu'>names</span>(<span class='no'>p4</span>), <span class='kw'>axes</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>box</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='img'><img src='add_connectivity_penalties-7.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># create an array to manually specify the connectivities between</span>
<span class='co'># each planning unit when they are allocated to each different zone</span>
<span class='co'># for real-world problems, these connectivities would be generated using</span>
<span class='co'># data - but here these connectivity values are assigned as random</span>
<span class='co'># ones or zeros</span>
<span class='no'>c_array</span> <span class='kw'>&lt;-</span> <span class='fu'>array</span>(<span class='fl'>0</span>, <span class='fu'>c</span>(<span class='fu'>rep</span>(<span class='fu'><a href='OptimizationProblem-methods.html'>ncell</a></span>(<span class='no'>sim_pu_zones_stack</span><span class='kw'>[[</span><span class='fl'>1</span>]]), <span class='fl'>2</span>), <span class='fl'>3</span>, <span class='fl'>3</span>))
<span class='kw'>for</span> (<span class='no'>z1</span> <span class='kw'>in</span> <span class='fu'>seq_len</span>(<span class='fl'>3</span>))
  <span class='kw'>for</span> (<span class='no'>z2</span> <span class='kw'>in</span> <span class='fu'>seq_len</span>(<span class='fl'>3</span>))
    <span class='no'>c_array</span>[, , <span class='no'>z1</span>, <span class='no'>z2</span>] <span class='kw'>&lt;-</span> <span class='fu'>round</span>(<span class='fu'>runif</span>(<span class='fu'><a href='OptimizationProblem-methods.html'>ncell</a></span>(<span class='no'>sim_pu_zones_stack</span><span class='kw'>[[</span><span class='fl'>1</span>]]) ^ <span class='fl'>2</span>,
                                       <span class='fl'>0</span>, <span class='fl'>0.505</span>))

<span class='co'># create a problem with the manually specified connectivity array</span>
<span class='co'># note that the zones argument is set to NULL because the connectivity</span>
<span class='co'># data is an array</span>
<span class='no'>p5</span> <span class='kw'>&lt;-</span> <span class='fu'>list</span>(<span class='no'>p3</span>,
           <span class='no'>p3</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='fl'>30</span>, <span class='kw'>zones</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>c_array</span>))


<span class='co'># assign names to the problems</span>
<span class='fu'>names</span>(<span class='no'>p5</span>) <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='st'>"basic problem"</span>, <span class='st'>"connectivity array"</span>)</div><div class='input'><span class='co'># solve problems</span>
<span class='no'>s5</span> <span class='kw'>&lt;-</span> <span class='fu'>lapply</span>(<span class='no'>p5</span>, <span class='no'>solve</span>)</div><div class='output co'>#&gt; Optimize a model with 105 rows, 270 columns and 1620 nonzeros
#&gt; Variable types: 0 continuous, 270 integer (270 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [2e+02, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 1e+01]
#&gt; Found heuristic solution: objective 9899.8049463
#&gt; Presolve time: 0.00s
#&gt; Presolved: 105 rows, 270 columns, 1620 nonzeros
#&gt; Variable types: 0 continuous, 270 integer (270 binary)
#&gt; Presolved: 105 rows, 270 columns, 1620 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 8.982643e+03, 108 iterations, 0.00 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 8982.64287    0   12 9899.80495 8982.64287  9.26%     -    0s
#&gt; 
#&gt; Explored 1 nodes (108 simplex iterations) in 0.01 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 1: 9899.8 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 9.899804946308e+03, best bound 8.982642866145e+03, gap 9.2644%
#&gt; Optimize a model with 1479 rows, 957 columns and 4368 nonzeros
#&gt; Variable types: 0 continuous, 957 integer (957 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [3e+01, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 1e+01]
#&gt; Found heuristic solution: objective 9389.8049463
#&gt; Presolve time: 0.02s
#&gt; Presolved: 1479 rows, 957 columns, 4416 nonzeros
#&gt; Variable types: 0 continuous, 957 integer (957 binary)
#&gt; Presolve removed 24 rows and 0 columns
#&gt; Presolved: 1455 rows, 957 columns, 4344 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 5.802594e+03, 1002 iterations, 0.05 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 5802.59389    0  745 9389.80495 5802.59389  38.2%     -    0s
#&gt; H    0     0                    8901.9639651 5802.59389  34.8%     -    0s
#&gt; H    0     0                    8597.4854742 5802.59389  32.5%     -    0s
#&gt;      0     0 5821.54740    0  711 8597.48547 5821.54740  32.3%     -    1s
#&gt;      0     0 5838.20575    0  788 8597.48547 5838.20575  32.1%     -    1s
#&gt;      0     0 5838.32696    0  789 8597.48547 5838.32696  32.1%     -    1s
#&gt;      0     0 5838.32696    0  788 8597.48547 5838.32696  32.1%     -    1s
#&gt; H    0     0                    7588.6711019 5838.32696  23.1%     -    1s
#&gt;      0     2 5838.78266    0  787 7588.67110 5838.78266  23.1%     -    1s
#&gt; H   54    54                    7441.6362056 5839.06761  21.5%  97.8    2s
#&gt; H   81    81                    7347.1602739 5839.06761  20.5%  85.7    2s
#&gt; H  135   127                    7274.7184959 5848.94323  19.6%  72.3    2s
#&gt; H  379   346                    7250.6177795 5897.94005  18.7%  64.8    3s
#&gt; H  517   449                    7189.7866401 5927.57629  17.6%  58.5    5s
#&gt; H  903   661                    7186.7731108 5927.57629  17.5%  91.6    9s
#&gt;    997   716 6673.71442   37  512 7186.77311 5927.57629  17.5%  97.2   10s
#&gt; H 1038   720                    7181.4317505 5927.57629  17.5%  97.6   10s
#&gt; H 1200   793                    7179.2532384 6000.84843  16.4%   103   12s
#&gt; H 1366   839                    7153.1012654 6000.91546  16.1%   106   13s
#&gt;   1591   953 6395.16449   25  621 7153.10127 6007.41339  16.0%   101   15s
#&gt;   2480  1701 6352.71875   23  561 7153.10127 6051.21930  15.4%  93.2   20s
#&gt; H 2648  1783                    7124.3385154 6051.75951  15.1%  93.6   21s
#&gt; H 2924  1935                    7113.7141150 6061.80554  14.8%  88.8   22s
#&gt; H 3276  2207                    7104.7072746 6064.20155  14.6%  88.5   24s
#&gt;   3285  2218 6406.95141   26  613 7104.70727 6064.20155  14.6%  88.7   25s
#&gt; H 3700  2543                    7099.8428797 6084.10938  14.3%  87.7   27s
#&gt;   3994  2778 6219.65443   17  634 7099.84288 6091.77652  14.2%  89.6   30s
#&gt;   4589  3273 6465.33497   24  623 7099.84288 6097.01795  14.1%  91.3   35s
#&gt; H 4693  2694                    6991.9453808 6097.01795  12.8%  91.6   35s
#&gt;   5151  3031 6253.89650   14  607 6991.94538 6113.10237  12.6%  92.6   40s
#&gt; H 5686  2710                    6897.5378148 6116.61756  11.3%  92.9   43s
#&gt;   5829  2818 6347.35536   23  658 6897.53781 6119.00814  11.3%  93.5   45s
#&gt;   6475  3308 6686.29358   30  527 6897.53781 6133.34890  11.1%  94.2   50s
#&gt;   7016  3730     cutoff   45      6897.53781 6142.88880  10.9%  96.1   55s
#&gt; 
#&gt; Cutting planes:
#&gt;   Gomory: 1
#&gt;   Zero half: 17
#&gt; 
#&gt; Explored 7524 nodes (735499 simplex iterations) in 60.00 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 10: 6897.54 6991.95 7099.84 ... 7186.77
#&gt; 
#&gt; Time limit reached
#&gt; Best objective 6.897537814825e+03, best bound 6.154562192289e+03, gap 10.7716%</div><div class='input'><span class='no'>s5</span> <span class='kw'>&lt;-</span> <span class='fu'>lapply</span>(<span class='no'>s5</span>, <span class='no'>category_layer</span>)
<span class='no'>s5</span> <span class='kw'>&lt;-</span> <span class='fu'>stack</span>(<span class='no'>s5</span>)

<span class='co'># plot solutions</span>
<span class='fu'>plot</span>(<span class='no'>s5</span>, <span class='kw'>main</span> <span class='kw'>=</span> <span class='fu'>names</span>(<span class='no'>p5</span>), <span class='kw'>axes</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>box</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='img'><img src='add_connectivity_penalties-8.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by <a href='http://jeffrey-hanson.com'>Jeffrey O Hanson</a>, <a href='http://www.richard-schuster.com/'>Richard Schuster</a>, Nina Morrell, <a href='http://strimas.com'>Matthew Strimas-Mackey</a>, Matthew E Watts, <a href='http://arcese.forestry.ubc.ca'>Peter Arcese</a>, <a href='https://josephrbennett.wordpress.com/'>Joeseph Bennett</a>, Hugh P Possingham.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

