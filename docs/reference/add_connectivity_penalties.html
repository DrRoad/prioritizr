<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Add connectivity penalties — add_connectivity_penalties • prioritizr</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>


<!-- docsearch -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />
<link href="../docsearch.css" rel="stylesheet">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
<meta property="og:title" content="Add connectivity penalties — add_connectivity_penalties" />

<meta property="og:description" content="Add penalties to a conservation planning problem to favor
solutions that select planning units with high connectivity between them." />
<meta name="twitter:card" content="summary" />


<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-70466840-4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-70466840-4');
</script>



<!-- docsearch -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />

  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">prioritizr</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">4.0.0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/prioritizr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/gurobi_installation.html">Gurobi Installation Guide</a>
    </li>
    <li>
      <a href="../articles/publication_record.html">Publication Record</a>
    </li>
    <li>
      <a href="../articles/saltspring.html">Salt Spring Island Tutorial</a>
    </li>
    <li>
      <a href="../articles/tasmania.html">Tasmania Tutorial</a>
    </li>
    <li>
      <a href="../articles/zones.html">Management Zones</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/prioritizr/prioritizr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
      <form class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="search" class="form-control" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
        </div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Add connectivity penalties</h1>
    <small class="dont-index">Source: <a href='https://github.com/prioritizr/prioritizr/blob/master/R/add_connectivity_penalties.R'><code>R/add_connectivity_penalties.R</code></a></small>
    <div class="hidden name"><code>add_connectivity_penalties.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Add penalties to a conservation planning <code>problem</code> to favor
solutions that select planning units with high connectivity between them.</p>
    
    </div>

    <pre class="usage"><span class='co'># S4 method for ConservationProblem,ANY,ANY,Matrix</span>
<span class='fu'>add_connectivity_penalties</span>(<span class='no'>x</span>, <span class='no'>penalty</span>, <span class='no'>zones</span>, <span class='no'>data</span>)

<span class='co'># S4 method for ConservationProblem,ANY,ANY,matrix</span>
<span class='fu'>add_connectivity_penalties</span>(<span class='no'>x</span>, <span class='no'>penalty</span>, <span class='no'>zones</span>, <span class='no'>data</span>)

<span class='co'># S4 method for ConservationProblem,ANY,ANY,data.frame</span>
<span class='fu'>add_connectivity_penalties</span>(<span class='no'>x</span>, <span class='no'>penalty</span>, <span class='no'>zones</span>, <span class='no'>data</span>)

<span class='co'># S4 method for ConservationProblem,ANY,ANY,array</span>
<span class='fu'>add_connectivity_penalties</span>(<span class='no'>x</span>, <span class='no'>penalty</span>, <span class='no'>zones</span>, <span class='no'>data</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p><code><a href='ConservationProblem-class.html'>ConservationProblem-class</a></code> object.</p></td>
    </tr>
    <tr>
      <th>penalty</th>
      <td><p><code>numeric</code> penalty that is used to scale the importance
of selecting planning units with strong connectivity between them compared
to the main problem objective (e.g. solution cost when the argument to
<code>x</code> has a minimum set objective set using
<code>add_min_set_objective</code>). Higher <code>penalty</code> values
can be used to obtain solutions with a high degree of connectivity,
and smaller <code>penalty</code> values can be used to obtain solutions with a #'   small degree of connectivity. Note that negative <code>penalty</code> values can
be used to obtain solutions that have very little connectivity.</p></td>
    </tr>
    <tr>
      <th>zones</th>
      <td><p><code>matrix</code> or <code>Matrix</code> object describing the
level of connectivity between different zones. Each row and column
corresponds to a different zone in the argument to <code>x</code>, and cell
values indicate the level of connectivity between each combination
of zones. Cell values along the diagonal of the matrix represent
the level of connectivity between planning units allocated to the
same zone. Cell values must lay between 1 and -1, where negative
values favor solutions with weak connectivity. The default argument to
<code>zones</code> is an identity matrix (i.e. a matrix with ones along the
matrix diagonal and zeros elsewhere), so that planning units are
only considered to be connected when they are allocated to the same zone.
This argument is required when the argument to <code>data</code> is a
<code>matrix</code> or <code>Matrix</code> object. If the argument to <code>data</code> is
an <code>array</code> or <code>data.frame</code> with zone data, this argument
must explicitly be set to <code>NULL</code> otherwise an error will be thrown.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p><code>matrix</code>, <code>Matrix</code>, <code>data.frame</code>, or
<code>array</code> object containing connectivity data. The connectivity values
correspond to the strength of connectivity between
different planning units. Thus connections between planning units
that are associated with higher values are more favorable in the solution.
See the Details section for more information.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>not used.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code><a href='ConservationProblem-class.html'>ConservationProblem-class</a></code> object with the penalties
 added to it.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function uses connectivity data to penalize solutions
  that have low connectivity. It can accommodate symmetric and asymmetric
  relationships between planning units. Although <em>Marxan</em>
  <strong>penalizes</strong> connections between planning units with high
  connectivity values, it is important to note that this function
  <strong>favors</strong> connections between planning units with high connectivity
  values. This function was inspired by Beger <em>et al.</em> (2010).</p>
<p>The argument to <code>data</code> can be specified in several different ways:</p>
<p></p><dl class='dl-horizontal'>
    <dt><code>matrix</code>, <code>Matrix</code></dt><dd><p>where rows and columns represent
    different planning units and the value of each cell represents the
    strength of connectivity between two different planning units. Cells
    that occur along the matrix diagonal are treated as weights which
    indicate that planning units are more desirable in the solution.
    The argument to <code>zones</code> can be used to control
    the strength of connectivity between planning units in different zones.
    The default argument for <code>zones</code> is to treat planning units
    allocated to different zones as having zero connectivity.</p></dd>
    <dt><code>data.frame</code></dt><dd><p>containing the fields (columns)
    <code>"id1"</code>, <code>"id2"</code>, and <code>"boundary"</code>. Here, each row
    denotes the connectivity between two planning units following the
    <em>Marxan</em> format. The data can be used to denote symmetric or
    asymmetric relationships between planning units. By default,
    input data is assumed to be symmetric unless asymmetric data is
    also included (e.g. if data is present for planning units 2 and 3, then
    the same amount of connectivity is expected for planning units 3 and 2,
    unless connectivity data is also provided for planning units 3 and 2).
    If the argument to <code>x</code> contains multiple zones, then the columns
    <code>"zone1"</code> and <code>"zone2"</code> can optionally be provided to manually
    specify the connectivity values between planning units when they are
    allocated to specific zones. If the columns <code>"zone1"</code> and
    <code>"zone2"</code> are present, then the argument to <code>zones</code> must be
    <code>NULL</code>.</p></dd>
    <dt><code>array</code></dt><dd><p>containing four-dimensions where cell values
    indicate the strength of connectivity between planning units
    when they are assigned to specific management zones. The first two
    dimensions (i.e. rows and columns) indicate the strength of
    connectivity between different planning units and the second two
    dimensions indicate the different management zones. Thus
    the <code>data[1, 2, 3, 4]</code> indicates the strength of
    connectivity between planning unit 1 and planning unit 2 when planning
    unit 1 is assigned to zone 3 and planning unit 2 is assigned to zone 4.</p></dd>
    </dl>
    <p>The connectivity penalties are calculated using the following equations.
 Let \(I\) represent the set of planning units, \(Z\) represent the set
 of management zones, and $$X_iz$$ represent the decision
 variable for planning unit \(i\) for in zone \(z\) (e.g. with binary
 values one indicating if planning unit is allocated or not). Also, let
 \(p\) represent the argument to <code>penalty</code>, \(D\) represent the
 argument to <code>data</code>, and \(W\) represent the argument to <code>zones</code>.</p>
<p>If the argument to <code>data</code> is supplied
 as a <code>matrix</code> or <code>Matrix</code>, then the penalties are calculated as:</p>
<p>$$
 \sum_{i}^{I} \sum_{j}^{I} \sum_{z}^{Z} \sum_{y}^{Z} (-p \times X_{iz}
 \times X_{jy} \times D_{ij} \times W_{zy})$$</p>
<p>Otherwise, if the argument to <code>data</code> is supplied as a
 <code>data.frame</code> or <code>array</code>, then the penalties are calculated as:</p>
<p>$$
 \sum_{i}^{I} \sum_{j}^{I} \sum_{z}^{Z} \sum_{y}^{Z} (-p \times X_{iz}
 \times X_{jy} \times D_{ijzy})$$</p>
<p>Note that when the problem objective is to maximize some measure of
 benefit and not minimize some measure of cost, the term \(-p\) is
 replaced with \(p\).</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Beger M, Linke S, Watts M, Game E, Treml E, Ball I, and Possingham, HP (2010)
Incorporating asymmetric connectivity into spatial decision making for
conservation, <em>Conservation Letters</em>, 3: 359--368.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='penalties.html'>penalties</a></code>.</p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># load Matrix package for visualizing matrices</span>
<span class='fu'>require</span>(<span class='no'>Matrix</span>)</div><div class='output co'>#&gt; <span class='message'>Loading required package: Matrix</span></div><div class='input'>
<span class='co'># load data</span>
<span class='fu'>data</span>(<span class='no'>sim_pu_polygons</span>, <span class='no'>sim_pu_zones_stack</span>, <span class='no'>sim_features</span>, <span class='no'>sim_features_zones</span>)

<span class='co'># define function to rescale values between zero and one so that we</span>
<span class='co'># can compare solutions from different connectivity matrices</span>
<span class='no'>rescale</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>x</span>, <span class='no'>to</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>1</span>), <span class='no'>from</span> <span class='kw'>=</span> <span class='fu'>range</span>(<span class='no'>x</span>, <span class='kw'>na.rm</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)) {
  (<span class='no'>x</span> - <span class='no'>from</span>[<span class='fl'>1</span>]) / <span class='fu'>diff</span>(<span class='no'>from</span>) * <span class='fu'>diff</span>(<span class='no'>to</span>) + <span class='no'>to</span>[<span class='fl'>1</span>]
}

<span class='co'># create basic problem</span>
<span class='no'>p1</span> <span class='kw'>&lt;-</span> <span class='fu'>problem</span>(<span class='no'>sim_pu_polygons</span>, <span class='no'>sim_features</span>, <span class='st'>"cost"</span>) <span class='kw'>%&gt;%</span>
      <span class='fu'>add_min_set_objective</span>() <span class='kw'>%&gt;%</span>
      <span class='fu'>add_relative_targets</span>(<span class='fl'>0.2</span>)

<span class='co'># create a symmetric connectivity matrix where the connectivity between</span>
<span class='co'># two planning units corresponds to their shared boundary length</span>
<span class='no'>b_matrix</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='boundary_matrix.html'>boundary_matrix</a></span>(<span class='no'>sim_pu_polygons</span>)

<span class='co'># standardize matrix values to lay between zero and one</span>
<span class='no'>b_matrix</span>[] <span class='kw'>&lt;-</span> <span class='fu'>rescale</span>(<span class='no'>b_matrix</span>[])

<span class='co'># visualize connectivity matrix</span>
<span class='fu'>image</span>(<span class='no'>b_matrix</span>)</div><div class='img'><img src='add_connectivity_penalties-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># create a symmetric connectivity matrix where the connectivity between</span>
<span class='co'># two planning units corresponds to their spatial proximity</span>
<span class='co'># i.e. planning units that are further apart share less connectivity</span>
<span class='no'>centroids</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>rgeos</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/rgeos/topics/topo-unary-gCentroid'>gCentroid</a></span>(<span class='no'>sim_pu_polygons</span>, <span class='kw'>byid</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='no'>d_matrix</span> <span class='kw'>&lt;-</span> (<span class='fl'>1</span> / (<span class='fu'><a href='as.html'>as</a></span>(<span class='fu'>dist</span>(<span class='no'>centroids</span>@<span class='kw'>coords</span>), <span class='st'>"Matrix"</span>) + <span class='fl'>1</span>))

<span class='co'># standardize matrix values to lay between zero and one</span>
<span class='no'>d_matrix</span>[] <span class='kw'>&lt;-</span> <span class='fu'>rescale</span>(<span class='no'>d_matrix</span>[])

<span class='co'># remove connections between planning units without connectivity to</span>
<span class='co'># reduce run-time</span>
<span class='no'>d_matrix</span>[<span class='no'>d_matrix</span> <span class='kw'>&lt;</span> <span class='fl'>0.7</span>] <span class='kw'>&lt;-</span> <span class='fl'>0</span>

<span class='co'># visualize connectivity matrix</span>
<span class='fu'>image</span>(<span class='no'>d_matrix</span>)</div><div class='img'><img src='add_connectivity_penalties-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># create a symmetric connectivity matrix where the connectivity</span>
<span class='co'># between adjacent two planning units corresponds to their combined</span>
<span class='co'># value in a field in the planning unit attribute data</span>
<span class='co'># for example, this field could describe the extent of native vegetation in</span>
<span class='co'># each planning unit and we could use connectivity penalties to identify</span>
<span class='co'># solutions that cluster planning units together that both contain large</span>
<span class='co'># amounts of native vegetation</span>
<span class='no'>c_matrix</span> <span class='kw'>&lt;-</span> <span class='fu'>connectivity_matrix</span>(<span class='no'>sim_pu_polygons</span>, <span class='st'>"cost"</span>)

<span class='co'># standardize matrix values to lay between zero and one</span>
<span class='no'>c_matrix</span>[] <span class='kw'>&lt;-</span> <span class='fu'>rescale</span>(<span class='no'>c_matrix</span>[])

<span class='co'># visualize connectivity matrix</span>
<span class='fu'>image</span>(<span class='no'>c_matrix</span>)</div><div class='img'><img src='add_connectivity_penalties-3.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># create an asymmetric connectivity matrix. Here, connectivity occurs between</span>
<span class='co'># adjacent planning units and, due to rivers flowing southwards</span>
<span class='co'># through the study area, connectivity from northern planning units to</span>
<span class='co'># southern planning units is ten times stronger than the reverse.</span>
<span class='no'>ac_matrix</span> <span class='kw'>&lt;-</span> <span class='fu'>matrix</span>(<span class='fl'>0</span>, <span class='fu'>length</span>(<span class='no'>sim_pu_polygons</span>), <span class='fu'>length</span>(<span class='no'>sim_pu_polygons</span>))
<span class='no'>ac_matrix</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='as.html'>as</a></span>(<span class='no'>ac_matrix</span>, <span class='st'>"Matrix"</span>)
<span class='no'>adjacent_units</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>rgeos</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/rgeos/topics/pred-binary-gIntersects'>gIntersects</a></span>(<span class='no'>sim_pu_polygons</span>, <span class='kw'>byid</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='kw'>for</span> (<span class='no'>i</span> <span class='kw'>in</span> <span class='fu'>seq_len</span>(<span class='fu'>length</span>(<span class='no'>sim_pu_polygons</span>))) {
  <span class='kw'>for</span> (<span class='no'>j</span> <span class='kw'>in</span> <span class='fu'>seq_len</span>(<span class='fu'>length</span>(<span class='no'>sim_pu_polygons</span>))) {
    <span class='co'># find if planning units are adjacent</span>
    <span class='kw'>if</span> (<span class='no'>adjacent_units</span>[<span class='no'>i</span>, <span class='no'>j</span>]) {
      <span class='co'># find if planning units lay north and south of each other</span>
      <span class='co'># i.e. they have the same x-coordinate</span>
      <span class='kw'>if</span> (<span class='no'>centroids</span>@<span class='kw'>coords</span>[<span class='no'>i</span>, <span class='fl'>1</span>] <span class='kw'>==</span> <span class='no'>centroids</span>@<span class='kw'>coords</span>[<span class='no'>j</span>, <span class='fl'>1</span>]) {
        <span class='kw'>if</span> (<span class='no'>centroids</span>@<span class='kw'>coords</span>[<span class='no'>i</span>, <span class='fl'>2</span>] <span class='kw'>&gt;</span> <span class='no'>centroids</span>@<span class='kw'>coords</span>[<span class='no'>j</span>, <span class='fl'>2</span>]) {
          <span class='co'># if i is north of j add 10 units of connectivity</span>
          <span class='no'>ac_matrix</span>[<span class='no'>i</span>, <span class='no'>j</span>] <span class='kw'>&lt;-</span> <span class='no'>ac_matrix</span>[<span class='no'>i</span>, <span class='no'>j</span>] + <span class='fl'>10</span>
        } <span class='kw'>else</span> <span class='kw'>if</span> (<span class='no'>centroids</span>@<span class='kw'>coords</span>[<span class='no'>i</span>, <span class='fl'>2</span>] <span class='kw'>&lt;</span> <span class='no'>centroids</span>@<span class='kw'>coords</span>[<span class='no'>j</span>, <span class='fl'>2</span>]) {
          <span class='co'># if i is south of j add 1 unit of connectivity</span>
          <span class='no'>ac_matrix</span>[<span class='no'>i</span>, <span class='no'>j</span>] <span class='kw'>&lt;-</span> <span class='no'>ac_matrix</span>[<span class='no'>i</span>, <span class='no'>j</span>] + <span class='fl'>1</span>
        }
      }
    }
  }
}

<span class='co'># standardize matrix values to lay between zero and one</span>
<span class='no'>ac_matrix</span>[] <span class='kw'>&lt;-</span> <span class='fu'>rescale</span>(<span class='no'>ac_matrix</span>[])

<span class='co'># visualize asymmetric connectivity matrix</span>
<span class='fu'>image</span>(<span class='no'>ac_matrix</span>)</div><div class='img'><img src='add_connectivity_penalties-4.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># create penalties</span>
<span class='no'>penalties</span> <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='fl'>10</span>, <span class='fl'>25</span>)

<span class='co'># create problems using the different connectivity matrices and penalties</span>
<span class='no'>p2</span> <span class='kw'>&lt;-</span> <span class='fu'>list</span>(<span class='no'>p1</span>,
           <span class='no'>p1</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties</span>[<span class='fl'>1</span>], <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>b_matrix</span>),
           <span class='no'>p1</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties</span>[<span class='fl'>2</span>], <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>b_matrix</span>),
           <span class='no'>p1</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties</span>[<span class='fl'>1</span>], <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>d_matrix</span>),
           <span class='no'>p1</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties</span>[<span class='fl'>2</span>], <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>d_matrix</span>),
           <span class='no'>p1</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties</span>[<span class='fl'>1</span>], <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>c_matrix</span>),
           <span class='no'>p1</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties</span>[<span class='fl'>2</span>], <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>c_matrix</span>),
           <span class='no'>p1</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties</span>[<span class='fl'>1</span>], <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>ac_matrix</span>),
           <span class='no'>p1</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties</span>[<span class='fl'>2</span>], <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>ac_matrix</span>))

<span class='co'># assign names to the problems</span>
<span class='fu'>names</span>(<span class='no'>p2</span>) <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='st'>"basic problem"</span>,
               <span class='fu'>paste0</span>(<span class='st'>"b_matrix ("</span>, <span class='no'>penalties</span>,<span class='st'>")"</span>),
               <span class='fu'>paste0</span>(<span class='st'>"d_matrix ("</span>, <span class='no'>penalties</span>,<span class='st'>")"</span>),
               <span class='fu'>paste0</span>(<span class='st'>"c_matrix ("</span>, <span class='no'>penalties</span>,<span class='st'>")"</span>),
               <span class='fu'>paste0</span>(<span class='st'>"ac_matrix ("</span>, <span class='no'>penalties</span>,<span class='st'>")"</span>))</div><div class='input'><span class='co'># solve problems</span>
<span class='no'>s2</span> <span class='kw'>&lt;-</span> <span class='fu'>lapply</span>(<span class='no'>p2</span>, <span class='no'>solve</span>)</div><div class='output co'>#&gt; Optimize a model with 5 rows, 90 columns and 450 nonzeros
#&gt; Variable types: 0 continuous, 90 integer (90 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 9e-01]
#&gt;   Objective range  [2e+02, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [6e+00, 1e+01]
#&gt; Found heuristic solution: objective 3934.6218396
#&gt; Presolve time: 0.00s
#&gt; Presolved: 5 rows, 90 columns, 450 nonzeros
#&gt; Variable types: 0 continuous, 90 integer (90 binary)
#&gt; Presolved: 5 rows, 90 columns, 450 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 3.496032e+03, 16 iterations, 0.00 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 3496.03193    0    4 3934.62184 3496.03193  11.1%     -    0s
#&gt; H    0     0                    3585.9601335 3496.03193  2.51%     -    0s
#&gt; 
#&gt; Explored 1 nodes (16 simplex iterations) in 0.00 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 2: 3585.96 3934.62 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 3.585960133519e+03, best bound 3.496031931890e+03, gap 2.5078%
#&gt; Optimize a model with 581 rows, 378 columns and 1602 nonzeros
#&gt; Variable types: 0 continuous, 378 integer (378 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [3e+00, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [6e+00, 1e+01]
#&gt; Found heuristic solution: objective 17287.196992
#&gt; Found heuristic solution: objective 3691.2885062
#&gt; Presolve time: 0.01s
#&gt; Presolved: 581 rows, 378 columns, 1602 nonzeros
#&gt; Variable types: 0 continuous, 378 integer (378 binary)
#&gt; Presolved: 581 rows, 378 columns, 1602 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 3.307193e+03, 159 iterations, 0.01 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 3307.19310    0   86 3691.28851 3307.19310  10.4%     -    0s
#&gt; H    0     0                    3433.8940898 3307.19310  3.69%     -    0s
#&gt; 
#&gt; Explored 1 nodes (159 simplex iterations) in 0.03 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 3: 3433.89 3691.29 17287.2 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 3.433894089811e+03, best bound 3.307193102718e+03, gap 3.6897%
#&gt; Optimize a model with 581 rows, 378 columns and 1602 nonzeros
#&gt; Variable types: 0 continuous, 378 integer (378 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [8e+00, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [6e+00, 1e+01]
#&gt; Found heuristic solution: objective 15487.196992
#&gt; Found heuristic solution: objective 3326.2885062
#&gt; Presolve time: 0.01s
#&gt; Presolved: 581 rows, 378 columns, 1602 nonzeros
#&gt; Variable types: 0 continuous, 378 integer (378 binary)
#&gt; Presolved: 581 rows, 378 columns, 1602 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 3.012030e+03, 174 iterations, 0.01 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 3012.03046    0  138 3326.28851 3012.03046  9.45%     -    0s
#&gt; 
#&gt; Explored 1 nodes (174 simplex iterations) in 0.03 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 2: 3326.29 15487.2 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 3.326288506226e+03, best bound 3.012030457072e+03, gap 9.4477%
#&gt; Optimize a model with 1601 rows, 888 columns and 3642 nonzeros
#&gt; Variable types: 0 continuous, 888 integer (888 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [7e+00, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [6e+00, 1e+01]
#&gt; Found heuristic solution: objective 11397.038660
#&gt; Found heuristic solution: objective 2915.9453686
#&gt; Presolve time: 0.04s
#&gt; Presolved: 1601 rows, 888 columns, 3642 nonzeros
#&gt; Variable types: 0 continuous, 888 integer (888 binary)
#&gt; Presolved: 1601 rows, 888 columns, 3642 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 2.277325e+03, 589 iterations, 0.09 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 2277.32517    0  877 2915.94537 2277.32517  21.9%     -    0s
#&gt;      0     0 2282.99210    0  874 2915.94537 2282.99210  21.7%     -    5s
#&gt;      0     0 2287.74759    0  872 2915.94537 2287.74759  21.5%     -    5s
#&gt;      0     0 2287.74759    0  483 2915.94537 2287.74759  21.5%     -    5s
#&gt;      0     0 2292.10641    0  479 2915.94537 2292.10641  21.4%     -    6s
#&gt;      0     0 2299.06011    0  473 2915.94537 2299.06011  21.2%     -    6s
#&gt;      0     0 2309.44472    0  475 2915.94537 2309.44472  20.8%     -    6s
#&gt;      0     0 2317.00747    0  475 2915.94537 2317.00747  20.5%     -    6s
#&gt; H    0     0                    2828.2686220 2317.00747  18.1%     -    7s
#&gt;      0     2 2317.09142    0  475 2828.26862 2317.09142  18.1%     -    7s
#&gt; H   44    44                    2697.3754103 2367.87205  12.2%  59.4    7s
#&gt; H   45    45                    2664.1671751 2367.87205  11.1%  59.0    7s
#&gt; H  182   133                    2651.6141595 2381.26507  10.2%  42.0    7s
#&gt; 
#&gt; Cutting planes:
#&gt;   Gomory: 5
#&gt; 
#&gt; Explored 241 nodes (12169 simplex iterations) in 8.21 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 6: 2651.61 2664.17 2697.38 ... 11397
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 2.651614159475e+03, best bound 2.387647374382e+03, gap 9.9549%
#&gt; Optimize a model with 1601 rows, 888 columns and 3642 nonzeros
#&gt; Variable types: 0 continuous, 888 integer (888 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [2e+01, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [6e+00, 1e+01]
#&gt; Found heuristic solution: objective 761.8011610
#&gt; Presolve time: 0.02s
#&gt; Presolved: 1601 rows, 888 columns, 3642 nonzeros
#&gt; Variable types: 0 continuous, 888 integer (888 binary)
#&gt; Presolved: 1601 rows, 888 columns, 3642 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 1.267850e+02, 243 iterations, 0.03 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0  126.78496    0  695  761.80116  126.78496  83.4%     -    0s
#&gt; H    0     0                     468.0158310  126.78496  72.9%     -    0s
#&gt;      0     0  139.58775    0  693  468.01583  139.58775  70.2%     -    5s
#&gt;      0     0  149.69686    0  691  468.01583  149.69686  68.0%     -    5s
#&gt;      0     0  149.69686    0  382  468.01583  149.69686  68.0%     -    5s
#&gt;      0     0  158.61851    0  380  468.01583  158.61851  66.1%     -    6s
#&gt;      0     0  168.29660    0  347  468.01583  168.29660  64.0%     -    6s
#&gt;      0     0  184.52811    0  378  468.01583  184.52811  60.6%     -    6s
#&gt;      0     0  195.56906    0  383  468.01583  195.56906  58.2%     -    6s
#&gt;      0     2  195.59996    0  383  468.01583  195.59996  58.2%     -    6s
#&gt; H    2     2                     421.3259805  195.85452  53.5%  30.5    6s
#&gt; 
#&gt; Cutting planes:
#&gt;   Gomory: 5
#&gt; 
#&gt; Explored 47 nodes (2701 simplex iterations) in 6.77 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 3: 421.326 468.016 761.801 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 4.213259804528e+02, best bound 3.890941790363e+02, gap 7.6501%
#&gt; Optimize a model with 581 rows, 378 columns and 1602 nonzeros
#&gt; Variable types: 0 continuous, 378 integer (378 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [9e+00, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [6e+00, 1e+01]
#&gt; Found heuristic solution: objective 15721.108025
#&gt; Found heuristic solution: objective 3513.2283384
#&gt; Presolve time: 0.01s
#&gt; Presolved: 581 rows, 378 columns, 1602 nonzeros
#&gt; Variable types: 0 continuous, 378 integer (378 binary)
#&gt; Presolved: 581 rows, 378 columns, 1602 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 3.099126e+03, 223 iterations, 0.01 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 3099.12568    0  190 3513.22834 3099.12568  11.8%     -    0s
#&gt;      0     0 3106.44940    0  164 3513.22834 3106.44940  11.6%     -    0s
#&gt; H    0     0                    3512.4511671 3106.44940  11.6%     -    0s
#&gt; H    0     0                    3312.8745258 3106.44940  6.23%     -    0s
#&gt; 
#&gt; Cutting planes:
#&gt;   Gomory: 1
#&gt; 
#&gt; Explored 1 nodes (264 simplex iterations) in 0.12 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 4: 3312.87 3512.45 3513.23 15721.1 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 3.312874525779e+03, best bound 3.106449395648e+03, gap 6.2310%
#&gt; Optimize a model with 581 rows, 378 columns and 1602 nonzeros
#&gt; Variable types: 0 continuous, 378 integer (378 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [2e+01, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [6e+00, 1e+01]
#&gt; Found heuristic solution: objective 11571.974576
#&gt; Found heuristic solution: objective 2881.1380866
#&gt; Presolve time: 0.01s
#&gt; Presolved: 581 rows, 378 columns, 1602 nonzeros
#&gt; Variable types: 0 continuous, 378 integer (378 binary)
#&gt; Presolved: 581 rows, 378 columns, 1602 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 2.309063e+03, 214 iterations, 0.02 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 2309.06312    0  362 2881.13809 2309.06312  19.9%     -    0s
#&gt;      0     0 2328.00732    0  359 2881.13809 2328.00732  19.2%     -    0s
#&gt;      0     0 2340.74971    0  365 2881.13809 2340.74971  18.8%     -    0s
#&gt;      0     0 2340.74971    0  224 2881.13809 2340.74971  18.8%     -    0s
#&gt;      0     0 2346.29691    0  224 2881.13809 2346.29691  18.6%     -    0s
#&gt;      0     0 2353.98367    0  223 2881.13809 2353.98367  18.3%     -    0s
#&gt;      0     0 2358.85647    0  227 2881.13809 2358.85647  18.1%     -    0s
#&gt;      0     0 2375.48689    0  190 2881.13809 2375.48689  17.6%     -    0s
#&gt;      0     0 2376.01174    0  210 2881.13809 2376.01174  17.5%     -    0s
#&gt; H    0     0                    2633.0995862 2376.01174  9.76%     -    0s
#&gt; 
#&gt; Cutting planes:
#&gt;   Gomory: 5
#&gt; 
#&gt; Explored 1 nodes (652 simplex iterations) in 0.62 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 3: 2633.1 2881.14 11572 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 2.633099586223e+03, best bound 2.376011737647e+03, gap 9.7637%
#&gt; Optimize a model with 293 rows, 234 columns and 1026 nonzeros
#&gt; Variable types: 0 continuous, 234 integer (234 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [1e+00, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [6e+00, 1e+01]
#&gt; Found heuristic solution: objective 17098.178722
#&gt; Found heuristic solution: objective 3824.6218396
#&gt; Presolve time: 0.00s
#&gt; Presolved: 293 rows, 234 columns, 1026 nonzeros
#&gt; Variable types: 0 continuous, 234 integer (234 binary)
#&gt; Presolved: 293 rows, 234 columns, 1026 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 3.385781e+03, 49 iterations, 0.00 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 3385.78126    0   24 3824.62184 3385.78126  11.5%     -    0s
#&gt; H    0     0                    3509.4733615 3385.78126  3.52%     -    0s
#&gt; 
#&gt; Explored 1 nodes (49 simplex iterations) in 0.03 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 3: 3509.47 3824.62 17098.2 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 3.509473361498e+03, best bound 3.385781260518e+03, gap 3.5245%
#&gt; Optimize a model with 293 rows, 234 columns and 1026 nonzeros
#&gt; Variable types: 0 continuous, 234 integer (234 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [2e+00, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [6e+00, 1e+01]
#&gt; Found heuristic solution: objective 15910.178722
#&gt; Found heuristic solution: objective 3659.6218396
#&gt; Presolve time: 0.00s
#&gt; Presolved: 293 rows, 234 columns, 1026 nonzeros
#&gt; Variable types: 0 continuous, 234 integer (234 binary)
#&gt; Presolved: 293 rows, 234 columns, 1026 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 3.172486e+03, 93 iterations, 0.00 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 3172.48586    0   64 3659.62184 3172.48586  13.3%     -    0s
#&gt; H    0     0                    3570.6343537 3172.48586  11.2%     -    0s
#&gt; H    0     0                    3378.2453465 3172.48586  6.09%     -    0s
#&gt; 
#&gt; Explored 1 nodes (93 simplex iterations) in 0.02 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 4: 3378.25 3570.63 3659.62 15910.2 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 3.378245346477e+03, best bound 3.172485864952e+03, gap 6.0907%</div><div class='input'>
<span class='co'># plot solutions</span>
<span class='fu'>par</span>(<span class='kw'>mfrow</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>3</span>, <span class='fl'>3</span>))
<span class='kw'>for</span> (<span class='no'>i</span> <span class='kw'>in</span> <span class='fu'>seq_along</span>(<span class='no'>s2</span>)) {
  <span class='fu'>plot</span>(<span class='no'>s2</span><span class='kw'>[[</span><span class='no'>i</span>]], <span class='kw'>main</span> <span class='kw'>=</span> <span class='fu'>names</span>(<span class='no'>p2</span>)[<span class='no'>i</span>], <span class='kw'>cex</span> <span class='kw'>=</span> <span class='fl'>1.5</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"white"</span>)
  <span class='fu'>plot</span>(<span class='no'>s2</span><span class='kw'>[[</span><span class='no'>i</span>]][<span class='no'>s2</span><span class='kw'>[[</span><span class='no'>i</span>]]$<span class='no'>solution_1</span> <span class='kw'>==</span> <span class='fl'>1</span>, ], <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"darkgreen"</span>, <span class='kw'>add</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
}</div><div class='img'><img src='add_connectivity_penalties-5.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># create minimal multi-zone problem and limit solver to one minute</span>
<span class='co'># to obtain solutions in a short period of time</span>
<span class='no'>p3</span> <span class='kw'>&lt;-</span> <span class='fu'>problem</span>(<span class='no'>sim_pu_zones_stack</span>, <span class='no'>sim_features_zones</span>) <span class='kw'>%&gt;%</span>
      <span class='fu'>add_min_set_objective</span>() <span class='kw'>%&gt;%</span>
      <span class='fu'>add_relative_targets</span>(<span class='fu'>matrix</span>(<span class='fl'>0.15</span>, <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>3</span>)) <span class='kw'>%&gt;%</span>
      <span class='fu'>add_binary_decisions</span>() <span class='kw'>%&gt;%</span>
      <span class='fu'><a href='add_default_solver.html'>add_default_solver</a></span>(<span class='kw'>time_limit</span> <span class='kw'>=</span> <span class='fl'>60</span>)

<span class='co'># create matrix showing which planning units are adjacent to other units</span>
<span class='no'>a_matrix</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='connected_matrix.html'>connected_matrix</a></span>(<span class='no'>sim_pu_zones_stack</span>)

<span class='co'># visualize matrix</span>
<span class='fu'>image</span>(<span class='no'>a_matrix</span>)</div><div class='img'><img src='add_connectivity_penalties-6.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># create a zone matrix where connectivities are only present between</span>
<span class='co'># planning units that are allocated to the same zone</span>
<span class='no'>zm1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='as.html'>as</a></span>(<span class='fu'>diag</span>(<span class='fl'>3</span>), <span class='st'>"Matrix"</span>)

<span class='co'># print zone matrix</span>
<span class='fu'>print</span>(<span class='no'>zm1</span>)</div><div class='output co'>#&gt;      [,1] [,2] [,3]
#&gt; [1,]    1    .    .
#&gt; [2,]    .    1    .
#&gt; [3,]    .    .    1</div><div class='input'>
<span class='co'># create a zone matrix where connectivities are strongest between</span>
<span class='co'># planning units allocated to different zones</span>
<span class='no'>zm2</span> <span class='kw'>&lt;-</span> <span class='fu'>matrix</span>(<span class='fl'>1</span>, <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='fl'>3</span>)
<span class='fu'>diag</span>(<span class='no'>zm2</span>) <span class='kw'>&lt;-</span> <span class='fl'>0</span>
<span class='no'>zm2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='as.html'>as</a></span>(<span class='no'>zm2</span>, <span class='st'>"Matrix"</span>)

<span class='co'># print zone matrix</span>
<span class='fu'>print</span>(<span class='no'>zm2</span>)</div><div class='output co'>#&gt; 3 x 3 Matrix of class "dsyMatrix"
#&gt;      [,1] [,2] [,3]
#&gt; [1,]    0    1    1
#&gt; [2,]    1    0    1
#&gt; [3,]    1    1    0</div><div class='input'>
<span class='co'># create a zone matrix that indicates that connectivities between planning</span>
<span class='co'># units assigned to the same zone are much higher than connectivities</span>
<span class='co'># assigned to different zones</span>
<span class='no'>zm3</span> <span class='kw'>&lt;-</span> <span class='fu'>matrix</span>(<span class='fl'>0.1</span>, <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='fl'>3</span>)
<span class='fu'>diag</span>(<span class='no'>zm3</span>) <span class='kw'>&lt;-</span> <span class='fl'>1</span>
<span class='no'>zm3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='as.html'>as</a></span>(<span class='no'>zm3</span>, <span class='st'>"Matrix"</span>)

<span class='co'># print zone matrix</span>
<span class='fu'>print</span>(<span class='no'>zm3</span>)</div><div class='output co'>#&gt; 3 x 3 Matrix of class "dsyMatrix"
#&gt;      [,1] [,2] [,3]
#&gt; [1,]  1.0  0.1  0.1
#&gt; [2,]  0.1  1.0  0.1
#&gt; [3,]  0.1  0.1  1.0</div><div class='input'>
<span class='co'># create a zone matrix that indicates that connectivities between planning</span>
<span class='co'># units allocated to zone 1 are very high, connectivities between planning</span>
<span class='co'># units allocated to zones 1 and 2 are moderately high, and connectivities</span>
<span class='co'># planning units allocated to other zones are low</span>
<span class='no'>zm4</span> <span class='kw'>&lt;-</span> <span class='fu'>matrix</span>(<span class='fl'>0.1</span>, <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='fl'>3</span>)
<span class='no'>zm4</span>[<span class='fl'>1</span>, <span class='fl'>1</span>] <span class='kw'>&lt;-</span> <span class='fl'>1</span>
<span class='no'>zm4</span>[<span class='fl'>1</span>, <span class='fl'>2</span>] <span class='kw'>&lt;-</span> <span class='fl'>0.5</span>
<span class='no'>zm4</span>[<span class='fl'>2</span>, <span class='fl'>1</span>] <span class='kw'>&lt;-</span> <span class='fl'>0.5</span>
<span class='no'>zm4</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='as.html'>as</a></span>(<span class='no'>zm4</span>, <span class='st'>"Matrix"</span>)

<span class='co'># print zone matrix</span>
<span class='fu'>print</span>(<span class='no'>zm4</span>)</div><div class='output co'>#&gt; 3 x 3 Matrix of class "dsyMatrix"
#&gt;      [,1] [,2] [,3]
#&gt; [1,]  1.0  0.5  0.1
#&gt; [2,]  0.5  0.1  0.1
#&gt; [3,]  0.1  0.1  0.1</div><div class='input'>
<span class='co'># create a zone matrix with strong connectivities between planning units</span>
<span class='co'># allocated to the same zone, moderate connectivities between planning</span>
<span class='co'># unit allocated to zone 1 and zone 2, and negative connectivities between</span>
<span class='co'># planning units allocated to zone 3 and the other two zones</span>
<span class='no'>zm5</span> <span class='kw'>&lt;-</span> <span class='fu'>matrix</span>(-<span class='fl'>1</span>, <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='fl'>3</span>)
<span class='no'>zm5</span>[<span class='fl'>1</span>, <span class='fl'>2</span>] <span class='kw'>&lt;-</span> <span class='fl'>0.5</span>
<span class='no'>zm5</span>[<span class='fl'>2</span>, <span class='fl'>1</span>] <span class='kw'>&lt;-</span> <span class='fl'>0.5</span>
<span class='fu'>diag</span>(<span class='no'>zm5</span>) <span class='kw'>&lt;-</span> <span class='fl'>1</span>
<span class='no'>zm5</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='as.html'>as</a></span>(<span class='no'>zm5</span>, <span class='st'>"Matrix"</span>)

<span class='co'># print zone matrix</span>
<span class='fu'>print</span>(<span class='no'>zm5</span>)</div><div class='output co'>#&gt; 3 x 3 Matrix of class "dsyMatrix"
#&gt;      [,1] [,2] [,3]
#&gt; [1,]  1.0  0.5   -1
#&gt; [2,]  0.5  1.0   -1
#&gt; [3,] -1.0 -1.0    1</div><div class='input'>
<span class='co'># create vector of penalties to use creating problems</span>
<span class='no'>penalties2</span> <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='fl'>5</span>, <span class='fl'>30</span>)

<span class='co'># create multi-zone problems using the adjacent connectivity matrix and</span>
<span class='co'># different zone matrices</span>
<span class='no'>p4</span> <span class='kw'>&lt;-</span> <span class='fu'>list</span>(
  <span class='no'>p3</span>,
  <span class='no'>p3</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties2</span>[<span class='fl'>1</span>], <span class='no'>zm1</span>, <span class='no'>a_matrix</span>),
  <span class='no'>p3</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties2</span>[<span class='fl'>2</span>], <span class='no'>zm1</span>, <span class='no'>a_matrix</span>),
  <span class='no'>p3</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties2</span>[<span class='fl'>1</span>], <span class='no'>zm2</span>, <span class='no'>a_matrix</span>),
  <span class='no'>p3</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties2</span>[<span class='fl'>2</span>], <span class='no'>zm2</span>, <span class='no'>a_matrix</span>),
  <span class='no'>p3</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties2</span>[<span class='fl'>1</span>], <span class='no'>zm3</span>, <span class='no'>a_matrix</span>),
  <span class='no'>p3</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties2</span>[<span class='fl'>2</span>], <span class='no'>zm3</span>, <span class='no'>a_matrix</span>),
  <span class='no'>p3</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties2</span>[<span class='fl'>1</span>], <span class='no'>zm4</span>, <span class='no'>a_matrix</span>),
  <span class='no'>p3</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties2</span>[<span class='fl'>2</span>], <span class='no'>zm4</span>, <span class='no'>a_matrix</span>),
  <span class='no'>p3</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties2</span>[<span class='fl'>1</span>], <span class='no'>zm5</span>, <span class='no'>a_matrix</span>),
  <span class='no'>p3</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties2</span>[<span class='fl'>2</span>], <span class='no'>zm5</span>, <span class='no'>a_matrix</span>))

<span class='co'># assign names to the problems</span>
<span class='fu'>names</span>(<span class='no'>p4</span>) <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='st'>"basic problem"</span>,
               <span class='fu'>paste0</span>(<span class='st'>"zm"</span>, <span class='fu'>rep</span>(<span class='fu'>seq_len</span>(<span class='fl'>5</span>), <span class='kw'>each</span> <span class='kw'>=</span> <span class='fl'>2</span>), <span class='st'>" ("</span>,
                      <span class='fu'>rep</span>(<span class='no'>penalties2</span>, <span class='fl'>2</span>), <span class='st'>")"</span>))</div><div class='input'><span class='co'># solve problems</span>
<span class='no'>s4</span> <span class='kw'>&lt;-</span> <span class='fu'>lapply</span>(<span class='no'>p4</span>, <span class='no'>solve</span>)</div><div class='output co'>#&gt; Optimize a model with 105 rows, 270 columns and 1620 nonzeros
#&gt; Variable types: 0 continuous, 270 integer (270 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [2e+02, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 1e+01]
#&gt; Found heuristic solution: objective 10275.924144
#&gt; Presolve time: 0.01s
#&gt; Presolved: 105 rows, 270 columns, 1620 nonzeros
#&gt; Variable types: 0 continuous, 270 integer (270 binary)
#&gt; Presolved: 105 rows, 270 columns, 1620 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 8.943504e+03, 123 iterations, 0.01 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 8943.50352    0   15 10275.9241 8943.50352  13.0%     -    0s
#&gt; H    0     0                    9113.2309417 8943.50352  1.86%     -    0s
#&gt; 
#&gt; Explored 1 nodes (123 simplex iterations) in 0.02 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 2: 9113.23 10275.9 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 9.113230941747e+03, best bound 8.943503517801e+03, gap 1.8624%
#&gt; Optimize a model with 1845 rows, 1140 columns and 5100 nonzeros
#&gt; Variable types: 0 continuous, 1140 integer (1140 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [5e+00, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 1e+01]
#&gt; Found heuristic solution: objective 10075.924144
#&gt; Presolve time: 0.07s
#&gt; Presolved: 1845 rows, 1140 columns, 5100 nonzeros
#&gt; Variable types: 0 continuous, 1140 integer (1140 binary)
#&gt; Presolved: 1845 rows, 1140 columns, 5100 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 8.367447e+03, 811 iterations, 0.13 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 8367.44688    0  465 10075.9241 8367.44688  17.0%     -    0s
#&gt; H    0     0                    9091.9388725 8367.44688  7.97%     -    0s
#&gt; 
#&gt; Explored 1 nodes (811 simplex iterations) in 0.28 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 2: 9091.94 10075.9 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 9.091938872543e+03, best bound 8.367446876836e+03, gap 7.9685%
#&gt; Optimize a model with 1845 rows, 1140 columns and 5100 nonzeros
#&gt; Variable types: 0 continuous, 1140 integer (1140 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [3e+01, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 1e+01]
#&gt; Found heuristic solution: objective 9075.9241439
#&gt; Presolve time: 0.05s
#&gt; Presolved: 1845 rows, 1140 columns, 5100 nonzeros
#&gt; Variable types: 0 continuous, 1140 integer (1140 binary)
#&gt; Presolved: 1845 rows, 1140 columns, 5100 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 4.897305e+03, 713 iterations, 0.08 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 4897.30484    0  786 9075.92414 4897.30484  46.0%     -    0s
#&gt; H    0     0                    8221.0580883 4897.30484  40.4%     -    0s
#&gt; H    0     0                    7394.4741512 4897.30484  33.8%     -    0s
#&gt;      0     0 4956.79223    0  788 7394.47415 4956.79223  33.0%     -    0s
#&gt; H    0     0                    7377.0161632 4956.79223  32.8%     -    0s
#&gt;      0     0 4972.23970    0  744 7377.01616 4972.23970  32.6%     -    0s
#&gt;      0     0 4972.23970    0  487 7377.01616 4972.23970  32.6%     -    0s
#&gt;      0     0 4980.10607    0  517 7377.01616 4980.10607  32.5%     -    1s
#&gt;      0     0 4990.97009    0  521 7377.01616 4990.97009  32.3%     -    1s
#&gt;      0     0 5007.58139    0  510 7377.01616 5007.58139  32.1%     -    1s
#&gt;      0     0 5007.69141    0  515 7377.01616 5007.69141  32.1%     -    1s
#&gt;      0     0 5028.58754    0  520 7377.01616 5028.58754  31.8%     -    1s
#&gt; H    0     0                    7279.9804612 5028.58754  30.9%     -    1s
#&gt;      0     0 5029.10803    0  519 7279.98046 5029.10803  30.9%     -    1s
#&gt; H    0     0                    6255.3995601 5029.10803  19.6%     -    1s
#&gt; H    0     0                    6125.0240193 5029.10803  17.9%     -    1s
#&gt; H    0     0                    5906.6766306 5029.10803  14.9%     -    2s
#&gt;      0     2 5029.50668    0  519 5906.67663 5029.50668  14.9%     -    2s
#&gt;    517   471 5780.18540   51  519 5906.67663 5087.53033  13.9%  30.7    5s
#&gt; H  520   449                    5846.8331917 5087.53033  13.0%  30.5    5s
#&gt;    711   556 5170.98286   16  470 5846.83319 5103.03255  12.7%  38.5   10s
#&gt; H  798   548                    5789.6712270 5103.14510  11.9%  39.3   10s
#&gt; H 1228   659                    5742.4606758 5143.38289  10.4%  37.0   13s
#&gt; 
#&gt; Cutting planes:
#&gt;   Gomory: 18
#&gt; 
#&gt; Explored 1241 nodes (47975 simplex iterations) in 13.32 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 10: 5742.46 5789.67 5846.83 ... 8221.06
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 5.742460675788e+03, best bound 5.171997946009e+03, gap 9.9341%
#&gt; Optimize a model with 3585 rows, 2010 columns and 8580 nonzeros
#&gt; Variable types: 0 continuous, 2010 integer (2010 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [5e+00, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 1e+01]
#&gt; Found heuristic solution: objective 9985.9241439
#&gt; Presolve time: 0.12s
#&gt; Presolved: 3585 rows, 2010 columns, 12060 nonzeros
#&gt; Variable types: 0 continuous, 2010 integer (2010 binary)
#&gt; Presolve removed 870 rows and 0 columns
#&gt; Presolved: 2715 rows, 2010 columns, 9450 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 8.346175e+03, 2916 iterations, 0.22 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 8346.17500    0  329 9985.92414 8346.17500  16.4%     -    0s
#&gt; H    0     0                    8781.5479295 8346.17500  4.96%     -    0s
#&gt; 
#&gt; Explored 1 nodes (3481 simplex iterations) in 0.42 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 2: 8781.55 9985.92 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 8.781547929517e+03, best bound 8.346175000834e+03, gap 4.9578%
#&gt; Optimize a model with 3585 rows, 2010 columns and 8580 nonzeros
#&gt; Variable types: 0 continuous, 2010 integer (2010 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [3e+01, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 1e+01]
#&gt; Found heuristic solution: objective 8535.9241439
#&gt; Presolve time: 0.15s
#&gt; Presolved: 3585 rows, 2010 columns, 12060 nonzeros
#&gt; Variable types: 0 continuous, 2010 integer (2010 binary)
#&gt; Presolve removed 870 rows and 0 columns
#&gt; Presolved: 2715 rows, 2010 columns, 9450 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 4.854963e+03, 3541 iterations, 0.34 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 4854.96349    0  526 8535.92414 4854.96349  43.1%     -    0s
#&gt; H    0     0                    7002.4593024 4854.96349  30.7%     -    0s
#&gt; H    0     0                    5587.4665998 4854.96349  13.1%     -    0s
#&gt;      0     0 4857.44909    0  414 5587.46660 4857.44909  13.1%     -    0s
#&gt; H    0     0                    5204.0464840 4857.44909  6.66%     -    1s
#&gt; 
#&gt; Cutting planes:
#&gt;   Gomory: 1
#&gt;   Zero half: 1
#&gt; 
#&gt; Explored 1 nodes (4304 simplex iterations) in 1.74 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 4: 5204.05 5587.47 7002.46 8535.92 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 5.204046483984e+03, best bound 4.857449091889e+03, gap 6.6602%
#&gt; Optimize a model with 5325 rows, 2880 columns and 12060 nonzeros
#&gt; Variable types: 0 continuous, 2880 integer (2880 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [5e-01, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 1e+01]
#&gt; Found heuristic solution: objective 10046.924144
#&gt; Presolve time: 0.43s
#&gt; Presolved: 5325 rows, 2880 columns, 17280 nonzeros
#&gt; Variable types: 0 continuous, 2880 integer (2880 binary)
#&gt; Presolve removed 870 rows and 0 columns
#&gt; Presolved: 4455 rows, 2880 columns, 14670 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 8.343967e+03, 1830 iterations, 0.59 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 8343.96746    0  836 10046.9241 8343.96746  17.0%     -    1s
#&gt; H    0     0                    9176.3350974 8343.96746  9.07%     -    1s
#&gt; 
#&gt; Explored 1 nodes (1975 simplex iterations) in 1.19 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 2: 9176.34 10046.9 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 9.176335097412e+03, best bound 8.343967460484e+03, gap 9.0708%
#&gt; Optimize a model with 5325 rows, 2880 columns and 12060 nonzeros
#&gt; Variable types: 0 continuous, 2880 integer (2880 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [3e+00, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 1e+01]
#&gt; Found heuristic solution: objective 8901.9241439
#&gt; Presolve time: 0.22s
#&gt; Presolved: 5325 rows, 2880 columns, 17280 nonzeros
#&gt; Variable types: 0 continuous, 2880 integer (2880 binary)
#&gt; Presolve removed 870 rows and 0 columns
#&gt; Presolved: 4455 rows, 2880 columns, 14670 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 4.633285e+03, 1811 iterations, 0.42 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 4633.28464    0 1346 8901.92414 4633.28464  48.0%     -    0s
#&gt; H    0     0                    7691.1794121 4633.28464  39.8%     -    1s
#&gt;      0     0 4658.06418    0 1329 7691.17941 4658.06418  39.4%     -    1s
#&gt;      0     0 4659.07240    0 1327 7691.17941 4659.07240  39.4%     -    1s
#&gt;      0     0 4659.84601    0 1329 7691.17941 4659.84601  39.4%     -    1s
#&gt;      0     0 4664.91083    0 1324 7691.17941 4664.91083  39.3%     -    2s
#&gt;      0     0 4665.44735    0 1322 7691.17941 4665.44735  39.3%     -    2s
#&gt;      0     0 4665.66376    0 1325 7691.17941 4665.66376  39.3%     -    2s
#&gt;      0     0 4665.90693    0 1324 7691.17941 4665.90693  39.3%     -    2s
#&gt;      0     0 4665.90693    0 1324 7691.17941 4665.90693  39.3%     -    6s
#&gt; H    0     0                    6032.1367011 4665.90693  22.6%     -    7s
#&gt; H    0     0                    5797.1633928 4665.90693  19.5%     -    7s
#&gt; H    0     0                    5667.6525365 4665.90693  17.7%     -   12s
#&gt;      0     0 4877.80932    0  773 5667.65254 4877.80932  13.9%     -   12s
#&gt;      0     0 4932.82392    0  833 5667.65254 4932.82392  13.0%     -   13s
#&gt;      0     0 4934.89668    0  778 5667.65254 4934.89668  12.9%     -   13s
#&gt;      0     0 4935.22125    0  807 5667.65254 4935.22125  12.9%     -   13s
#&gt;      0     0 4935.26140    0  810 5667.65254 4935.26140  12.9%     -   13s
#&gt;      0     0 4948.19681    0  845 5667.65254 4948.19681  12.7%     -   14s
#&gt;      0     0 4948.91718    0  827 5667.65254 4948.91718  12.7%     -   14s
#&gt;      0     0 4948.91718    0  827 5667.65254 4948.91718  12.7%     -   15s
#&gt;      0     2 4948.97753    0  826 5667.65254 4948.97753  12.7%     -   15s
#&gt;     42    44 5353.01571   25  549 5667.65254 4998.45854  11.8%   221   20s
#&gt;    252   224 5541.96654   21  818 5667.65254 5022.87750  11.4%   109   25s
#&gt;    371   319 5303.91426    8  883 5667.65254 5029.80972  11.3%   121   30s
#&gt;    511   449 5631.45996   32 1324 5667.65254 5040.93390  11.1%   117   36s
#&gt;    518   454 5644.61651   31  706 5667.65254 5040.93390  11.1%   115   40s
#&gt;    552   478 5349.48761   31  680 5667.65254 5067.45756  10.6%   127   45s
#&gt; H  603   486                    5662.0302987 5067.45756  10.5%   124   46s
#&gt;    680   513 5146.30034   19  776 5662.03030 5090.75408  10.1%   129   50s
#&gt; 
#&gt; Cutting planes:
#&gt;   Gomory: 10
#&gt; 
#&gt; Explored 800 nodes (109650 simplex iterations) in 54.34 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 6: 5662.03 5667.65 5797.16 ... 8901.92
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 5.662030298744e+03, best bound 5.109520182716e+03, gap 9.7582%
#&gt; Optimize a model with 5325 rows, 2880 columns and 12060 nonzeros
#&gt; Variable types: 0 continuous, 2880 integer (2880 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [5e-01, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 1e+01]
#&gt; Found heuristic solution: objective 10118.924144
#&gt; Presolve time: 0.30s
#&gt; Presolved: 5325 rows, 2880 columns, 17280 nonzeros
#&gt; Variable types: 0 continuous, 2880 integer (2880 binary)
#&gt; Presolve removed 870 rows and 0 columns
#&gt; Presolved: 4455 rows, 2880 columns, 14670 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 8.569664e+03, 3521 iterations, 0.46 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 8569.66432    0  837 10118.9241 8569.66432  15.3%     -    0s
#&gt; H    0     0                    9511.5372668 8569.66432  9.90%     -    1s
#&gt; 
#&gt; Explored 1 nodes (4021 simplex iterations) in 1.09 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 2: 9511.54 10118.9 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 9.511537266786e+03, best bound 8.569664324288e+03, gap 9.9024%
#&gt; Optimize a model with 5325 rows, 2880 columns and 12060 nonzeros
#&gt; Variable types: 0 continuous, 2880 integer (2880 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [3e+00, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 1e+01]
#&gt; Found heuristic solution: objective 9333.9241439
#&gt; Presolve time: 0.24s
#&gt; Presolved: 5325 rows, 2880 columns, 17280 nonzeros
#&gt; Variable types: 0 continuous, 2880 integer (2880 binary)
#&gt; Presolve removed 870 rows and 0 columns
#&gt; Presolved: 4455 rows, 2880 columns, 14670 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 6.027838e+03, 3716 iterations, 0.68 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 6027.83792    0 1236 9333.92414 6027.83792  35.4%     -    1s
#&gt; H    0     0                    7895.4425254 6027.83792  23.7%     -    1s
#&gt;      0     0 6067.84177    0 1275 7895.44253 6067.84177  23.1%     -    2s
#&gt;      0     0 6102.61443    0 1300 7895.44253 6102.61443  22.7%     -    2s
#&gt;      0     0 6112.74461    0 1392 7895.44253 6112.74461  22.6%     -    3s
#&gt;      0     0 6112.74461    0 1394 7895.44253 6112.74461  22.6%     -    3s
#&gt;      0     0 6124.25969    0 1414 7895.44253 6124.25969  22.4%     -    3s
#&gt;      0     0 6124.25969    0 1414 7895.44253 6124.25969  22.4%     -    3s
#&gt;      0     0 6136.23910    0 1405 7895.44253 6136.23910  22.3%     -    3s
#&gt;      0     0 6136.23910    0 1405 7895.44253 6136.23910  22.3%     -    3s
#&gt;      0     0 6144.63810    0 1401 7895.44253 6144.63810  22.2%     -    4s
#&gt;      0     0 6144.63810    0 1400 7895.44253 6144.63810  22.2%     -    4s
#&gt;      0     0 6155.24150    0 1398 7895.44253 6155.24150  22.0%     -    4s
#&gt;      0     0 6155.24542    0 1401 7895.44253 6155.24542  22.0%     -    4s
#&gt;      0     0 6155.24542    0 1399 7895.44253 6155.24542  22.0%     -    4s
#&gt;      0     0 6155.24542    0 1398 7895.44253 6155.24542  22.0%     -    4s
#&gt;      0     0 6155.24542    0 1389 7895.44253 6155.24542  22.0%     -    5s
#&gt;      0     0 6155.24542    0 1390 7895.44253 6155.24542  22.0%     -    5s
#&gt;      0     0 6155.24542    0 1387 7895.44253 6155.24542  22.0%     -    5s
#&gt;      0     0 6155.24542    0 1387 7895.44253 6155.24542  22.0%     -    5s
#&gt; H    0     0                    7668.8647927 6155.24542  19.7%     -    7s
#&gt; H    0     0                    7530.2205272 6155.24542  18.3%     -   12s
#&gt;      0     0 6173.64494    0  843 7530.22053 6173.64494  18.0%     -   13s
#&gt; H    0     0                    7522.9937237 6173.64494  17.9%     -   13s
#&gt;      0     0 6312.73273    0 1022 7522.99372 6312.73273  16.1%     -   13s
#&gt; H    0     0                    7509.9874031 6312.73273  15.9%     -   14s
#&gt;      0     0 6314.66082    0 1029 7509.98740 6314.66082  15.9%     -   14s
#&gt;      0     0 6314.70529    0 1029 7509.98740 6314.70529  15.9%     -   14s
#&gt;      0     0 6314.70951    0 1032 7509.98740 6314.70951  15.9%     -   14s
#&gt;      0     0 6315.00292    0 1030 7509.98740 6315.00292  15.9%     -   15s
#&gt;      0     0 6315.26709    0 1017 7509.98740 6315.26709  15.9%     -   15s
#&gt;      0     0 6317.25305    0 1019 7509.98740 6317.25305  15.9%     -   17s
#&gt;      0     0 6317.25305    0 1016 7509.98740 6317.25305  15.9%     -   20s
#&gt;      0     2 6317.33790    0 1016 7509.98740 6317.33790  15.9%     -   21s
#&gt;     33    35 6547.60339   22  840 7509.98740 6319.03759  15.9%   234   25s
#&gt; H   81    81                    7486.2729093 6319.03759  15.6%   222   27s
#&gt; H  135   135                    7484.6582733 6319.03759  15.6%   176   30s
#&gt;    281   274 7243.88851   67  511 7484.65827 6339.34392  15.3%   151   35s
#&gt;    511   486 7182.48269   63 1387 7484.65827 6356.83851  15.1%   126   43s
#&gt; 
#&gt; Explored 512 nodes (79795 simplex iterations) in 44.54 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 8: 7484.66 7486.27 7509.99 ... 9333.92
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 7.484658273253e+03, best bound 7.179092652434e+03, gap 4.0826%
#&gt; Optimize a model with 6485 rows, 2880 columns and 15540 nonzeros
#&gt; Variable types: 0 continuous, 2880 integer (2880 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [2e+00, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 1e+01]
#&gt; Found heuristic solution: objective 10084.071885
#&gt; Presolve time: 0.53s
#&gt; Presolved: 6485 rows, 2880 columns, 21920 nonzeros
#&gt; Variable types: 0 continuous, 2880 integer (2880 binary)
#&gt; Presolve removed 870 rows and 0 columns
#&gt; Presolved: 5615 rows, 2880 columns, 19310 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 8.178938e+03, 1611 iterations, 0.39 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 8178.93759    0  960 10084.0719 8178.93759  18.9%     -    0s
#&gt; H    0     0                    9601.2209596 8178.93759  14.8%     -    1s
#&gt; H    0     0                    9225.1083121 8178.93759  11.3%     -    1s
#&gt; H    0     0                    9049.0820198 8178.93759  9.62%     -    1s
#&gt; 
#&gt; Explored 1 nodes (1611 simplex iterations) in 1.97 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 4: 9049.08 9225.11 9601.22 10084.1 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 9.049082019813e+03, best bound 8.178937587478e+03, gap 9.6158%
#&gt; Optimize a model with 6485 rows, 2880 columns and 15540 nonzeros
#&gt; Variable types: 0 continuous, 2880 integer (2880 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [2e+01, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 1e+01]
#&gt; Found heuristic solution: objective 8859.0718845
#&gt; Presolve time: 0.35s
#&gt; Presolved: 6485 rows, 2880 columns, 21920 nonzeros
#&gt; Variable types: 0 continuous, 2880 integer (2880 binary)
#&gt; Presolve removed 870 rows and 0 columns
#&gt; Presolved: 5615 rows, 2880 columns, 19310 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 3.483401e+03, 1189 iterations, 0.30 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 3483.40090    0 1372 8859.07188 3483.40090  60.7%     -    0s
#&gt; H    0     0                    8253.2597427 3483.40090  57.8%     -    0s
#&gt; H    0     0                    7095.7948188 3483.40090  50.9%     -    1s
#&gt;      0     0 3525.69488    0 1333 7095.79482 3525.69488  50.3%     -    1s
#&gt; H    0     0                    6891.0093789 3525.69488  48.8%     -    1s
#&gt;      0     0 3548.98163    0 1333 6891.00938 3548.98163  48.5%     -    4s
#&gt; H    0     0                    6806.1804881 3548.98163  47.9%     -    5s
#&gt;      0     0 3549.18394    0 1345 6806.18049 3549.18394  47.9%     -    5s
#&gt;      0     0 3552.18802    0 1346 6806.18049 3552.18802  47.8%     -    5s
#&gt;      0     0 3552.18802    0 1346 6806.18049 3552.18802  47.8%     -    5s
#&gt; H    0     0                    6379.3961745 3552.18802  44.3%     -    6s
#&gt;      0     0 4662.41137    0  963 6379.39617 4662.41137  26.9%     -    8s
#&gt; H    0     0                    6051.8798450 4662.41137  23.0%     -    8s
#&gt;      0     0 4693.61864    0  948 6051.87985 4693.61864  22.4%     -    8s
#&gt;      0     0 4705.66203    0  952 6051.87985 4705.66203  22.2%     -    9s
#&gt;      0     0 4713.18844    0  950 6051.87985 4713.18844  22.1%     -    9s
#&gt;      0     0 4713.18844    0  955 6051.87985 4713.18844  22.1%     -    9s
#&gt;      0     0 4713.18844    0  955 6051.87985 4713.18844  22.1%     -    9s
#&gt;      0     0 4714.97965    0  963 6051.87985 4714.97965  22.1%     -    9s
#&gt;      0     0 4715.52991    0  949 6051.87985 4715.52991  22.1%     -    9s
#&gt;      0     0 4718.51384    0  943 6051.87985 4718.51384  22.0%     -   10s
#&gt;      0     0 4718.51384    0  945 6051.87985 4718.51384  22.0%     -   10s
#&gt;      0     0 4718.51384    0  939 6051.87985 4718.51384  22.0%     -   13s
#&gt; H    0     0                    5979.8638542 4718.51384  21.1%     -   15s
#&gt;      0     2 4718.76756    0  939 5979.86385 4718.76756  21.1%     -   15s
#&gt;     35    37 5153.72906   18  957 5979.86385 4815.68836  19.5%   313   20s
#&gt;    177   177 5942.08908  107  286 5979.86385 4815.68836  19.5%   144   25s
#&gt; H  364   324                    5972.7124158 4836.20129  19.0%   105   28s
#&gt;    408   370 5816.98546   41  647 5972.71242 4836.20129  19.0%   107   30s
#&gt;    511   460 5824.54322   69 1346 5972.71242 4836.51156  19.0%   106   35s
#&gt; H  512   437                    5736.7918133 4897.30484  14.6%   106   38s
#&gt;    513   437 5611.94708   59  710 5736.79181 4897.30484  14.6%   106   40s
#&gt;    524   445 5736.79181   52  742 5736.79181 4972.58876  13.3%   104   45s
#&gt; H  526   424                    5672.0321693 4980.70853  12.2%   103   55s
#&gt; 
#&gt; Cutting planes:
#&gt;   Gomory: 11
#&gt;   Zero half: 1
#&gt; 
#&gt; Explored 554 nodes (67609 simplex iterations) in 60.00 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 10: 5672.03 5736.79 5972.71 ... 8253.26
#&gt; 
#&gt; Time limit reached
#&gt; Best objective 5.672032169321e+03, best bound 5.045482592135e+03, gap 11.0463%</div><div class='input'><span class='no'>s4</span> <span class='kw'>&lt;-</span> <span class='fu'>lapply</span>(<span class='no'>s4</span>, <span class='no'>category_layer</span>)
<span class='no'>s4</span> <span class='kw'>&lt;-</span> <span class='fu'>stack</span>(<span class='no'>s4</span>)

<span class='co'># plot solutions</span>
<span class='fu'>plot</span>(<span class='no'>s4</span>, <span class='kw'>main</span> <span class='kw'>=</span> <span class='fu'>names</span>(<span class='no'>p4</span>), <span class='kw'>axes</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>box</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='img'><img src='add_connectivity_penalties-7.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># create an array to manually specify the connectivities between</span>
<span class='co'># each planning unit when they are allocated to each different zone</span>
<span class='co'># for real-world problems, these connectivities would be generated using</span>
<span class='co'># data - but here these connectivity values are assigned as random</span>
<span class='co'># ones or zeros</span>
<span class='no'>c_array</span> <span class='kw'>&lt;-</span> <span class='fu'>array</span>(<span class='fl'>0</span>, <span class='fu'>c</span>(<span class='fu'>rep</span>(<span class='fu'><a href='OptimizationProblem-methods.html'>ncell</a></span>(<span class='no'>sim_pu_zones_stack</span><span class='kw'>[[</span><span class='fl'>1</span>]]), <span class='fl'>2</span>), <span class='fl'>3</span>, <span class='fl'>3</span>))
<span class='kw'>for</span> (<span class='no'>z1</span> <span class='kw'>in</span> <span class='fu'>seq_len</span>(<span class='fl'>3</span>))
  <span class='kw'>for</span> (<span class='no'>z2</span> <span class='kw'>in</span> <span class='fu'>seq_len</span>(<span class='fl'>3</span>))
    <span class='no'>c_array</span>[, , <span class='no'>z1</span>, <span class='no'>z2</span>] <span class='kw'>&lt;-</span> <span class='fu'>round</span>(<span class='fu'>runif</span>(<span class='fu'><a href='OptimizationProblem-methods.html'>ncell</a></span>(<span class='no'>sim_pu_zones_stack</span><span class='kw'>[[</span><span class='fl'>1</span>]]) ^ <span class='fl'>2</span>,
                                       <span class='fl'>0</span>, <span class='fl'>0.505</span>))

<span class='co'># create a problem with the manually specified connectivity array</span>
<span class='co'># note that the zones argument is set to NULL because the connectivity</span>
<span class='co'># data is an array</span>
<span class='no'>p5</span> <span class='kw'>&lt;-</span> <span class='fu'>list</span>(<span class='no'>p3</span>,
           <span class='no'>p3</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='fl'>30</span>, <span class='kw'>zones</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>c_array</span>))


<span class='co'># assign names to the problems</span>
<span class='fu'>names</span>(<span class='no'>p5</span>) <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='st'>"basic problem"</span>, <span class='st'>"connectivity array"</span>)</div><div class='input'><span class='co'># solve problems</span>
<span class='no'>s5</span> <span class='kw'>&lt;-</span> <span class='fu'>lapply</span>(<span class='no'>p5</span>, <span class='no'>solve</span>)</div><div class='output co'>#&gt; Optimize a model with 105 rows, 270 columns and 1620 nonzeros
#&gt; Variable types: 0 continuous, 270 integer (270 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [2e+02, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 1e+01]
#&gt; Found heuristic solution: objective 10275.924144
#&gt; Presolve time: 0.01s
#&gt; Presolved: 105 rows, 270 columns, 1620 nonzeros
#&gt; Variable types: 0 continuous, 270 integer (270 binary)
#&gt; Presolved: 105 rows, 270 columns, 1620 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 8.943504e+03, 123 iterations, 0.01 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 8943.50352    0   15 10275.9241 8943.50352  13.0%     -    0s
#&gt; H    0     0                    9113.2309417 8943.50352  1.86%     -    0s
#&gt; 
#&gt; Explored 1 nodes (123 simplex iterations) in 0.04 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 2: 9113.23 10275.9 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 9.113230941747e+03, best bound 8.943503517801e+03, gap 1.8624%
#&gt; Optimize a model with 1479 rows, 957 columns and 4368 nonzeros
#&gt; Variable types: 0 continuous, 957 integer (957 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [3e+01, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 1e+01]
#&gt; Found heuristic solution: objective 9765.9241439
#&gt; Presolve time: 0.07s
#&gt; Presolved: 1479 rows, 957 columns, 4416 nonzeros
#&gt; Variable types: 0 continuous, 957 integer (957 binary)
#&gt; Presolve removed 24 rows and 0 columns
#&gt; Presolved: 1455 rows, 957 columns, 4344 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 5.800862e+03, 989 iterations, 0.11 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 5800.86247    0  719 9765.92414 5800.86247  40.6%     -    0s
#&gt; H    0     0                    8785.5867791 5800.86247  34.0%     -    0s
#&gt; H    0     0                    8281.4625469 5800.86247  30.0%     -    0s
#&gt;      0     0 5818.29055    0  686 8281.46255 5818.29055  29.7%     -    2s
#&gt; H    0     0                    8055.6558856 5818.29055  27.8%     -    2s
#&gt;      0     0 5818.29055    0  686 8055.65589 5818.29055  27.8%     -    2s
#&gt; H    0     0                    7747.5964438 5818.29055  24.9%     -    3s
#&gt; H    0     0                    7645.8662159 5818.29055  23.9%     -    3s
#&gt; H    0     0                    7389.1824373 5818.29055  21.3%     -    3s
#&gt;      0     2 5818.83085    0  686 7389.18244 5818.83085  21.3%     -    4s
#&gt; H   27    27                    7254.8152596 5818.83085  19.8%  76.1    4s
#&gt; H  108   102                    7248.0182277 5825.03519  19.6%  75.0    4s
#&gt;    113   109 6173.68876   21  574 7248.01823 5825.03519  19.6%  75.8    5s
#&gt; H  135   122                    7186.2657821 5825.03519  18.9%  76.5    5s
#&gt; H  239   209                    7166.6303890 5830.13502  18.6%  75.4    6s
#&gt; H  243   213                    7161.7992299 5830.13502  18.6%  75.2    6s
#&gt; H  270   240                    7160.0472834 5830.13502  18.6%  71.6    6s
#&gt; H  298   240                    7040.7581682 5830.13502  17.2%  66.4    6s
#&gt;    511   429 7025.94238   72  686 7040.75817 5905.84572  16.1%  72.3   10s
#&gt;    683   535 6606.34646   41  472 7040.75817 5905.84572  16.1%  88.3   15s
#&gt; H  780   559                    7040.3168425 5905.84572  16.1%  91.8   17s
#&gt; H  834   574                    7028.5685055 5905.84572  16.0%  93.5   19s
#&gt;    883   597 6233.21756   19  614 7028.56851 5905.84572  16.0%  94.7   20s
#&gt; H 1031   633                    6986.0294387 5905.84572  15.5%  97.7   22s
#&gt; H 1112   646                    6957.7321199 5906.51494  15.1%   102   24s
#&gt; H 1139   625                    6926.3987380 5906.51494  14.7%   102   25s
#&gt; H 1301   651                    6892.5092774 5950.84617  13.7%   106   28s
#&gt; H 1355   654                    6884.9083672 5951.27423  13.6%   105   29s
#&gt;   1396   673 6375.20005   20  583 6884.90837 5967.19954  13.3%   105   30s
#&gt; H 1410   613                    6829.7712334 5967.19954  12.6%   105   31s
#&gt;   1638   798 6759.37894   42  289 6829.77123 5999.45033  12.2%   108   35s
#&gt;   1876   986 6619.14250   30  592 6829.77123 6007.50893  12.0%   109   40s
#&gt;   2103  1151 6631.22489   38  555 6829.77123 6023.27478  11.8%   110   45s
#&gt; H 2369  1321                    6827.4180196 6035.60642  11.6%   110   51s
#&gt;   2621  1516 6253.62284   21  574 6827.41802 6042.75225  11.5%   111   55s
#&gt; H 2943  1751                    6822.3399311 6060.88202  11.2%   112   59s
#&gt; 
#&gt; Cutting planes:
#&gt;   Gomory: 1
#&gt; 
#&gt; Explored 3002 nodes (336022 simplex iterations) in 60.00 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 10: 6822.34 6827.42 6829.77 ... 7040.32
#&gt; 
#&gt; Time limit reached
#&gt; Best objective 6.822339931093e+03, best bound 6.062379272782e+03, gap 11.1393%</div><div class='input'><span class='no'>s5</span> <span class='kw'>&lt;-</span> <span class='fu'>lapply</span>(<span class='no'>s5</span>, <span class='no'>category_layer</span>)
<span class='no'>s5</span> <span class='kw'>&lt;-</span> <span class='fu'>stack</span>(<span class='no'>s5</span>)

<span class='co'># plot solutions</span>
<span class='fu'>plot</span>(<span class='no'>s5</span>, <span class='kw'>main</span> <span class='kw'>=</span> <span class='fu'>names</span>(<span class='no'>p5</span>), <span class='kw'>axes</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>box</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='img'><img src='add_connectivity_penalties-8.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by <a href='http://jeffrey-hanson.com'>Jeffrey O Hanson</a>, <a href='http://www.richard-schuster.com/'>Richard Schuster</a>, Nina Morrell, <a href='http://strimas.com'>Matthew Strimas-Mackey</a>, Matthew E Watts, <a href='http://arcese.forestry.ubc.ca'>Peter Arcese</a>, <a href='https://josephrbennett.wordpress.com/'>Joeseph Bennett</a>, Hugh P Possingham.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
<script>
  docsearch({
    
    
    apiKey: '486efa122ea6783724263412c5f28ab3',
    indexName: 'prioritizr',
    inputSelector: 'input#search-input.form-control'
  });
</script>


  </body>
</html>

