<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Prioritizr Basics • prioritizr</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">prioritizr</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/prioritizr/prioritizr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Prioritizr Basics</h1>
            
          </div>

    
    
<div class="contents">
<div id="systematic-conservation-prioritization-in-r" class="section level1">
<h1 class="hasAnchor">
<a href="#systematic-conservation-prioritization-in-r" class="anchor"></a>Systematic Conservation Prioritization in R</h1>
<p><em>Prioritizr</em> is an <em>R</em> package for solving systematic conservation prioritization problems using integer linear programming (ILP) techniques. The package offers a flexible interface for creating conservation problems using a range of different objectives and constraints that can be tailored to the specific needs of the conservation planner. Conservation problems can be solved using a variety of commercial and open-source exact algorithm solvers. In contrast to the algorithms conventionally used to solve conservation problems, such as greedy heuristics or simulated annealing, the ILP algorithms used by <em>prioritizr</em> are guaranteed to find optimal solutions. This package also has the functionality to read <a href="http://marxan.net/">Marxan</a> input data and find much cheaper solutions in a much shorter period of time than Marxan (<a href="http://marxan.net/downloads/papers/beyer_etal_2015.pdf">Beyer <em>et al. 2016</em></a>).</p>
<p>For a walk-through of the functions available in the prioritizr package and their usage with a simulated dataset, refer to the <a href="quick_start.html">Quickstart Guide</a>.</p>
<div id="background" class="section level2">
<h2 class="hasAnchor">
<a href="#background" class="anchor"></a>Background</h2>
<div id="systematic-conservation-prioritization" class="section level3">
<h3 class="hasAnchor">
<a href="#systematic-conservation-prioritization" class="anchor"></a>Systematic conservation prioritization</h3>
<p><strong>Systematic conservation prioritization</strong> is a rigorous, repeatable, and structured approach to designing new protected areas that efficiently meet conservation objectives, while minimizing socioeconomic cost (<a href="http://www.nature.com/nature/journal/v405/n6783/full/405243a0.html">Margules and Pressey 2000</a>). Historically, conservation decision-making has often evaluated parcels opportunistically as they became available for purchase, donation, or under threat. Such decisions may or may not maximize the long-term persistence of target species or communities, or the biodiversity returns on on dollars invested, in the absence of a landscape-level understanding of the distribution of target species and communities. Optimization tools are meant to help planners simulate alternative reserve designs over a host of biodiversity and management goals to prioritize parcels and conservation actions. Such tools allow you to specify biodiversity targets such as focal or indicator species richness and ecosystem representation, while minimizing overall costs of land acquisition measured in various ways. As part of the systematic planning process, conservation prioritization can contribute to a transparent, inclusive, and defensible decision making process.</p>
</div>
<div id="reserve-design" class="section level3">
<h3 class="hasAnchor">
<a href="#reserve-design" class="anchor"></a>Reserve design</h3>
<p>A reserve design exercise starts by dividing the study region into <strong>planning units</strong> (typically square or hexagonal cells) and, for each planning unit, assigning values that quantify socioeconomic cost and conservation benefit for a set of conservation features. The <strong>cost</strong> can be the acquisition cost of the land, the cost of management, the opportunity cost of foregone commercial activities (e.g. from logging or agriculture), or simply the area. The <strong>conservation features</strong> are typically species (e.g. Clouded Leopard) or habitats (e.g. mangroves or cloud forest). The benefit that each feature derives from a planning unit can take a variety of forms, but is typically either occupancy (i.e. presence or absence) or area of occurrence within each planning unit. Finally, in some types of reserve design formulations, for each conservation feature, representation targets must be set, such as 20% of the current extent of cloud forest or 10,000 km<sup>2</sup> of Clouded Leopard habitat.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># load feature data</span>
<span class="kw">data</span>(sim_features)
<span class="co"># plot the distribution of suitable habitat for each feature</span>
<span class="kw">plot</span>(sim_features, <span class="dt">main =</span> <span class="kw">paste</span>(<span class="st">"Feature"</span>, <span class="kw">seq_len</span>(<span class="kw">nlayers</span>(sim_features))),
     <span class="dt">nr =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="prioritizr_basics_files/figure-html/unnamed-chunk-3-1.png" width="672" style="display: block; margin: auto;"></p>
<p>The goal of the reserve design exercise is then to optimize the trade-off between conservation benefit and socioeconomic cost, i.e. to get the most benefit for your limited conservation funds. Different reserve design formulations achieve this in different ways. In the minimum set problem formulation used by Marxan, the goal is to find the set of planning units that meets the representation targets while minimizing cost. Alternatively, in the maximum coverage formulation, the goal is to maximum the overall representation of conservation features while keeping cost within a fixed budget. Other approaches are possible that build on these basic formulations.</p>
<p><img src="prioritizr_basics_files/figure-html/unnamed-chunk-4-1.png" width="384" style="display: block; margin: auto;"></p>
</div>
<div id="mathematical-formulation" class="section level3">
<h3 class="hasAnchor">
<a href="#mathematical-formulation" class="anchor"></a>Mathematical formulation</h3>
<p>Formulating the conservation objective mathematically as an optimization problem allows us to tap into the rich body of knowledge that exists in the field of mathematical optimization. In general, the goal of an optimization problem is to minimize an <strong>objective function</strong> over a set of <strong>decision variables</strong>, subject to a series of <strong>constraints</strong>. The decision variables are what we control, usually there is one binary variable for each planning unit specifying whether or not to protect that unit. The constraints can be thought of as rules that need to be followed, for example, that the reserve must stay within a certain budget or meet the representation targets.</p>
<p>Fortunately a wide variety of approaches have been developed for solving optimization problems. Reserve design problems are frequently solved using <a href="https://en.wikipedia.org/wiki/Simulated_annealing">simulated annealing</a>, a stochastic heuristic for approximating global optima of complex functions. This method is conceptually simple and can be applied to a wide variety of optimization problems, however, it won’t, in general, find the true optimal solution. More importantly, it is impossible to quantify how close the resulting solution is to the optimal solution.</p>
<p><em>Prioritizr</em> focuses on using more modern algorithms that can efficiently solve conservation planning problems exactly or to within a given gap to optimality. <strong>Integer Linear Programming (ILP)</strong> represents the state-of-the-art approach to optimization problems, being faster and more efficient than simulated annealing, but only recently becoming available with the advent of fast computer algorithms (<a href="http://www.sciencedirect.com/science/article/pii/S0304380016300217">Beyer et al. 2016</a>). The general form of an ILP problem can be expressed in matrix notation as:</p>
<p><span class="math display">\[\text{Minimize} \space \boldsymbol{c}^\text{T} \boldsymbol{x} \space
\space \text{subject to} \space A\boldsymbol{x}
\space \Box \space \boldsymbol{b}\]</span></p>
<p>where <span class="math inline">\(x\)</span> is a vector of decision variables, <span class="math inline">\(c\)</span> and <span class="math inline">\(b\)</span> are vectors of known coefficients, and <span class="math inline">\(A\)</span> is the constraint matrix. The final term specifies a series of structural constaints and the symbol is used to indicate that the relational operators for the constraint can be either <span class="math inline">\(\geq\)</span>, <span class="math inline">\(=\)</span>, or <span class="math inline">\(\leq\)</span>. For the minimum set problem formulation described above, <span class="math inline">\(c\)</span> would be a vector of costs for each planning unit, <span class="math inline">\(b\)</span> a vector of targets for each conservation feature, box would be <span class="math inline">\(\geq\)</span> for all features, and <span class="math inline">\(A\)</span> would be the representation matrix with <span class="math inline">\(A_{ij} = r_{ij}\)</span> the representation level of feature <span class="math inline">\(i\)</span> in planning unit <span class="math inline">\(j\)</span>.</p>
<p>These exact ILP algorithms are implemented in a variety of commercial and open source solvers and <code>prioritzr</code> provides a unified interface to some of these solvers. The intention is to abstract away the details of these solvers so that the user requires minimal knowledge of the specific solvers or ILP in general. The currently supported solvers are as follows. Each must be installed separately from this package to be accessible.</p>
<ul>
<li>
<a href="http://www.gurobi.com/">Gurobi</a> It is by far the fastest of the solvers available in this package, however, it is also the only solver that is not freely available. That said, licenses are available to academics at no cost. The gurobi package is distributed with the Gurobi software suite. This solver uses the <code>gurobi</code> package to solve problems.</li>
<li>
<a href="https://projects.coin-or.org/SYMPHONY">SYMPHONY</a> is an open-source integer programming solver that is part of the Computational Infrastructure for Operations Research (COIN-OR) project, an initiative to promote development of open-source tools for operations research (a field that includes linear programming). Two R packages exist to provide interfaces to SYMPHONY: <code>Rsymphony</code> (on CRAN) and <code>lpsymphony</code> (on Bioconductor).</li>
</ul>
</div>
</div>
<div id="objective-functions" class="section level2">
<h2 class="hasAnchor">
<a href="#objective-functions" class="anchor"></a>Objective Functions</h2>
<p>The <strong>objective function</strong> is the mathematical formulation of the conservation planning problem. All conservation planning problems involve minimizing or maximizing some kind of objective. For instance, the planner may require a solution that conserves enough habitat for each species while minimizing the overall cost of the reserve network. Alternatively, the planner may require a solution that maximizes the number of conserved species while ensuring that the cost of the reserve network does not exceed the budget.</p>
<p>In <em>prioritizr</em>, the type of objective function must be manually specified. While some users may feel that explicitly defining an objective for a conservation problem adds some element of arbitrariness or subjectivity to the decision making process, we remind them that “canned” decision support tools (such as Marxan or Zonation) also have objectives. The key difference here is that instead of choosing between different software programs here the user is explicitly choosing their objective within the single environment.</p>
<p><em>prioritizr</em> currently handles five types of prioritization objective functions: minimum set, maximum coverage, a hybrid formulation called maximum feature coverage, a variant of the maximum feature formulation designed for phylogenetic representation, and a generic maximum utility function.</p>
<div id="the-minimum-set-objective" class="section level3">
<h3 class="hasAnchor">
<a href="#the-minimum-set-objective" class="anchor"></a>The Minimum Set Objective</h3>
<p>In the context of systematic reserve design, the minimum set objective function seeks to find the set of planning units that minimizes the overall cost of a reserve network, while meeting a set of representation targets for the conservation features. This objective is equivalent to a simplified Marxan reserve design problem, with the Boundary Length Modifier (BLM) set to zero.</p>
<p>The reserve design problem for the minimum set objective function can be expressed mathematically for <span class="math inline">\(n\)</span> planning units as:</p>
<p><span class="math display">\[\text{Minimize} \sum_{i=1}^{n}x_i c_i + \text{ subject to } \sum_{j=1}^{n}x_j r_{ij} \geq T_i \space \forall \space i\]</span></p>
<p>Where where <span class="math inline">\(x_i\)</span> is a binary decision variable specifying whether planning unit <span class="math inline">\(i\)</span> has been selected (1) or not (0), <span class="math inline">\(c_i\)</span> is the cost of planning unit <span class="math inline">\(i\)</span>, <span class="math inline">\(r_{ij}\)</span> is the representation level of feature <span class="math inline">\(i\)</span> in planning unit <span class="math inline">\(j\)</span>, and <span class="math inline">\(T_i\)</span> is the target for feature <span class="math inline">\(i\)</span>. The first term is the objective function and the second is the set of constraints. In words this says ’find the set of planning units that meets all the representation targets while minimizing the overall cost.</p>
</div>
<div id="the-maximum-cover-objective" class="section level3">
<h3 class="hasAnchor">
<a href="#the-maximum-cover-objective" class="anchor"></a>The Maximum Cover Objective</h3>
<p>The maximum coverage problem seeks to find the set of planning units that maximizes the overall level of representation across a suite of conservation features, while keeping cost within a fixed budget. This problem is roughly the opposite of what the conservation planning software Marxan does.</p>
<p>The maximum coverage problem can be stated mathematically, for <span class="math inline">\(n\)</span> planning units and <span class="math inline">\(m\)</span> conservation features, as:</p>
<p><span class="math display">\[\text{Maximize} \sum_{i=1}^{m} \sum_{j=1}^{n} x_j r_{ij} + \text{ subject to } \sum_{i=1}^{n}x_i c_i \leq B\]</span></p>
<p>Where <span class="math inline">\(x_i\)</span> is a binary decision variable specifying whether planning unit <span class="math inline">\(i\)</span> has been selected (1) or not (0), <span class="math inline">\(c_i\)</span> is the cost of planning unit <span class="math inline">\(i\)</span>, <span class="math inline">\(r_{ij}\)</span> is the representation level of feature <span class="math inline">\(i\)</span> in planning unit <span class="math inline">\(j\)</span>, and <span class="math inline">\(B\)</span> is the budget.</p>
</div>
<div id="the-maximum-feature-objective" class="section level3">
<h3 class="hasAnchor">
<a href="#the-maximum-feature-objective" class="anchor"></a>The Maximum Feature Objective</h3>
<p>The maximum target coverage problem is a hybrid between the minimum set and maximum cover problems in that it allows for both a budget and targets to be set. This problem finds the set of planning units that meets representation targets for the most species while staying within a fixed budget. If multiple solutions can meet all targets while staying within budget, the cheapest solution is chosen. This objective was inspired by the conservation problem defined in <a href="http://www.cell.com/trends/ecology-evolution/abstract/S0169-5347(01)02125-5">Cabeza and Moilanen (2001)</a>.</p>
<p>The maximum target coverage problem can be stated mathematically, for <span class="math inline">\(n\)</span> planning units and <span class="math inline">\(m\)</span> conservation features, as:</p>
<p><span class="math display">\[\text{Maximize} \space -a\sum_{i=1}^{n} x_i c_i + \sum_{j=1}^{m}y_j\]</span></p>
<p>Subject to:</p>
<p><span class="math display">\[\sum_{i=1}^{n}x_i c_i \leq B \space \text{and} \space \sum_{j=1}^{n} x_j r_{ij} \geq y_iT_i \space \forall \space i\]</span></p>
<p>where <span class="math inline">\(x_i\)</span> is a binary decision variable specifying whether planning unit <span class="math inline">\(i\)</span> has been selected (1) or not (0), <span class="math inline">\(y_{ij}\)</span> is a binary decision variable specifying whether the target for species <span class="math inline">\(i\)</span> should be met, <span class="math inline">\(c_i\)</span> is the cost of planning unit <span class="math inline">\(i\)</span>, <span class="math inline">\(r_{ij}\)</span> is the representation level of feature <span class="math inline">\(i\)</span> in planning unit <span class="math inline">\(j\)</span>, <span class="math inline">\(B\)</span> is the budget, and <span class="math inline">\(T_i\)</span> is the target for feature <span class="math inline">\(i\)</span>. Finally, the factor a is chosen so that the first term of the objective function is much smaller than the second. This ensures that the reserve cost only plays a role in distinguishing between solutions that meet the same number of targets.</p>
</div>
<div id="the-maximum-phylogeny-objective" class="section level3">
<h3 class="hasAnchor">
<a href="#the-maximum-phylogeny-objective" class="anchor"></a>The Maximum Phylogeny Objective</h3>
<p>The maximum phylogenetic representation problem is similar to the maximum features problem in that it allows for both a budget and targets to be set. This problem finds the set of planning units that meets representation targets for a phylogenetic tree while staying within a fixed budget. If multiple solutions can meet all targets while staying within budget, the cheapest solution is chosen.</p>
<p>The maximum phylogenetic objective can be stated mathematically in the same way that the maximum feature objective, but uses a phylogenetic tree rather than biodiversity features. In <em>prioritizr</em>, this objective requires the installation of the <code>ape</code> package, designed for working with phylogenetic data.</p>
</div>
</div>
<div id="preparing-your-data" class="section level2">
<h2 class="hasAnchor">
<a href="#preparing-your-data" class="anchor"></a>Preparing your data</h2>
<p>To use your own data with prioritizr, you first need to prepare your dataset. If the <code>solve</code> function doesn’t run correctly, the first thing to check should be your own data. That is, one or more files may be malformed and not in compliance with the specification. The three types of data input that must be provided to <code>prioritizr</code> are summarized below.</p>
<ol style="list-style-type: decimal">
<li><strong>The project area and a list of all of the planning units contained within it</strong></li>
</ol>
<p>Examples of planning units within a project area include a map of planning unit boundaries (a ‘cadastral layer’), delineated watersheds, or a user-defined grid placed over the project area. Acceptable input formats include rasters, polygon or polyline shapefiles, data frames, or numeric vectors specifying the planning units to use in the reserve design exercise</p>
<ol start="2" style="list-style-type: decimal">
<li><strong>The cost associated with each planning unit</strong></li>
</ol>
<p>Because minimizing the costs of conservation is generally a goal of stakeholders, each planning unit must have an associated cost. Types of costs vary with the goals of each project and are ultimately limited by the cost metrics available for planning. Some examples of cost metrics include: 1) the total land area included in the solution (ha), 2) the estimated costs of managing or restoring acquired parcels, 3) the opportunity costs of displaced commercial activity, industry, tourism, or recreational access, and 4) the costs of acquiring land. In <code>prioritizr</code>, cost (should be incorporated into the project area upload?)</p>
<ol start="3" style="list-style-type: decimal">
<li><strong>A list of biodiversity features</strong></li>
</ol>
<p>‘Biodiversity features’ may refer to bird and plant species distributions, specific habitat types, or special elements identified and mapped within the planning area of interest. These data are typically organized as tables, wherein each planning unit is associated with an index of abundance, a probability of occurrence, or the presence/absence of a particular biodiversity feature of interest. In <code>prioritizr</code>, the input format of features must correspond with the input format of the project area. If the planning units are a raster, then the features must be a <code>RasterStack</code> object. If the planning units are input as a data frame object, then features must also be a data frame, following the conventions of Marxan. In the latter case, an RIJ matrix must be also constructed that identifies the amount of each feature in each planning unit.</p>
<p>For more detailed information on how data are incorporated into problem formulation in <em>prioritizr</em>, and for several worked examples on a simulated dataset, consult the <a href="https://prioritizr.github.io/prioritizr/articles/quick_start.html">Quick Start</a> vignette. You may also wish to refer to the vignettes provided in the supplemental <a href="https://github.com/prioritizr/prioritizrdata"><em>prioritizrdata</em> package</a>, which use <em>prioritizr</em> functions to work through the real-world examples from Tasmania and Salt Spring Island.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#systematic-conservation-prioritization-in-r">Systematic Conservation Prioritization in R</a><ul class="nav nav-pills nav-stacked">
<li><a href="#background">Background</a></li>
      <li><a href="#objective-functions">Objective Functions</a></li>
      <li><a href="#preparing-your-data">Preparing your data</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by <a href="http://jeffrey-hanson.com">Jeffrey O Hanson</a>, <a href="http://www.richard-schuster.com/">Richard Schuster</a>, Nina Morrell, <a href="http://strimas.com">Matthew Strimas-Mackey</a>, Matthew E Watts, <a href="http://arcese.forestry.ubc.ca">Peter Arcese</a>, <a href="https://josephrbennett.wordpress.com/">Joeseph Bennett</a>, Hugh P Possingham.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
